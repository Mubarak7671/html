(globalThis["webpackChunk_canva_web"] = globalThis["webpackChunk_canva_web"] || []).push([[62246],{

/***/ 482834:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(584145);__web_req__(898738);globalThis._456c437108d2d2713799e19380be528d = globalThis._456c437108d2d2713799e19380be528d || {};(function(__c) {var Fq;var T;var Hq;var $n=__c.$n;var w=__c.w;var u=__c.u;var E=__c.E;var ir;var hr;var Uq;var hb=__c.hb;var fr;var dr;var Sn=__c.Sn;var ba=__c.ba;var Pq;var Oq;var Nq;var Mq;var Kq;var Eq;var vq;var gh=__c.gh;var l=__c.l;var Rn=__c.Rn;var Qp;var Pp;var Op;var Np;var Mp;var q=__c.q;var ia=__c.ia;var fa=__c.fa;
var Rmb,Smb,Tmb,Ap,Umb,Cp,Dp,Fp,Vmb,Wmb,Gp,Xmb,Hp,Ip,Zmb,Jp,$mb,Kp,cnb,enb,dnb,fnb,gnb,Lp,hnb,jnb,lnb,bnb,Rp,mnb,nnb,onb,pnb,qnb,rnb,tnb,unb,vnb,wnb,xnb,ynb,znb,Anb,Bnb,Sp,Cnb,Dnb,Tp,Enb,Hnb,Fnb,Gnb,Vp,Knb,Mnb,Jnb,Lnb,Nnb,Onb,Inb,Pnb,Qnb,Snb,Tnb,Wp,Wnb,Ynb,Xp,Yp,aob,Znb,$nb,cob,dob,Zp,hob,iob,job,kob,lob,mob,nob,$p,aq,bq,oob,pob,qob,sob,tob,uob,vob,wob,dq,xob,yob,zob,Aob,Bob,hq,iq,Cob,Dob,Fob,Gob,jq,Eob,kq,Hob,lq,mq,Iob,Job,Kob,oq,Mob,qq,pq,Nob,rq,sq,Oob,Pob,Qob,Rob,Sob,Tob,Uob,tq,Wob,Cq,Dq,$ob,bpb,
epb,hpb,jpb,kpb,mpb,npb,opb,ppb,rpb,spb,tpb,vpb,upb,wpb,ypb,Apb,Epb,Fpb,Gpb,Jpb,Lpb,Opb,Ppb,Tpb,Xpb,bqb,dqb,fqb,gqb,Lq,iqb,kqb,mqb,pqb,rqb,sqb,tqb,uqb,vqb,xqb,Aqb,Cqb,Eqb,Fqb,Gqb,Hqb,Iqb,Jqb,Kqb,Lqb,Nqb,Oqb,Qqb,$qb,arb,crb,Tq,drb,fpb,erb,frb,grb,Vq,hrb;__c.zp=function(a){const b=new WeakMap;return(c,...d)=>{fa(d.length===0);b.has(c)||b.set(c,a(c));return b.get(c)}};Rmb=function(a,b){const c=new Map;for(const [d,e]of a){const [f,g]=b(d,e);c.set(f,g)}return c};Smb=function(a){return new RegExp(`^${a}${"B"}${"[0-9b-df-hj-np-tv-zB-DF-HJ-NP-TV-Z]"}{14}$`)};
Tmb=function(a,b){fa(b.length>0);switch(b.length){case 1:return b[0];case 2:return a.compose(b[0],b[1]);case 3:return a.compose(a.compose(b[0],b[1]),b[2]);case 4:return a.compose(a.compose(b[0],b[1]),a.compose(b[2],b[3]));default:const c=b.slice();for(b=b.length;b>1;){let d=0;for(let e=0;e<b;e+=2)c[d++]=e+1<b?a.compose(c[e],c[e+1]):c[e];b=d}return c[0]}};Ap=function(a,b,c){fa(a.Bj(b,c),"{} != {}",b,c)};Umb=function(a,b){return new Bp(b(a.Rt),b(a.uu),a.iAa,a.PGa)};
Cp=function(a,b){return new Bp(a,b,!1,!1)};Dp=function(a){return new Bp(void 0,a,!0,!1)};Fp=function(a,b){a.iAa||(a.iAa=b.iAa);a.PGa||(a.PGa=b.PGa);return b};Vmb=function(a,b=!0){a.iAa||(a.iAa=b)};Wmb=function(a,b=!0){a.PGa||(a.PGa=b)};Gp=function(a){return{type:0,length:a}};Xmb=function(a){return{type:1,length:a}};Hp=function(a,b){return a.ND(1,b).length};
Ip=function(a,b){var c=Array.from(b).sort((f,g)=>f-g);if(!c.length)return Ymb;fa(c[0]>=0);b=new Map;a=a.Ad(c[c.length-1],0);let d=0,e=0;for(const f of c){for(c=a.head;d<f;){ia(c!=null);switch(c.type){case 0:c=a.Yz(Math.min(f-d,c.length));d+=c;e+=c;break;case 1:e+=Hp(a,c.length);break;default:throw new q(c);}c=a.head}c?.type===1&&(e+=Hp(a,c.length));if(d!==f)throw Error();b.set(d,e)}return b};
Zmb=function(a,b){var c=Array.from(b).sort((f,g)=>f-g);if(!c.length)return Ymb;fa(c[0]>=0);b=new Map;a=a.Ad(0,c[c.length-1]);let d=0,e=0;for(const f of c){for(c=a.head;e<f;){ia(c!=null);switch(c.type){case 0:c=a.Yz(Math.min(f-e,c.length));d+=c;e+=c;break;case 1:e+=Hp(a,Math.min(f-e,c.length));break;default:throw new q(c);}c=a.head}if(e!==f)throw Error();b.set(e,d)}return b};Jp=function(a,b){return a?b?(...c)=>{a(...c);b(...c)}:a:b};$mb=function(a){return JSON.stringify(a,(b,c)=>c??null)};Kp=function(a){return new anb(a.ePd)};
cnb=function(a,b,c,d){var e=Math.max(a.er,b.er),f=Math.max(a.eC,b.eC);a=a.Ad(void 0,e,f);b=b.Ad(void 0,e,f);e=a.head;for(f=b.head;e||f;){if(e&&e.type===0||f&&f.type===0){const n=a.iy(),p=b.iy(),t=c.iy();e=n;f=p;for(var g=t,h=d,k=e.head,m=f.head;k||m;){if(k&&k.type===0||m&&m.type===0){k=e.Dv();m=f.Dv();for(const v of bnb(k,m))g.Vc(v,h(v,e.attrs[v],f.attrs[v]))}else if(k&&m)k=Math.min(k.length,m.length),e.fo(k),f.fo(k),g.GD(k);else throw Error(`length mismatch: ${k} x ${m}`);k=e.head;m=f.head}n.finish();
p.finish();t.finish()}else if(e&&f)e=Math.min(e.length,f.length),Lp(a,e),Lp(b,e),c.rows(e);else throw Error(`length mismatch: ${e} x ${f}`);e=a.head;f=b.head}a.finish();b.finish()};enb=function(a,b,c,d){return a.axis.isIdentity(c)&&a.axis.isIdentity(d)||b.items.isEmpty()?b:dnb("apply",a.ePd,b,c,d)};
dnb=function(a,b,c,d,e){const f=new Mp,[g,h]=a==="apply"?[c.items.Ad(e.pre),e.Ad(c.items.length,0)]:[c.items.Ad(e.post),e.Ad(0,c.items.length)];e=g.head;var k=h.head;for(c=0;e||k;){if(k&&k.type===1)Hp(h,k.length),a==="apply"?f.Cd(k.length):g.fo(k.length);else if(e&&e.type===0){e=g.Dv();const [n,p]=a==="apply"?[e.Ad(d.pre),d.Ad(e.length,0)]:[e.Ad(d.post),d.Ad(0,e.length)];e=a;k=new Mp;var m=n.head;let t=p.head;for(;m||t;){if(t&&t.type===1)Hp(p,t.length),e==="apply"?k.Cd(t.length):n.fo(t.length);else if(m)m.type===
0?k.grad(n.Dv()):t?(m=Math.min(m.length,t.length),n.fo(m),p.Yz(m),k.Cd(m)):(n.fo(m.length),k.Cd(m.length));else throw Error(`length mismatch: ${m} vs ${t}`);m=n.head;t=p.head}e=k.build();e.isEmpty()||(f.grad(e),c=Math.max(c,e.length));n.finish();p.finish()}else if(e&&k)e=Math.min(k.length,e.length),g.fo(e),h.Yz(e),f.Cd(e);else throw Error("length mismatch");e=g.head;k=h.head}g.finish();h.finish();a=f.build();return Np.of(b,a,c,a.length)};fnb=function(a){return{type:1,length:a}};
gnb=function(a,b,c){a=a.Ad(b);b=a.head;let d=0;for(;b;)d=b.type!==0&&a.q_e?d+Lp(a,b.length):d+a.mgc((e,f)=>c(e,d,f)),b=a.head;a.finish()};Lp=function(a,b){ia(a.wZ==null);return a.c1a.fo(b)};hnb=function(a,b,c,d){return c===d?!0:c&&d?a(b,c.Gg,d.Gg)&&a(b,c.r,d.r):!1};__c.inb=function(a,b,c,d){if(!d)return c;fa(a(b,c,d.Gg),"{} != {}",c,d.Gg);return d.r};jnb=function(a,b,c,d){return hnb(a,b,c,d)?void 0:{t:c,b:d}};
__c.knb=function(a,b,c){const d={};if(b&&c)for(const f of bnb(b,c)){var e=jnb(a,f,b[f],c[f]);e&&(d[f]=e)}else if(b)for(e of Op(b))(c=jnb(a,e,b[e]))&&(d[e]=c);else if(c)for(const f of Op(c))(b=jnb(a,f,void 0,c[f]))&&(d[f]=b);return Pp(d)?void 0:d};lnb=function(a,b,c){return bnb(b,c).every(d=>{var e=b&&b[d],f=c&&c[d];return e===f?!0:e&&f?hnb(a,d,e.t,f.t)&&hnb(a,d,e.b,f.b):!1})};Op=__c.Op=function(a){return Object.keys(a)};
bnb=function(a,b){return a&&b?[...(new Set([...Op(a),...Op(b)]))]:a?Op(a):b?Op(b):[]};Pp=__c.Pp=function(a){return Op(a).length===0};Qp=__c.Qp=function(a){return Object.keys(a)};Rp=function(a,b,c){for(const [d,e]of Object.entries(a))c(d,e,b[d])};mnb=function(a,b){return a.length?b.length?[...(new Set([...a,...b]))]:a:b};nnb=function(a,b){const c=Qp(a),d=Qp(b),e=mnb(c,d);return e.length===c.length&&e.length===d.length&&e.every(f=>a[f]===b[f])};onb=function(a,b){return{type:0,xF:a,hH:b}};
pnb=function(a){return{type:1,length:a}};qnb=function(a,b){return a&&b?a.SP===b.SP&&a.IN===b.IN:!a&&!b};rnb=function(a){return a&&{ao:a.iW,SP:a.IN,iW:a.ao,IN:a.SP}};__c.snb=function(a,b){Object.entries(a).forEach(([c,d])=>d!=null&&b(d,c))};tnb=function(a){var b=rnb;const c={};__c.snb(a,({r:d},e)=>c[e]={r:b(d,e)});return c};
unb=function(a,b){const c=Qp(a),d=Qp(b);if(a===b||!c.length&&!d.length)return!0;if(c.length!==d.length)return!1;const e=mnb(c,d);return c.length===e.length&&d.length===e.length&&e.every(f=>qnb(a[f].r,b[f].r))};vnb=function(a,b,c,d){const e={};for(const f of mnb(Qp(c),Qp(d)))c=a[f],d=b[f],c?d&&(Rn(c.iW,d.ao),Rn(c.IN,d.SP),c={ao:c.ao,SP:c.SP,iW:d.iW,IN:d.IN}):c=d,e[f]={r:c};return e};
wnb=function(a,b,c,d){const e={},f={},g=Bp.Oq();for(const h of mnb(Qp(c),Qp(d))){c=a[h];d=b[h];c&&d?(Rn(c.ao,d.ao),Rn(c.SP,d.SP),c=Dp({ao:d.iW,SP:d.IN,iW:c.iW,IN:c.IN})):c=Cp(d,c);const {Rt:k,uu:m}=Fp(g,c);f[h]={r:k};e[h]={r:m}}return g.build(f,e)};xnb=function(a,b={}){return{type:0,length:a,II:b}};
ynb=function(a,b,c,d,e){const f={};if(a.PAb.size){for(const g of a.PAb)f[g]={r:void 0},delete a.Eeb[g],delete a.Feb[g];a.PAb.clear()}Object.keys(a.SAb).length&&(Rp(a.SAb,a.Y3b,(g,h,k)=>{f[g]={r:{ao:d[g],SP:e[g],iW:h,IN:k}};a.Eeb[g]=h;a.Feb[g]=k}),a.SAb={},a.Y3b={});b&&c&&Rp(b,c,(g,h,k)=>{g in a.Eeb&&(f[g]={r:{ao:h,SP:k,iW:a.Eeb[g],IN:a.Feb[g]}})});return f};znb=function(a,b,c){return c&&{ao:c.o,iW:c.n,SP:c.o!=null?a.Y1a.encode(b,c.o):void 0,IN:c.n!=null?a.Y1a.encode(b,c.n):void 0}};
Anb=function(a,b){const c={};for(const [d,e]of Object.entries(b))e&&(c[d]={r:znb(a,d,e.r)});return c};Bnb=function(a,b,c){const d=a.p8a;if(d){a.p8a=void 0;var e=new Set;__c.snb(d,({r:f},g)=>{f?(a.mode==="apply"?(Rn(c[g],f.SP),a.Rba.Vc(g,f.iW,f.IN)):(Rn(c[g],f.IN),a.Rba.Vc(g,f.ao,f.SP)),a.open.add(g),e.add(g)):(a.Rba.Vc(g,b[g],c[g]),a.open.delete(g))});return e}};Sp=function(a,b,c,d){ia(0<=a);ia(0<=b);ia(a<=c);ia(b<=d);return{left:a,top:b,right:c,bottom:d}};
Cnb=function(a){const b=a.rows[a.y];if(b!=null)for(;b.cells[a.x]==null&&a.x<b.cells.length;)a.x++};Dnb=function(a){for(;a.rows[a.y]==null&&a.y<a.rows.length;)a.y++};Tp=function(a,b){return a.right===b.right&&a.bottom===b.bottom};
Enb=function(a,b,c,d){if(a.axis.isIdentity(c)&&a.axis.isIdentity(d))return b;const e=new Set,f=new Set;b.forEach((m,n,p)=>{e.add(m);f.add(n);switch(p.type){case 1:p.bounds&&e.add(p.bounds.o.right);p.bounds&&f.add(p.bounds.o.bottom);p.bounds&&e.add(p.bounds.n.right);p.bounds&&f.add(p.bounds.n.bottom);break;case 0:p.o&&e.add(p.o.right);p.o&&f.add(p.o.bottom);p.n&&e.add(p.n.right);p.n&&f.add(p.n.bottom);break;default:throw new q(p);}});const g=Ip(c,e),h=Ip(d,f),k=new Up;b.forEach((m,n,p)=>{switch(p.type){case 1:k.add(l(g.get(m)),
l(h.get(n)),a.update(p.bounds&&{o:{right:l(g.get(p.bounds.o.right)),bottom:l(h.get(p.bounds.o.bottom))},n:{right:l(g.get(p.bounds.n.right)),bottom:l(h.get(p.bounds.n.bottom))}},p.delta));break;case 0:k.add(l(g.get(m)),l(h.get(n)),a.replace(p.o&&{right:l(g.get(p.o.right)),bottom:l(h.get(p.o.bottom)),state:p.o.state},p.n&&{right:l(g.get(p.n.right)),bottom:l(h.get(p.n.bottom)),state:p.n.state}));break;default:throw new q(p);}});return k.build()};
Hnb=function(a,b,c){const d=new Up;Fnb(b.Ad(),c.Ad(),(e,f,g,h)=>{b==null&&c==null||d.add(e,f,Gnb(a,g,h))});return d.build()};Fnb=function(a,b,c){var d=a.head;let e=b.head;for(;d||e;){d=d==null?1:e==null?-1:d===e||d.y===e.y&&d.x===e.x?0:d.y<e.y||d.y===e.y&&d.x<e.x?-1:1;if(d<0){const {x:f,y:g,value:h}=a.wn();c(f,g,h,void 0)}else if(d>0){const {x:f,y:g,value:h}=b.wn();c(f,g,void 0,h)}else{const {x:f,y:g,value:h}=a.wn();({value:d}=b.wn());c(f,g,h,d)}d=a.head;e=b.head}a.finish();b.finish()};
Gnb=function(a,b,c){if(b==null)return c;if(c==null)return b;switch(b.type){case 0:a:switch(c.type){case 1:ia(b.n!=null);c.bounds&&ia(Tp(b.n,c.bounds.o));a=a.replace(b.o,{...(c.bounds?c.bounds.n:b.n),state:c.delta?a.component.apply(b.n.state,c.delta):b.n.state});break a;case 0:ia(Vp(a,b.n,c.o));a=a.replace(b.o,c.n);break a;default:throw new q(c);}return a;case 1:a:switch(c.type){case 1:b.bounds&&c.bounds&&ia(Tp(b.bounds.n,c.bounds.o));const d=b.bounds&&c.bounds?{o:b.bounds.o,n:c.bounds.n}:b.bounds||
c.bounds;b=b.delta&&c.delta?a.component.compose(b.delta,c.delta):b.delta||c.delta;a=a.update(d,b);break a;case 0:ia(c.o!=null);b.bounds&&ia(Tp(b.bounds.n,c.o));a=a.replace({...(b.bounds?b.bounds.o:c.o),state:b.delta?a.component.Nl(c.o.state,b.delta):c.o.state},c.n);break a;default:throw new q(c);}return a;default:throw new q(b);}};Vp=function(a,b,c){return b===c?!0:b&&c?Tp(b,c)&&a.component.Bj(b.state,c.state):!1};
Knb=function(a,b,c,d,e,f){const g=d.type===0?d.n:d.bounds&&d.bounds.n,h=g?g.bottom:c;for(let n=Math.max(c,f.YUd);n<=h;n++)Inb(f,n*2),f.iy(),f.mgc((p,t)=>{e.append(Sp(p,t,p,t))}),f.Plb();f.YUd<=h&&Inb(f,(h+1)*2);if(g==null)return{qhb:b}=Jnb(e,{left:b,top:c,right:b,bottom:c}),b?a.replace(void 0,void 0):void 0;const {qhb:k,$Zb:m}=Jnb(e,{left:b,top:c,right:g.right,bottom:g.bottom});if(k){if(m)return a.update({o:{right:g.right,bottom:g.bottom},n:m},void 0);ia(d.type===0);return a.replace(d.n,void 0)}};
Mnb=function(a,b){Lnb(a,b.left,b.top);a.append(b)};Jnb=function(a,b){Lnb(a,b.left,b.top);if(a.readBuffer(b.left,b.top))return{qhb:!0,$Zb:void 0};let c=b.left,d=b.top;for(var e=b.left+1;e<=b.right;e++){if(a.readBuffer(e,b.top))return{qhb:!0,$Zb:{right:c,bottom:d}};c=e}for(e=b.top+1;e<=b.bottom;e++){for(let f=b.left;f<=c;f++)if(a.readBuffer(f,e))return{qhb:!0,$Zb:{right:c,bottom:d}};d=e}return{qhb:!1,$Zb:void 0}};
Lnb=function(a,b,c){c>a.nia&&(a.buffer.splice(0,c-a.nia),a.nia=c,a.Kya=0);b>a.Kya&&a.buffer[0]&&(a.buffer[0].splice(0,b-a.Kya),a.Kya=b)};Nnb=function(a,b,c){c-=a.nia;a=c===0?b-a.Kya:b;ia(c>=0&&a>=0);return{RUd:a,VUd:c}};Onb=function(a,b){a=a.axis.pe();b=b.Ad();let c=b.head;for(;c;){switch(c.type){case 0:a.retain(c.length*2);b.Yz(c.length);break;case 1:a.expand(c.length*2);Hp(b,c.length);break;default:throw new q(c);}c=b.head}return a.build()};
Inb=function(a,b){for(ia(b>=a.Zpa);b>a.Zpa;){var c=a.Ad.head;ia(c!=null);c.type===0?(a.iy(),a.Plb()):(c=Math.min(c.length,b-a.Zpa),Lp(a.Ad,c),a.Zpa+=c)}};Pnb=function(a,b){return a===b||a.size===b.size&&Array.from(a.keys()).every(c=>a.get(c)===b.get(c))};Qnb=function(a,b){if(!a.size)return b;if(!b.size)return a;const c=new Map;for(const [e,f]of a){var d=b.get(e)||0;(d=f+d)&&c.set(e,d)}for(const [e,f]of b)a.has(e)||c.set(e,f);return c};
Snb=function(a,b,c){return c==null||a.component.isIdentity(c)?Rnb:new Map([[b,c]])};Tnb=function(a,b){return a.size?b.size?new Set([...a.keys(),...b.keys()]):a.keys():b.keys()};Wp=function(a){return a===1?Unb:{type:0,length:a}};Wnb=function(a){return a===1?Vnb:{type:1,length:a}};Ynb=function(a){return a===1?Xnb:{type:2,length:a}};Xp=function(a,b){return{type:3,state:a,shift:b}};Yp=function(a,b){return{type:4,delta:a,shift:b}};
aob=function(a){switch(a.type){case 0:return`R(${a.length})`;case 1:return`X(${a.length})`;case 2:return`T(${a.length})`;case 3:return`I(${Znb(a.state)})${$nb(a.shift)}`;case 4:return`U(${Znb(a.delta)})${$nb(a.shift)}`;default:throw new q(a);}};Znb=function(a){return a!=null?a:"\u22a5"};$nb=function(a){return a!=null?`[${a.Qa},${a.$l}]`:""};
cob=function(a,b){return b&&a.wUa?new bob(a.ops.map(c=>c.type===3&&c.shift?Xp(c.state,{Qa:c.shift.Qa+b,$l:c.shift.$l+b}):c.type===4&&c.shift?Yp(c.delta,{Qa:c.shift.Qa+b,$l:c.shift.$l+b}):c),a.pre,a.post,a.wUa):a};dob=function(a,b){fa(b.length>0);const c=a.length;b.forEach((d,e)=>a.list[c+e]=d);a.length+=b.length};Zp=function(a,b){const c=l(a.xm);if(c.type===0)return a.ND(0,1),eob;if(c.type===1)return a.ND(1,1),fob;if(c.type===2)return a.ND(2,1),gob;if(c.type!==b)throw Error();a.xm=a.ops[a.i++];return c};
hob=function(a){return a.every(()=>!1)};iob=function(a){fa(a.mQa<a.input.length,"{} >= {}",a.mQa,a.input.length);return a.input[a.mQa++]};job=function(a,b){b=a.mQa+b;fa(b<=a.input.length);const c=a.input.slice(a.mQa,b);a.mQa=b;return c};kob=function(a,b){a.usb||(a.usb=new Set);fa(!a.usb.has(b),"duplicate modification: {}",b);a.usb.add(b)};lob=function(a,b,c){kob(a,b);(a.xIc||(a.xIc=new Map)).set(b,c)};mob=function(a,b,c){kob(a,b);(a.wIc||(a.wIc=new Map)).set(b,c)};
nob=function(a,b){let {Qa:c,$l:d}=b;var e=a.xIc;a=a.wIc;if(e){const f=e.get(c);f!=null&&(c=f,e.delete(c))}a&&(e=a.get(d),e!=null&&(d=e,a.delete(d)));return c!==b.Qa||d!==b.$l?{Qa:c,$l:d}:b};$p=function(a,b,c){kob(a,b);c!=null&&(a.m5b||(a.m5b=new Map)).set(b,c)};aq=function(a,b,c){(a.Pab||(a.Pab=new Map)).set(b,c)};bq=function(a,b,c){(a.mab||(a.mab=new Map)).set(c,b)};oob=function({Qa:a,$l:b}){return{Qa:b,$l:a}};pob=function(a,b){return a?!!b&&a.Qa===b.Qa&&a.$l===b.$l:!b};
qob=function(a,b,c,d){a.lm.set(b,new cq(c,d));return a};sob=function(a,b,c,d){a.lm.set(b,new rob(c,d));return a};tob=function(a,b){return a.size?b.size?new Set([...a.keys(),...b.keys()]):a.keys():b.keys()};
uob=function(a,b,c){if(a.axis.isIdentity(c))return b;a=new Set;for(const e of b.values())switch(e.type){case 0:e.oldValue!=null&&a.add(e.oldValue);e.newValue!=null&&a.add(e.newValue);break;case 1:a.add(e.oldValue);a.add(e.newValue);break;default:throw new q(e);}const d=Ip(c,a);return gh(b,e=>{switch(e.type){case 0:return new cq(e.oldValue!=null?l(d.get(e.oldValue)):void 0,e.newValue!=null?l(d.get(e.newValue)):void 0);case 1:return new rob(l(d.get(e.oldValue)),l(d.get(e.newValue)));default:throw new q(e);
}})};vob=function(a,b){a=a.length;fa(0<=b&&b<a,"{} \u2209 [0, {})",b,a)};wob=function(a,b){a=a.length;fa(0<b&&b<a,"{} \u2209 (0, {})",b,a)};dq=function(a){return a>0?0:a===0?1:2};xob=function(a){fa(!0);for(const b of a.sequence){const c=dq(b);switch(c){case 0:return a.je[0].startsWith("\n");case 2:break;case 1:return!1;default:throw new q(c);}}return!1};
yob=function(a){const b=a.sequence.length?a.sequence[a.jgf++]:void 0;if(b!=null){var c=dq(b);switch(c){case 0:return a=a.je[a.$he++],Rn(a.length,b),new eq(a);case 1:return new fq(a.items[a.rRe++]);case 2:return new gq(-b);default:throw new q(c);}}};zob=function(a,b){return a?b?{bb:Jp(a.bb,b.bb),item:Jp(a.item,b.item),vm:Jp(a.vm,b.vm)}:a:b};Aob=function(a,b){a=a.Jfa;fa(0<b&&b<a,"{} \u2209 (0, {})",0,a)};Bob=function(a,b){a=a.V5;fa(0<b&&b<a,"{} \u2209 (0, {})",0,a)};
hq=function(a,b,c){switch(b.type){case 0:case 1:switch(c.type){case 0:case 1:return a.Lp(b.state,c.state);case 2:return a.aU(b.state);default:throw new q(c);}case 2:switch(c.type){case 0:case 1:return a.kya(c.state);case 2:return a.J6(b.state);default:throw new q(c);}default:throw new q(b);}};iq=function(a){const b=l(a.xm);a.xm=a.ops[a.i++];return b};Cob=function(a,b){const c=l(a.xm),d=c.Jfa;fa(0<b&&b<=d);if(b<d){const [e,f]=c.u2b(b);a.xm=f;return e}a.xm=a.ops[a.i++];return c};
Dob=function(a,b){const c=l(a.xm),d=c.V5;fa(0<b&&b<=d);if(b<d){const [e,f]=c.t2b(b);a.xm=f;return e}a.xm=a.ops[a.i++];return c};Fob=function(a,b,c){switch(c.type){case 0:return b;case 1:return fa(b.type===1),new fq(a.component.apply(b.state,c.delta));case 3:return Eob(a,b,c.oldState),c.newState;default:throw new q(c);}};
Gob=function(a,b,c){switch(c.type){case 0:return b;case 1:return fa(b.type===1),new fq(a.component.Nl(b.state,c.delta));case 3:return Eob(a,b,c.newState),c.oldState;default:throw new q(c);}};jq=function(a,b,c){switch(b.type){case 0:return c.type===0&&b.state===c.state;case 1:return c.type===1&&a.component.Bj(b.state,c.state);case 2:return c.type===2&&b.state===c.state;default:throw new q(b);}};Eob=function(a,b,c){fa(jq(a,b,c),"{} != {}",b,c)};kq=function(a){return{start:`${"a/"}${a}`,end:`${"b/"}${a}`}};
Hob=function(a){ia(a.startsWith("a/")||a.startsWith("b/"));return a.substring(2)};lq=function(a){return typeof a==="string"?a.length:1};mq=function(a,b){return a?!!b&&a.from===b.from&&a.to===b.to:!b};Iob=function(a,b){let c=0,d=0;for(const e of a.qja)switch(a=e.length,e.type){case 0:b.retain&&b.retain(a,c,d);c+=a;d+=a;break;case 1:b.insert&&b.insert(a,c,d);d+=a;break;default:throw new q(e.type);}};
Job=function(a,b,c){let {from:d,to:e}=a;d+=d>b?c:0;e+=e>b?c:0;return a.from!==d||a.to!==e?new nq(d,e):a};Kob=function(a,b,c){for(const [d,e]of a){const f=Job(e,b,c);f!==e&&a.set(d,f)}};oq=function(a,b,c,d){for(const [e,f]of a){const g=f.Kfa,h=f.Cfa,k=g&&(b!=null?Job(g,b,d):g),m=h&&(c!=null?Job(h,c,d):h);k===g&&m===h||a.set(e,new Lob(k,m))}};Mob=function(a,b){return a.size?b.size?new Set([...a.keys(),...b.keys()]):a.keys():b.keys()};
qq=function(a,b,c,d){const {x:e,y:f,...g}=b;fa(a.axis.wk(e,pq(a,c)));fa(a.axis.wk(f,pq(a,d)));return g};pq=function(a,b){const c=a.axis.pe();b.ops.forEach(d=>{switch(d.type){case 0:c.retain(d.length);break;case 1:c.expand(d.length);break;case 2:c.retain(d.length);break;case 3:c.expand(1);break;case 4:c.retain(1);break;default:throw new q(d);}});return c.build()};Nob=function(a,b){Rn(a,b);return a};rq=function(a,b){return{key:a.VAa(b),value:b}};
sq=function(a,b,c){if(a.isIdentity(b)||a.isIdentity(c))return c;let d=a.Vob.get(b);d==null&&(d=Symbol(),a.Vob.set(b,d));a.Vob.set(c,d);return c};Oob=function(a){a.sYa=void 0;a.hza&&a.hza.reportChanged()};Pob=function(a,b){if(a.clients){for(const c of a.clients.keys())try{c.onError(b)}catch(d){}a.clients=void 0}};
Qob=function(a,b){ia(a.oN!=null);if(a.clients){var c=!1;for(const d of a.clients.keys())try{d.QR(b)}catch(e){try{d.onError(`could not publish to incoming: ${e}`)}catch(f){}a.clients.delete(d);c=!0}c&&!a.clients.size&&(a.clients=void 0)}};Rob=function(a,b){let c=a.rows[b];c==null&&(c=a.rows[b]=a.p_e++);return c};Sob=function(a,b){let c=a.cols[b];c==null&&(c=a.cols[b]=a.m_e++);return c};
Tob=function(a,b,c,d=()=>!0){a.cols.spliceWithArray(b,0,Array(c));for(let e=0;e<a.rows.length;e++){const f=a.get(e,b-1);if(f!=null&&d(f))for(let g=b;g<b+c;g++)a.set(e,g,f)}};Uob=function(a,b,c,d=()=>!0){a.rows.spliceWithArray(b,0,Array(c));for(let e=0;e<a.cols.length;e++){const f=a.get(b-1,e);if(f!=null&&d(f))for(let g=b;g<b+c;g++)a.set(g,e,f)}};__c.Vob=function(a){return a.filter(()=>!0)};
tq=function(a,b){fa(Object.getPrototypeOf(a)===Object.prototype);const c={};for(const d in a)c[d]=b(a[d],d);return c};Wob=function(a){const b={};for(const c in a){const d=a[c];fa(!(d in b),"non-unique value in record: {}",d);b[d]=c}return b};vq=__c.vq=function(a,b){return a===uq?b:b===uq?a:new Xob(a,b)};Cq=function(a,b){return new Yob(a,b)};Dq=function(a,...b){return b.every(c=>c===uq)?uq:new a(...b)};$ob=function(a){return Object.keys(a).length===0?Cq({},{}):new Zob(a)};
bpb=function(a,b,c){return new apb(a,b,c)};Eq=__c.Eq=function(a,b){return b===void 0?Dq(cpb,a):new cpb(a,b)};Fq=__c.Fq=function(a,b){const c=new dpb(d=>new a(d));return b!=null?vq(c,epb(b)):c};epb=function(a){var b=fpb.structural;return{serialize:c=>b(c,a)?void 0:c,deserialize:c=>c!=null?c:a}};hpb=function(a){return vq(gpb,$ob({oldState:a,newState:a}))};__c.lpb=function(a,b,c,d){return bpb({[0]:vq(vq(ipb,$ob({delta:a})),c),[1]:vq(hpb(b),d)},jpb,kpb)};jpb=function(a){return a.type};
kpb=function(a){switch(a.type){case "UPDATE":return 0;case "REPLACE":return 1;default:throw new q(a.type);}};mpb=function(a){a.etb?.reportChanged();a.etb=void 0};npb=function(a,b){a.domain.isIdentity(b)||(a.UMa==null&&(a.UMa=[]),a.UMa.push(b),a.oT?.reportChanged())};opb=function(a){a.UMa&&(a.j7=a.domain.apply(a.j7,Tmb(a.domain,a.UMa)),a.UMa=void 0)};ppb=function(a){return a};rpb=function(a,b,c){return a.Mu({[qpb]:qpb,metrics:{}.metrics},b,c,d=>d)};
spb=function(a){const b=__c.zp(c=>a(c));return c=>c!=null&&typeof c==="object"?b(c):a(c)};tpb=function(a,b,c,d){const e=a.Df.c7a(a.Df.v6(b,d)),f=a.Df.Iyc(e,(h,k)=>a.Df.qOb(e,k)),g={};a.Df.M9(f,b,(h,k)=>{g[k]={o:c?.[k],n:f[k]}});return g};vpb=function(a,b){gnb(b,a.Df.JC,(c,d,e)=>{const f=a.grid.get(d,e),g=f?{...f}:{};upb(c,(h,k)=>{h!=null&&(ia(a.Df.yIa(k,f?.[k],h.o)),h.n==null?delete g[k]:g[k]=h.n)});a.write(d,e,g)})};upb=function(a,b){for(const c of Object.keys(a))b(a[c],c)};
wpb=function(a,b){return a&&b?[...(new Set([...Object.keys(a),...Object.keys(b)]))]:a?Object.keys(a):b?Object.keys(b):[]};ypb=function({CF:a,qe:b}){return{ecc:c=>new xpb(b,a.ecc(c.yIa),c,Gq,Gq)}};Hq=__c.Hq=function(a,b){return a.p6b(bpb({[0]:Cq(),[1]:vq(hpb(a.type.serializer),b)},c=>c==null?0:c.type,c=>c==null?0:1))};Apb=function(a){return new zpb(a)};
Epb=function({CF:a,Tk:b,qe:c}){const d=e=>new Bpb(c,a.box(a.value((f,g)=>e.Fu(f,g),f=>e.hg(f))),e,Gq,e.serializer);return{Vc:d,box:e=>new Cpb(c,a.box(e.domain),e,Gq,e.al),xg:e=>d(b.optional(e)),Pfc:e=>d(b.Qfc(e)),ARd:e=>new Dpb(c,a.box(a.value((f,g)=>e.Fu(f,g),f=>e.hg(f))),e,Gq,e.serializer),jmf:d(b.string),lq:d(b.boolean),xjb:d(b.double),Swg:d(b.int32),dLg:d(b.sJ),eLg:d(b.Efa),cBc:d(b.TF),DCd:d(b.CCd),Pwd:d(b.Owd),TOc:d(b.ANd),ou:d(b.optional(b.string)),jOg:d(b.optional(b.boolean)),kOg:d(b.optional(b.double)),
I4e:d(b.optional(b.sJ)),oOg:d(b.optional(b.Efa)),fEc:d(b.optional(b.TF))}};Fpb=function(a,b){const c=new Up,d=new Set;for(let e=b.top;e<=b.bottom;e++)for(let f=b.left;f<=b.right;f++){const g=a.grid.get(e,f);g==null||d.has(g)||(d.add(g),c.add(g.span.left,g.span.top,a.domain.replace({right:g.span.right,bottom:g.span.bottom,state:g.Jj.snapshot()},void 0)))}return a.domain.mf({cells:c.build()})};
Gpb=function(a,b){return c=>{const {left:d,top:e}=b.dAd.get();return a.domain.mf({cells:(new Up).add(d,e,a.domain.update(void 0,c)).build()})}};Jpb=function(a,b,c){var d=a.grid;var e={left:Sob(a.grid,c.left),top:Rob(a.grid,c.top),right:Sob(a.grid,c.right),bottom:Rob(a.grid,c.bottom)};d=new Hpb(d,e);b=a.type.Mu(a.context,b,a,Gpb(a,d));b=new Ipb(b,d);for(d=c.top;d<=c.bottom;d++)for(e=c.left;e<=c.right;e++)a.grid.set(d,e,b)};Lpb=function({CF:a,qe:b}){return{ora:c=>new Kpb(b,a.ora(c.domain),c,Gq,Gq)}};
Opb=function({CF:a,qe:b}){return{counter:new Mpb(b,a.counter,uq,uq),Yvd:new Npb(b,a.Yvd,uq,uq)}};Ppb=function(a,b,c){return a.valueType.Mu(a.context,c,a,d=>a.domain.update(b,d))};__c.Iq=function(a,b,c,d){var e=a.p6b;var f=a.keyType.serializer;c=__c.lpb(Eq(a.valueType.MK),Eq(a.valueType.al),c,d);f=Dq(Qpb,f,c);return e.call(a,vq(f,vq(__c.Rpb,b)))};Tpb=function({CF:a,Tk:b,qe:c}){return{fB:(...d)=>{const [e,f]=d.length===1?[b.string,d[0]]:d;return new Spb(c,a.fB(f.domain),e,f,Gq,Dq(Qpb,e.serializer,f.al))}}};
__c.Jq=function(a,b){var c=a.Ky,d=a.values;const e=new Map;for(const f of d)fa(!e.has(b[f]),"invalid literal mapping for: {}",f),e.set(b[f],f);return c.call(a,new Upb(b,e))};Xpb=function({CF:a}){return{z0:b=>new Vpb(a.value((c,d)=>b.Fu(c,d),c=>b.hg(c)),b,uq,b.serializer),mke:b=>new Wpb(b.domain,b.al)}};bqb=function({CF:a,qe:b}){return{list:c=>new Ypb(b,a.list(c.domain),c,Gq,vq(Zpb,new $pb(Dq(aqb,c.al)))),pEd:c=>new Ypb(b,a.list(c.domain),c,Gq,vq(Zpb,new $pb(Dq(aqb,c.al))))}};
dqb=function({CF:a}){const b=Object.freeze({serialize(c){throw new q(c);},deserialize(c){throw new q(c);}});return{never:new cqb(a.never,b,b)}};fqb=function({CF:a,Tk:b}){function c(d){return d instanceof Kq?b.$zd(d):new eqb(a.option(d.domain),d,Eq(d.MK),Eq(d.al))}return{optional:c,Qma:c(b.string),E4e:c(b.boolean),mOg:c(b.int32),nOg:c(b.fOe),Ufa:c(b.double),cub:c(b.sJ),J4e:c(b.Efa),Pzd:c(b.TF)}};gqb=function(a,b){let c=a.items[b];c==null&&(c=a.items[b]={});return c};Lq=function(a,b){if(b!=null)return l(a.Tpd.get(b))};
iqb=function({CF:a,qe:b}){return{gn:new hqb(b,a.gn,Gq,uq)}};__c.jqb=function(a,b,c){const d=a.pe(),e=b.cursor(0,{...Mq,vm:h=>d.retain(h)}),f={...Mq,bb:h=>d.retain(h.length)},g={...Mq,bb:h=>d.aU(h)};c.forEach({retain:h=>e.zt(h,f),delete:h=>e.zt(h,g),insert:h=>d.insert(h)});return d.build()};
kqb=function(a,b){const c=new Nq,d=a.cursor();a=h=>{throw Error(String(h));};const e={...Mq,bb:h=>c.retain(h.length)},f={...Mq,bb:a},g={...Mq,bb:()=>0,vm:a};b.forEach({retain:h=>d.qJ(h,e),update:h=>{throw new q(h);},insert:h=>h.type!==2&&c.insert(h.state),Lp:(h,k)=>{h.type===2?(d.qJ(h.length,f),k.type!==2&&c.insert(k.state)):(d.qJ(h.length,g),k.type===2?c.delete(h.length):(fa(h.state===k.state,"non-reflexive change: {} != {}",h,k),c.retain(h.length)))}});return c.build()};
mqb=function({CF:a,qe:b}){return{raa:new lqb(b,a.raa(a.never),Gq,Gq)}};pqb=function({CF:a,Tk:b}){const c=new nqb(a.gn,a.axis,a.Kl.UQ);return{Kl:b.gn.map(c.cid,c.uPd,c.eid,c.vPd,d=>new oqb(d,c),d=>d.base)}};rqb=function(a,b,c,d){return qqb.of(a,{...b,...c,...d})};sqb=function(...a){const b=new Set;for(const c of a)for(const d in c)fa(!b.has(d),'duplicate key: "{}"',d),b.add(d)};
tqb=function(a){if(a.eI.computed==null)return{ab:{},attributes:{}};const {ab:b,attributes:c,bv:d}=a.eI.computed.create(a.fields);return{ab:tq(a.eI.computed.ab,(e,f)=>b[f]),attributes:tq(a.eI.computed.attributes,(e,f)=>c[f]),bv:d}};uqb=function(a,b){const c=tq(a.eI.values,(d,e)=>a.getValue(e));Object.defineProperties(c,b);Object.defineProperty(c,Oq,{enumerable:!1,writable:!1,value:a});return c};
vqb=function(a,b){if(!a)return b;if(!b)return a;const c=a.create,d=b.create;return{ab:{...a.ab,...b.ab},attributes:{...a.attributes,...b.attributes},create:e=>{const {ab:f,attributes:g,bv:h}=c(e),{ab:k,attributes:m,bv:n}=d({...e,...f,...g});return{ab:{...f,...k},attributes:{...g,...m},bv:h&&n?()=>{h();n()}:h||n}}}};xqb=function({CF:a,qe:b}){const c=new __c.wqb(b,{},{},{},void 0,(d,e)=>a.value(d,e),Gq,Gq);return{Qa:d=>c.Gf(d)}};
Aqb=function({CF:a}){return{reference:b=>new yqb(a.reference,b),sdh:b=>new __c.zqb(b)}};
Cqb=function(a,b,c){const d=b.cells.cursor(b.length),e=new Bqb(a);a=m=>{throw Error(String(m));};const f={...Mq,bb:a},g={...Mq,bb:()=>0,vm:a},h={...Mq,bb:m=>e.retain(m.length),vm:()=>0},k={...Mq,bb:m=>e.delete(m.length),vm:a};c.forEach({retain:(m,n)=>{e.Lp(n);d.qJ(m,h)},insert:(m,n)=>{e.Lp(n);m.type!==2&&e.insert(m.state)},Lp:(m,n,p)=>{e.Lp(p);m.type===2?(d.qJ(m.length,f),n.type!==2&&e.insert(n.state)):n.type===2?d.qJ(m.length,k):(fa(m.state===n.state,"non-reflexive change: {} != {}",m,n),d.qJ(m.length,
g),e.retain(m.length))}});return e.build()};__c.Dqb=function(a,b){a.Eu(a.domain.mf(void 0,b))};Eqb=function(a,b){fa(!a.cells.qra||a.cells.bb().endsWith("\n"),"character stream must be empty or terminated with a \\n");a.forEach({...Mq,bb:(c,d)=>b.dK(d),vm:(c,d)=>b.dK(d)})};Fqb=function({CF:a,qe:b}){return{Sdf:(c,d)=>{const e=a.EGd(a.never,void 0);return new Pq(b,e,c,d,Gq,Gq)}}};
Gqb=function({CF:a,qe:b}){const c=(d,e)=>{const f=a.EGd(d.domain,a.selection);return new __c.Qq(b,f,e,d,Gq,Gq)};return{j_g:c,Tdf:c}};Hqb=function(a,b){let c;for(let d=b.top;d<=b.bottom&&!(c=a.JCa(d));d++);return c};Iqb=function(a,b){let c;for(let d=b.left;d<=b.right&&!(c=a.ICa(d));d++);return c};Jqb=function(a,b){let c;for(let d=b.bottom;d>=b.top&&!(c=a.JCa(d));d--);return c};Kqb=function(a,b){let c;for(let d=b.right;d>=b.left&&!(c=a.ICa(d));d--);return c};
Lqb=function(a,b){const c=a.R3(b.Oh),d=a.L6(b.Th),e=a.R3(b.yk||b.Oh);a=a.L6(b.ak||b.Th);fa(c!=null&&d!=null&&e!=null&&a!=null);fa(d<=a&&c<=e);return{left:c,top:d,right:e,bottom:a}};Nqb=function({CF:a,Tk:b,qe:c}){return{sheet:(d,e,f,g)=>new Mqb(c,a.sheet(d.domain,e.domain,f.domain,g.domain),d,e,f,g,b.Kl,a.Kl,b.gn,a.axis,Gq,Gq)}};Oqb=function({CF:a}){return{vo:(b,c,d)=>new __c.Rq(a.union(tq(b,e=>e.domain),c),b,c,d,Gq,Gq)}};Qqb=function({CF:a}){return{unit:new Pqb(a.unit,uq,uq)}};
$qb=function(){const a=(B,C)=>new Rqb(B,C,Dq(aqb,B.serializer)),b=(B,C)=>{fa(Number.isSafeInteger(B)&&Number.isSafeInteger(C)&&B<=C);return new Sq(D=>Number.isSafeInteger(D)&&B<=D&&D<=C,uq)},c=(B,C)=>{fa(Number.isFinite(B)&&Number.isFinite(C)&&B<=C);return new Sq(D=>Number.isFinite(D)&&B<=D&&D<=C,uq)},d=new Sq(B=>typeof B==="boolean",uq),e=new Sq(B=>typeof B==="string",uq),f=new Sq(B=>B.length===1,uq),g=b(-2147483648,2147483647),h=new Sq(B=>Number.isSafeInteger(B),uq),k=b(0,2147483647),m=b(1,2147483647),
n=b(0,Number.MAX_SAFE_INTEGER),p=new Sq(B=>Number.isFinite(B),uq),t=c(0,Number.MAX_VALUE),v=new Sq(B=>Number.isFinite(B)&&0<B&&B<=Number.MAX_VALUE,uq),x=a(t),z=a(e);return{value:B=>new Sq(B,uq),literal:(...B)=>B.length===1?new __c.Sqb(new Set(B),Cq(B[0],B[0])):new __c.Sqb(new Set(B),uq),nM:a,oKb:(B,C)=>new Tqb(B,C,Dq(Qpb,uq,C.serializer)),qf:(B,C)=>new Uqb(B,C,Gq),Hba:(B,C)=>new Vqb(B,C,Gq),$zd:B=>new Wqb(B,Eq(B.serializer)),Qfc:B=>new Xqb(B,Eq(B.serializer)),regexp:B=>new Yqb(B,uq),dOe:b,number:c,
cMg:()=>new Zqb(Gq),boolean:d,string:e,char:f,int32:g,fOe:h,sJ:k,z8e:m,Efa:n,double:p,TF:t,CCd:v,Owd:x,ANd:z}};arb=function(a,b){const c=new Map;for(const [d,e]of a)b(e)&&c.set(d,e);return c};crb=function({CF:a,qe:b}){return{kmf:new brb(b,a.zle(),Gq,Gq)}};Tq=__webpack_require__(186901);drb=Tq.Es;Uq=__c.Uq=Tq.EW;fpb=Tq.m3;erb=Tq.MN;frb=Tq.O8;grb=Tq.q$;Vq=Tq.sH;hrb=Tq.Tx;var irb=__webpack_require__(450117).B7;__c.jrb=__webpack_require__(268245).p;__c.krb=__webpack_require__(535921).T;var lrb=__webpack_require__(536618).iB;var Wq=class{};var Xq=class extends Wq{static equals(a,b){return a?!!b&&a.equals(b):!b}map(a,b,c,d){return new mrb(this.qe,this,a,b,c,d)}constructor(a){super();this.qe=a}},mrb=class extends Xq{isIdentity(a){return this.component.isIdentity(this.QS(a))}compose(a,b){return this.MX(this.component.compose(this.QS(a),this.QS(b)))}transform(a,b){a=this.component.transform(this.QS(a),this.QS(b));return Umb(a,c=>this.MX(c))}xl(a){return this.MX(this.component.xl(this.QS(a)))}wk(a,b){return a===b||this.component.wk(this.QS(a),
this.QS(b))}identity(a){return this.MX(this.component.identity(this.O7(a)))}apply(a,b){const c=this.O7(a);b=this.component.apply(c,this.QS(b));return c===b?a:sq(this.qe,a,this.Ns(b))}Nl(a,b){const c=this.O7(a);b=this.component.Nl(c,this.QS(b));return c===b?a:sq(this.qe,a,this.Ns(b))}hg(a){return this.Ns(this.component.hg(this.O7(a)))}Bj(a,b){return a===b||this.component.Bj(this.O7(a),this.O7(b))}equals(a){return this===a}constructor(a,b,c,d,e,f){super(a);this.component=b;this.MX=c;this.QS=d;this.Ns=
e;this.O7=f}},Bp=class{static Oq(){return new nrb}constructor(a,b,c,d){this.Rt=a;this.uu=b;this.iAa=c;this.PGa=d}},nrb=class{build(a,b){return new Bp(a,b,this.iAa,this.PGa)}constructor(){this.PGa=this.iAa=!1}};var qrb=class{xba(a){if(this.mode!==a){switch(this.mode){case void 0:break;case 0:this.ops.push(Gp(this.acc));this.pre+=this.acc;this.post+=this.acc;this.acc=0;break;case 1:this.ops.push(Xmb(this.acc));this.post+=this.acc;this.acc=0;break;default:throw new q(this.mode);}this.mode=a}}accumulate(a,b=1){fa(b>=0,"{} < 0",b);b&&(this.xba(a),this.acc+=b);return this}retain(a){return this.accumulate(0,a)}expand(a){return this.accumulate(1,a)}append(a){switch(a.type){case 0:return this.accumulate(0,a.length);
case 1:return this.accumulate(1,a.length);default:throw new q(a);}}build(){this.mode!==0&&this.xba();return this.ops?new orb(this.ops,this.pre,this.post):prb}constructor(){this.ops=[];this.acc=this.post=this.pre=0;this.mode=void 0}},rrb=class{static create(a,b,c,d=0,e=0){fa(d>=0,"{} < 0",d);fa(e>=0,"{} < 0",e);b=Math.max(0,d-b,e-c);return new rrb(b?[...a,Gp(b)]:a)}get head(){return this.xm}Yz(a){return this.ND(0,a).length}ND(a,b=1){const c=l(this.xm);if(c.type!==a)throw Error();const d=c.length;fa(0<
b&&b<=d,"{} \u2209 (0, {}]",b,d);if(b<d)switch(a){case 0:return this.xm=Gp(d-b),Gp(b);case 1:return this.xm=Xmb(d-b),Xmb(b);default:throw new q(a);}else return this.xm=this.ops[this.i++],c}finish(){ia(this.xm==null)}constructor(a){this.ops=a;this.i=0;this.xm=a[this.i++]}},orb=class{isEmpty(){return this.pre===0&&this.post===0&&this.ops.length===0}Ad(a,b){return rrb.create(this.ops,this.pre,this.post,a,b)}toString(){return this.ops.map(a=>{switch(a.type){case 0:return`R(${a.length})`;case 1:return`X(${a.length})`;
default:throw new q(a);}}).join("")}constructor(a,b,c){this.ops=a;this.pre=b;this.post=c}},prb=new orb([],0,0),srb=class extends Xq{pe(){return new qrb}isIdentity(a){return a.isEmpty()}compose(a,b){if(this.isIdentity(a))return b;if(this.isIdentity(b))return a;const c=this.pe(),d=a.Ad(0,b.pre),e=b.Ad(a.post,0);let f=d.head,g=e.head;for(;f||g;){if(g)if(g.type===1)c.append(e.ND(g.type,g.length));else if(f)if(f.type===1){var h=Math.min(f.length,g.length);d.ND(f.type,h);e.ND(g.type,h);c.append(Xmb(h))}else h=
Math.min(f.length,g.length),d.ND(f.type,h),e.ND(g.type,h),c.append(Gp(h));else throw Error(`length mismatch: ${a} ; ${b}`);else throw Error(`length mismatch: ${a} ; ${b}`);f=d.head;g=e.head}d.finish();e.finish();return c.build()}transform(a,b){if(this.isIdentity(a)||this.isIdentity(b))return Cp(b,a);const c=a.Ad(b.pre,0),d=b.Ad(a.pre,0),e=this.pe(),f=this.pe();for(var g=c.head,h=d.head;g||h;){if(g?.type===1)h=c.ND(g.type,g.length),f.append(Gp(h.length)),e.append(h);else if(h?.type===1){var k=d.ND(h.type,
h.length);f.append(k);e.append(Gp(h.length))}else if(g&&h)k=Math.min(g.length,h.length),g=c.ND(g.type,k),h=d.ND(h.type,k),f.append(h),e.append(g);else throw Error(`length mismatch (${a} x ${b})`);g=c.head;h=d.head}c.finish();d.finish();return Cp(f.build(),e.build())}xl(){return prb}wk(a,b){if(a===b)return!0;if(!a||!b||a.pre!==b.pre||a.post!==b.post)return!1;a=a.Ad();b=b.Ad();let c=a.head,d=b.head;for(;c||d;){if(!c||!d)return!1;switch(c.type){case 0:if(d.type!==0||c.length!==d.length)return!1;a.Yz(c.length);
b.Yz(d.length);break;case 1:if(d.type!==1||c.length!==d.length)return!1;Hp(a,c.length);Hp(b,d.length);break;default:throw new q(c);}c=a.head;d=b.head}return!0}identity(){return prb}apply(a){return a}Nl(a){return a}hg(){}Bj(a,b){return a===b}equals(a){return this===a||a instanceof srb}},Ymb=new Map;var trb,vrb,urb;
trb=class extends Xq{rf(){return new anb(this.jC)}O_(){return Np.empty}mf(a={}){return{x:a.x||this.axis.pe().build(),y:a.y||this.axis.pe().build(),attrs:a.attrs||Kp(this).build()}}isIdentity(a){return this.axis.isIdentity(a.x)&&this.axis.isIdentity(a.y)&&a.attrs.items.isEmpty()}compose(a,b){const c=this.axis.compose(a.x,b.x),d=this.axis.compose(a.y,b.y);a=enb(this,a.attrs,b.x,b.y);if(b.attrs.items.isEmpty())return this.mf({x:c,y:d,attrs:a});const e=Kp(this);cnb(a,b.attrs,e,(f,g,h)=>{g?h?(ia(this.jC(f,
g.n,h.o)),f={o:g.o,n:h.n}):f=g:f=h;return f});return{x:c,y:d,attrs:e.build()}}sOa(a,b,c,d){return this.axis.isIdentity(c)&&this.axis.isIdentity(d)||b.items.isEmpty()?b:dnb(a,this.jC,b,c,d)}transform(a,b){const c=Bp.Oq(),{Rt:d,uu:e}=Fp(c,this.axis.transform(a.x,b.x)),{Rt:f,uu:g}=Fp(c,this.axis.transform(a.y,b.y));a=enb(this,a.attrs,d,f);b=enb(this,b.attrs,e,g);if(a.items.isEmpty()||b.items.isEmpty()){var h=this.mf({x:d,y:f,attrs:b});a=this.mf({x:e,y:g,attrs:a});return c.build(h,a)}var k=Math.max(a.er,
b.er),m=Math.max(a.eC,b.eC);a=a.Ad(void 0,k,m);k=b.Ad(void 0,k,m);b=Kp(this);m=Kp(this);for(var n=a.head,p=k.head;n||p;){if(n&&n.type===0||p&&p.type===0){n=a.iy();p=k.iy();const z=b.iy(),B=m.iy();for(var t=n.head,v=p.head;t||v;){if(t&&t.type===0||v&&v.type===0){t=n.Dv();v=p.Dv();for(h of bnb(t,v)){t=h;v=n.attrs[h];var x=p.attrs[h];v&&x?(ia(this.jC(t,v.o,x.o)),t=Dp({o:x.n,n:v.n})):t=Cp(x,v);const {Rt:C,uu:D}=Fp(c,t);z.Vc(h,D);B.Vc(h,C)}}else if(t&&v)t=Math.min(t.length,v.length),n.fo(t),p.fo(t),z.GD(t),
B.GD(t);else if(t)t=t.length,n.fo(t),z.GD(t),B.GD(t);else if(v)t=v.length,p.fo(t),z.GD(t),B.GD(t);else throw Error();t=n.head;v=p.head}n.finish();p.finish();z.finish();B.finish()}else if(n&&p)n=Math.min(n.length,p.length),Lp(a,n),Lp(k,n),b.rows(n),m.rows(n);else if(n)n=n.length,Lp(a,n),b.rows(n),m.rows(n);else if(p)n=p.length,Lp(k,n),b.rows(n),m.rows(n);else throw Error();n=a.head;p=k.head}a.finish();k.finish();h=this.mf({x:d,y:f,attrs:m.build()});a=this.mf({x:e,y:g,attrs:b.build()});return c.build(h,
a)}xl(a){a=a.attrs.Ad();const b=Kp(this);for(var c=a.head;c;){if(c.type===0){c=a.iy();const e=b.iy();for(var d=c.head;d;){if(d.type===0){d=c.Dv();for(const f of Op(d))d=c.attrs[f],e.Vc(f,d&&{o:d.n,n:d.o})}else d=d.length,c.fo(d),e.GD(d);d=c.head}c.finish();e.finish()}else c=c.length,Lp(a,c),b.rows(c);c=a.head}return this.mf({attrs:b.build()})}wk(a,b){return this.axis.wk(a.x,b.x)&&this.axis.wk(a.y,b.y)&&a.attrs.equals(b.attrs)}identity(){return{x:this.axis.pe().build(),y:this.axis.pe().build(),attrs:Kp(this).build()}}apply(a,
b){const c=this.sOa("apply",a,b.x,b.y);if(b.attrs.items.isEmpty())return sq(this.qe,a,c);const d=this.rf();cnb(c,b.attrs,d,(e,f,g)=>this.Dbe(e,f,g));return sq(this.qe,a,d.build())}Nl(a,b){if(b.attrs.items.isEmpty())return sq(this.qe,a,this.sOa("unapply",a,b.x,b.y));const c=this.rf();cnb(a,b.attrs,c,(d,e,f)=>this.Jtf(d,e,f));return sq(this.qe,a,this.sOa("unapply",c.build(),b.x,b.y))}hg(a,b){if(a instanceof Np&&b==null)return a;a=a.Ad(b);const c=this.rf();for(var d=a.head;d;){if(d.type===0){d=a.iy();
const f=c.iy();for(var e=d.head;e;){if(e.type===0){e=d.Dv();for(const g of Op(e))(b==null||b(g))&&f.Vc(g,d.attrs[g])}else e=e.length,d.fo(e),f.GD(e);e=d.head}d.finish();f.finish()}else d=d.length,Lp(a,d),c.rows(d);d=a.head}return c.build()}Bj(a,b){return a.equals(b)}equals(a){return this===a?!0:a instanceof trb?this.jC===a.jC:!1}constructor(a,b,c){super(a);this.jC=b;this.axis=c;this.ePd=(d,e,f)=>{if(e===f)return!0;if(e&&f){const g=e.n,h=f.n;return this.jC(d,e.o,f.o)&&this.jC(d,g,h)}return!e&&!f};
this.Dbe=(d,e,f)=>f!=null?(ia(this.jC(d,e,f.o),"{}: {} != {}",d,e,f.o),f.n):e;this.Jtf=(d,e,f)=>f!=null?(ia(this.jC(d,e,f.n)),f.o):e}};
vrb=class{isEmpty(){return!this.items.length}Ad(a){return new urb(this.items,this.length,a)}forEach(a,{grad:b,Cd:c}){for(const d of this.items)switch(d.type){case 0:b&&b(d.value);break;case 1:c&&c(d.length);break;default:throw new q(d);}(a=Math.max(0,a-this.length))&&c&&c(a)}equals(a,b){if(this===a)return!0;if(this.length!==a.length)return!1;const c=this.Ad();a=a.Ad();for(var d=c.head,e=a.head;d||e;){if(!d||!e)return!1;switch(d.type){case 0:if(e.type!==0)return!1;d=c.Dv();e=a.Dv();if(d!=null?e==null||
!b(d,e):e!=null)return!1;break;case 1:if(e.type!==1||d.length!==e.length)return!1;c.fo(d.length);a.fo(e.length);break;default:throw new q(d);}d=c.head;e=a.head}return!0}toString(a="C",b="G",c=JSON.stringify){return this.items.map(d=>{switch(d.type){case 1:return`${a}${d.length}`;case 0:return`${b}${c(d.value)}`;default:throw new q(d);}}).join()}constructor(a,b){this.items=a;this.length=b}};__c.wrb=new vrb([],0);
urb=class{get head(){return this.xm}fo(a){var b=this.xm;if(!b||b.type!==1)throw Error(`expected cell, found: ${b&&b.type}`);b=b.length;a=Math.min(a,b);this.xm=a<b?fnb(b-a):this.input[this.i++];return a}Dv(){const a=this.xm;if(a&&a.type!==1)return this.xm=this.input[this.i++],a.value}finish(){ia(this.xm==null,"stream not empty: {}",this.xm)}constructor(a,b,c=0){this.i=0;c=Math.max(0,c-b);this.length=b+c;this.input=c?[...a,fnb(c)]:a;this.xm=this.input.length?this.input[this.i++]:void 0}};
Mp=__c.Mp=class{grad(a){if(a==null)return this;ia(this.Tua==null,"nextGrad already set: {}",this.Tua);this.Tua=a;return this}Cd(a){if(a<=0)return this;this.Tua!=null&&(this.Sua&&(this.items.push(fnb(this.Sua)),this.Sua=0),this.items.push({type:0,value:this.Tua}),this.Tua=void 0);this.Sua+=a;this.J7+=a;return this}build(){this.Tua!=null?(ia(this.Sua!==0),this.items.push(fnb(this.Sua)),this.items.push({type:0,value:this.Tua}),this.Sua=0,this.Tua=void 0):this.J7-=this.Sua;return new vrb(this.items,this.J7)}constructor(){this.items=
[];this.Sua=this.J7=0;this.Tua=void 0}};
Np=__c.Np=class{static of(a,b,c,d){return b.isEmpty()?Np.empty:new Np(a,b,c,d)}Ad(a=()=>!0,b=0,c=0){b=Math.max(this.er,b);c=Math.max(this.eC,c);const d=this.items.Ad(c);return new xrb(this.jC,d,a,b,c)}serialize(a){const b=a.iy;this.items.forEach(this.items.length,{Cd:a.rows,grad:c=>{const {GD:d,grad:e,Plb:f}=b();c.forEach(c.length,{Cd:d,grad:e});f()}})}equals(a){return this===a?!0:a instanceof Np&&this.eC===a.eC&&this.er===a.er?this.items.equals(a.items,(b,c)=>b.equals(c,(d,e)=>lnb(this.jC,d,e))):
!1}toString(){return this.items.toString("R","G",a=>a.toString("C","G",$mb))}constructor(a,b,c,d){this.jC=a;this.items=b;this.er=c;this.eC=d}};Np.empty=new Np((a,b,c)=>b===c,__c.wrb,0,0);
var xrb=class{get head(){return this.c1a.head}mgc(a){ia(this.wZ==null);const b=this.iy();var c=b.head;let d=0;for(;c;){if(c.type===0)b.Dv();else{c=b.fo(c.length);if(!Pp(b.attrs)){const e={...b.attrs};for(let f=0;f<c;f++)a(e,d+f)}d+=c}c=b.head}b.finish();return this.head?Lp(this,1):0}get q_e(){ia(this.head!=null);ia(this.wZ==null);return this.head.type===1&&this.MB.isEmpty()}iy(){ia(this.wZ==null);var a=this.c1a.Dv();if(a){a=a.Ad(this.er);for(var b=this.MB.Ad(this.er),c=new Mp,d=a.head,e=b.head;d||
e;){if(d&&d.type===0||e&&e.type===0){const g=a.Dv(),h=b.Dv();b:{d=this.aMa;e=this.gua;if(!g){d=h;break b}const k={...h};for(f in g){if(e&&!e(f))continue;const m=g[f];fa(hnb(d,f,h?.[f],m.t));m.b?k[f]=m.b:delete k[f]}d=Pp(k)?void 0:k}c.grad(d)}else if(d&&e)d=Math.min(d.length,e.length),a.fo(d),b.fo(d),c.Cd(d);else throw Error("length mismatch");d=a.head;e=b.head}var f=c.build()}else f=this.MB;this.wZ=f;return new yrb(this.aMa,this.gua,this.wZ.Ad(this.er),this.iDc)}finish(){ia(this.wZ==null);this.c1a.finish()}constructor(a,
b,c,d,e){this.aMa=a;this.c1a=b;this.gua=c;this.er=d;this.eC=e;this.MB=__c.wrb;this.wZ=void 0;this.iDc=()=>{ia(this.wZ!=null);this.MB=this.wZ;this.wZ=void 0}}},anb=class{iy(){ia(this.FAb==null);return this.FAb=new zrb(this.jC,this.Qje)}rows(a){this.Okc.Cd(a);return this}build(){ia(this.FAb==null);ia(this.MB.isEmpty(),"prevDxs not empty: {}",this.MB);const a=this.Okc.build();return Np.of(this.jC,a,this.er,a.length)}constructor(a){this.jC=a;this.Okc=new Mp;this.er=0;this.MB=__c.wrb;this.FAb=void 0;this.Qje=
b=>{ia(this.FAb!=null);this.er=Math.max(this.er,b.length);var c=this.MB.Ad(this.er);const d=b.Ad(this.er),e=new Mp;for(var f=c.head,g=d.head;f||g;){if(f&&f.type===0||g&&g.type===0)f=c.Dv(),g=d.Dv(),f=__c.knb(this.jC,f,g),e.grad(f);else if(f&&g)f=Math.min(f.length,g.length),c.fo(f),d.fo(f),e.Cd(f);else throw Error("length mismatch");f=c.head;g=d.head}c=e.build();c.isEmpty()||this.Okc.grad(c);this.MB=b;this.FAb=void 0}}},yrb=class{get attrs(){return this.nK}get head(){return this.YKb.head}fo(a){return this.YKb.fo(a)}Dv(){const a=
this.YKb.Dv();this.xqa(a);return a}finish(){this.YKb.finish();this.Bk()}xqa(a){if(a)for(const b in a){if(!this.gua(b))continue;const c=__c.inb(this.aMa,b,this.nK[b],a[b]);c==null?delete this.nK[b]:this.nK[b]=c}}constructor(a,b,c,d){this.aMa=a;this.gua=b;this.YKb=c;this.Bk=d;this.nK={}}},zrb=class{Vc(a,b){var c=this.aMa,d=this.nK[a];(b=c(a,d,b)?void 0:{Gg:d,r:b})?(this.CL||(this.CL={}),this.CL[a]=b):this.CL&&(delete this.CL[a],Pp(this.CL)&&(this.CL=void 0));return this}attrs(a){for(const b of Op(a))this.Vc(b,
a[b]);return this}GD(a){if(a<=0)return this;this.xqa();this.aBa.Cd(a);return this}xqa(){if(this.CL){var a=this.CL;this.CL=void 0;for(const b in a){const c=__c.inb(this.aMa,b,this.nK[b],a[b]);c==null?delete this.nK[b]:this.nK[b]=c}this.aBa.grad(a)}}finish(){this.xqa();ia(Pp(this.nK));const a=this.aBa.build();this.Bk(a)}constructor(a,b){this.aMa=a;this.Bk=b;this.nK={};this.CL=void 0;this.aBa=new Mp}};var Krb,Lrb,Grb,Prb,Hrb,Arb,Orb,Mrb,Nrb,Brb,Frb;
Krb=class extends Xq{pe(a){const b=new Arb;return a?new Brb(b,a):b}eH(a,b,c){a=new __c.Crb(a,b);return c?new __c.Drb(a,c):a}rf(a){const b=new __c.Erb;return a?new Frb(b,a):b}O_(){return Grb}id(){return Hrb}isIdentity(a){return a===Hrb||!a.ops.length}compose(a,b){if(!a.ops.length)return b;if(!b.ops.length)return a;const c=this.pe(),d=a.Ad(0,b.pre);a=b.Ad(a.post,0);b=d.next;for(var e=a.next;e;){if(e.type===1)b=e.length,e=a.Bja(b),e=vnb(d.CP,a.CP,{},e),c.insert(b,e);else if(b)if(b.type===1){b=Math.min(b.length,
e.length);e=d.Bja(b);var f=a.Yz(b);e=vnb(d.CP,a.CP,e,f);c.insert(b,e)}else b=Math.min(b.length,e.length),e=d.Yz(b),f=a.Yz(b),e=vnb(d.CP,a.CP,e,f),c.retain(b,e);else throw Error("length mismatch");b=d.next;e=a.next}d.finish();a.finish();return c.build()}transform(a,b){if(!a.ops.length||!b.ops.length)return Cp(b,a);var c=a.Ad(b.pre,0);const d=b.Ad(a.pre,0);var e=this.pe();const f=this.pe(),g=Bp.Oq();for(var h=c.next,k=d.next;h||k;){if(h&&h.type===1){h=h.length;k=c.Bja(h);k=wnb(c.CP,d.CP,k,{});const {Rt:m,
uu:n}=Fp(g,k);f.retain(h,m);e.insert(h,n)}else if(k&&k.type===1){h=k.length;k=d.Bja(h);k=wnb(c.CP,d.CP,{},k);const {Rt:m,uu:n}=Fp(g,k);f.insert(h,m);e.retain(h,n)}else if(h&&k){h=Math.min(h.length,k.length);k=c.Yz(h);const m=d.Yz(h);k=wnb(c.CP,d.CP,k,m);const {Rt:n,uu:p}=Fp(g,k);f.retain(h,n);e.retain(h,p)}else throw Error(`unreachable case: ${h} x ${k}`);h=c.next;k=d.next}c.finish();d.finish();c=f.build();e=e.build();Rn(c.post-c.pre,b.post-b.pre);Rn(e.post-e.pre,a.post-a.pre);return g.build(c,e)}xl(a){if(!a.ops.length)return a;
const b=this.pe();for(const c of a.ops)switch(c.type){case 0:b.retain(c.length,tnb(c.II));break;case 1:b.retain(c.length,tnb(c.II));break;default:throw new q(c);}return b.build()}wk(a,b){return a.equals(b)}identity(){return Hrb}apply(a,b){if(!b.ops.length)return a;const c=new Irb("apply",a,b.pre);b.forEach(c);return sq(this.qe,a,c.result())}Nl(a,b){if(!b.ops.length)return a;const c=new Irb("unapply",a,b.post);b.forEach(c);return sq(this.qe,a,c.result())}hg(a,b){if(a instanceof __c.Jrb&&b==null)return a;
const c=new __c.Erb;a.forEach(a.length,{grad:(d,e)=>{for(const f of Qp(d))(b==null||b(f))&&c.Vc(f,d[f],e[f])},Cd:d=>{c.Cd(d)}});return c.build()}Bj(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;a=a.Ad();b=b.Ad();let c=a.head,d=b.head;for(;c||d;){if(!c||!d)return!1;switch(c.type){case 1:if(d.type!==1||c.length!==d.length)return!1;a.fo(c.length);b.fo(d.length);break;case 0:if(d.type!==0||!nnb(c.hH,d.hH))return!1;a.Dv();b.Dv();break;default:throw new q(c);}c=a.head;d=b.head}return!0}equals(a){return this===
a||a instanceof Krb}};Lrb=onb({},{});
__c.Jrb=class{Ad(a){return new Mrb(this,a)}cursor(a,b){return new Nrb(this,a,b)}forEach(a,{grad:b,Cd:c}){for(const d of this.items)switch(d.type){case 0:b&&b(d.xF,d.hH);break;case 1:c&&c(d.length);break;default:throw new q(d);}(a=Math.max(0,a-this.length))&&c&&c(a)}map(a,{grad:b,Cd:c}){const d=this.items.map(e=>{switch(e.type){case 0:return b(e.xF,e.hH);case 1:return c(e.length);default:throw new q(e);}});(a=Math.max(0,a-this.length))&&d.push(c(a));return d}reduce({grad:a,Cd:b},c){return this.items.reduce((d,
e)=>{switch(e.type){case 0:return a?a(d,e.xF,e.hH):d;case 1:return b?b(d,e.length):d;default:throw new q(e);}},c)}slice(a,b){fa(0<=a&&a<=b,"invalid range: [{}, {})",a,b);var c=this.length;if(0===a&&b>=c)return this;if(a===b||a>=c)return Grb;const d=new __c.Erb;c=this.cursor(b);c.move(a);d.attrs(c.cS,c.dwa);c.move(b-a,{cells:(e,f,g,h)=>d.attrs(f,h).Cd(e)});return d.build()}toString(){return`${this.items.map(a=>{switch(a.type){case 0:const b=[];for(const [c,d]of Object.entries(a.hH))b.push(`${c}:${d!=
null?`<${d}|`:""}`);return`G{${b.join(",")}}`;case 1:return`R${a.length}`;default:throw new q(a);}}).join("")}`}constructor(a,b,c={}){this.items=a;this.length=b;this.attributes=c;a=a.length?a[a.length-1]:void 0;fa(!a||a.type!==1)}};__c.Jrb.prototype.rA=ba(112);Grb=new __c.Jrb([],0);
Prb=class{Ad(a,b){return new Orb(this,a,b)}forEach(a){for(const b of this.ops)switch(b.type){case 0:a.retain(b.length,b.II);break;case 1:a.insert(b.length,b.II);break;default:throw new q(b);}}map(a){return this.ops.map(b=>{switch(b.type){case 0:return a.retain(b.length,b.II);case 1:return a.insert(b.length,b.II);default:throw new q(b);}})}equals(a){if(this===a)return!0;if(this.pre!==a.pre||this.post!==a.post||this.ops.length!==a.ops.length)return!1;for(let b=0;b<this.ops.length;b++){const c=this.ops[b],
d=a.ops[b];if(c!==d)switch(c.type){case 0:case 1:if(c.type!==d.type||c.length!==d.length||!unb(c.II,d.II))return!1;break;default:throw new q(c);}}return!0}toString(){return`[${this.ops.map(a=>{let b;switch(a.type){case 0:b="R";break;case 1:b="I";break;default:throw new q(a);}const c=[];__c.snb(a.II,({r:e},f)=>{e?c.push(`+"${f.toString()}":${e.SP!=null?`"${e.SP}"`:"null"}=>${e.IN!=null?`"${e.IN}"`:"null"}`):c.push(`-"${f.toString()}"`)});const d=c.length?`{${c.join(",")}}`:"";return`${b}${a.length}${d}`}).toString()}]`}constructor(a,
b,c){this.ops=a;this.pre=b;this.post=c}};Hrb=new Prb([],0,0);
Arb=class{append(a,b){fa(b>=0,"{} < 0",b);if(!b)return this;var c=this.V3b;this.op&&this.op.type===a&&!Qp(c).length?this.op={...this.op,length:this.op.length+b}:(this.op!=null&&this.ops.push(this.op),this.op={type:a,length:b,II:c},this.V3b={});for(const [d,e]of Object.entries(c))(c=e&&e.r)?this.open[d]=c:delete this.open[d];switch(a){case 0:this.pre+=b;this.post+=b;break;case 1:this.post+=b;break;default:throw new q(a);}return this}Lp(a,b){if(a==null)return this;if(typeof a==="object")for(const [c,
d]of Object.entries(a))this.Lp(c,d&&d.r);else qnb(this.open[a],b)?delete this.V3b[a]:this.V3b[a]={r:b};return this}retain(a,b,c){this.Lp(b,c);return this.append(0,a)}insert(a,b,c){this.Lp(b,c);return this.append(1,a)}build(){const a=this.op;a!=null&&(!Object.keys(this.open).length&&a.type===0&&[...Object.values(a.II)].every(b=>!b||!b.r)?(this.pre-=a.length,this.post-=a.length):this.ops.push(a),this.op=void 0);return new Prb(this.ops,this.pre,this.post)}constructor(){this.ops=[];this.open={};this.V3b=
{};this.post=this.pre=0}};
Orb=class{get CP(){return this.JEb}get next(){return this._next}wn(a,b){const c=l(this._next);ia(c.type===a,"{} != {}",c.type,a);fa(0<b&&b<=c.length,"{} \u2209 ({}, {}]",b,0,c.length);for(const [d,e]of Object.entries(c.II)){const f=e&&e.r;f?this.JEb[d]=f:delete this.JEb[d]}b<c.length?this._next={type:a,length:c.length-b,II:{}}:(this._next=this.i<this.input.length?this.input[this.i++]:void 0,!this._next&&this.fbb&&(this._next=xnb(this.fbb,Sn(this.JEb,()=>({r:void 0}))),this.fbb=0));return c.II}Yz(a){return this.wn(0,
a)}Bja(a){return this.wn(1,a)}finish(){ia(!this._next)}constructor(a,b=0,c=0){this.i=0;this.JEb={};this.input=a.ops;this._next=this.i<this.input.length?this.input[this.i++]:void 0;this.fbb=Math.max(0,b-a.pre,c-a.post);!this._next&&this.fbb&&(this._next=xnb(this.fbb),this.fbb=0)}};
__c.Crb=class{retain(a){this.right.move(a);return this}insert(a){const b=ynb(this,{},{},this.right.cS,this.right.dwa);this.Rba.insert(a,b);return this}open(a,b,c){this.PAb.delete(a);a in this.Feb&&this.Feb[a]===c||(this.SAb[a]=b,this.Y3b[a]=c);return this}close(a){delete this.SAb[a];delete this.Y3b[a];a in this.Eeb&&this.PAb.add(a);return this}Tfa(a,b){Rp(a,b,(c,d,e)=>this.open(c,d,e))}DT(a){for(const b of Qp(a))this.close(b);return this}build(){return this.Rba.build()}constructor(a,b){this.Rba=new Arb;
this.Eeb={};this.Feb={};this.PAb=new Set;this.SAb={};this.Y3b={};this.right=a.cursor(b,{cells:(c,d,e,f,g)=>this.Rba.retain(c,ynb(this,d,f,e,g))})}};__c.Crb.prototype.Efb=ba(114);
Mrb=class{get head(){return this.xm}get cS(){return this.nK}get dwa(){return this.X$b}fo(a){var b=this.xm;if(!b||b.type!==1)throw Error(`expected cell, found: ${b&&b.type}`);b=b.length;a=Math.min(a,b);this.xm=a<b?pnb(b-a):this.input[this.i++];return a}apply(a){Rp(a.xF,a.hH,(b,c,d)=>{c!=null&&d!=null?(this.nK[b]=c,this.X$b[b]=d):(delete this.nK[b],delete this.X$b[b])})}Dv(){const a=this.xm;if(!a||a.type===1)return Lrb;this.xm=this.input[this.i++];this.apply(a);return a}finish(){ia(!this.xm)}constructor(a,
b=0){this.i=0;this.nK={};this.X$b={};b=Math.max(0,b-a.length);this.length=a.length+b;this.input=b?[...a.items,pnb(b)]:a.items;this.xm=this.input.length?this.input[this.i++]:void 0}};
Nrb=class{get mS(){return this.Ad.length-this.Hia}get cS(){return this.Ad.cS}get dwa(){return this.Ad.dwa}move(a,b){var c=this.Trb;b=c?b?{cells:Jp(c.cells,b.cells)}:c:b;fa(a>=0,"{} < 0",a);a=this.Hia+a;for(fa(a<=this.Ad.length,"{} > {}",a,this.Ad.length);this.Hia<a;){c=this.Ad.Dv();const d=this.Ad.fo(a-this.Hia);this.Hia+=d;b&&b.cells&&b.cells(d,c.xF,this.cS,c.hH,this.dwa)}}finish(){this.Ad.Dv();this.Ad.finish()}constructor(a,b,c){this.Trb=c;this.Hia=0;this.Ad=new Mrb(a,b)}};
__c.Erb=class{Vc(a,b,c){this.woa[a]!==c?(this.xF[a]=b,this.hH[a]=c):(delete this.xF[a],delete this.hH[a]);return this}attrs(a,b){Rp(a,b,(c,d,e)=>this.Vc(c,d,e));return this}Cd(a){a>0&&(Object.keys(this.xF).length&&(this.length&&(this.items.push(pnb(this.length)),this.length=0),this.items.push(onb(this.xF,this.hH)),Rp(this.xF,this.hH,(b,c,d)=>{c!=null?(this.as[b]=c,this.woa[b]=d,(this.attributes[b]??(this.attributes[b]=new Set)).add(c)):(delete this.as[b],delete this.woa[b])}),this.xF={},this.hH={}),
this.length+=a,this.J7+=a);return this}append(a,b=0){a.forEach(b,{grad:(c,d)=>this.attrs(c,d),Cd:c=>this.Cd(c)});return this}build(){for(const a of Qp(this.as))this.Vc(a,void 0,void 0);for(const a of Qp(this.xF))this.Vc(a,void 0,void 0);Object.keys(this.xF).length?(ia(!!this.length,"attributes still open: {}",this.xF),this.items.push(pnb(this.length)),this.items.push(onb(this.xF,this.hH)),this.length=0,this.xF={},this.hH={}):this.J7-=this.length;return new __c.Jrb(this.items,this.J7,this.attributes)}constructor(){this.items=
[];this.attributes={};this.as={};this.woa={};this.length=this.J7=0;this.xF={};this.hH={}}};
Brb=class{retain(a,b,c){if(b==null)return this.Oq.retain(a),this;typeof b==="object"?this.Oq.retain(a,Anb(this,b)):this.Oq.retain(a,b,znb(this,b,c));return this}insert(a,b,c){if(b==null)return this.Oq.insert(a),this;typeof b==="object"?this.Oq.insert(a,Anb(this,b)):this.Oq.insert(a,b,znb(this,b,c));return this}Lp(a,b){if(a==null)return this;typeof a==="object"?this.Oq.Lp(Anb(this,a)):this.Oq.Lp(a,znb(this,a,b));return this}build(){return this.Oq.build()}constructor(a,b){this.Oq=a;this.Y1a=b}};
Frb=class{encode(a,b){return b!=null?this.Y1a.encode(a,b):void 0}Vc(a,b){this.Oq.Vc(a,b,this.encode(a,b));return this}attrs(a){this.Oq.attrs(a,Sn(a,(b,c)=>this.encode(c,b)));return this}Cd(a){this.Oq.Cd(a);return this}append(a,b){this.Oq.append(a,b);return this}build(){return this.Oq.build()}constructor(a,b){this.Oq=a;this.Y1a=b}};
__c.Drb=class{encode(a,b){return b!=null?this.Y1a.encode(a,b):void 0}retain(a){this.generator.retain(a);return this}insert(a){this.generator.insert(a);return this}open(a,b,c){this.generator.open(a,b,c!=null?c:this.encode(a,b));return this}close(a){this.generator.close(a);return this}Tfa(a){this.generator.Tfa(a,Sn(a,(b,c)=>this.encode(c,b)))}DT(a){this.generator.DT(a);return this}build(){return this.generator.build()}constructor(a,b){this.generator=a;this.Y1a=b}};__c.Drb.prototype.Efb=ba(113);
var Irb=class{retain(a,b){fa(a>0);this.p8a=b;this.Ad.move(a);if(this.p8a)throw Error("ddas not consumed");return this}insert(a,b){fa(a>0);this.p8a=b;this.mode==="apply"?(Bnb(this,this.Ad.cS,this.Ad.dwa),this.Rba.Cd(a)):(this.ORc=!0,this.Ad.move(a),this.ORc=!1);if(this.p8a)throw Error("ddas not consumed");return this}result(){for(const a of this.open)this.Rba.Vc(a,this.Ad.cS[a],this.Ad.dwa[a]);this.open.clear();this.Ad.move(this.Ad.mS);this.Ad.finish();return this.Rba.build()}constructor(a,b,c){this.mode=
a;this.Rba=new __c.Erb;this.open=new Set;this.p8a=void 0;this.ORc=!1;this.Ad=b.cursor(c,{cells:(d,e,f,g,h)=>{const k=Bnb(this,f,h);Rp(e,g,(m,n,p)=>{this.open.has(m)?fa(!!k?.has(m),"unexpected gradient: {}: {}",m,p):this.Rba.Vc(m,n,p)});this.ORc||this.Rba.Cd(d)}})}};var zpb=class{toString(){return`U(${this.delta})`}constructor(a){this.delta=a;this.type=0}},Qrb=class{toString(){return`R(${this.oldState}, ${this.newState})`}constructor(a,b){this.oldState=a;this.newState=b;this.type=1}},Rrb=class extends Wq{update(a){return this.component.isIdentity(a)?void 0:new zpb(a)}replace(a,b){return new Qrb(a,b)}isIdentity(a){return a==null||a.type===0&&this.component.isIdentity(a.delta)}constructor(a){super();this.component=a}};var Srb=class extends Xq{update(a){return this.base.update(a)}replace(a,b){return this.base.replace(a,b)}isIdentity(a){return this.base.isIdentity(a)}compose(a,b){if(a==null)return b;if(b==null)return a;switch(a.type){case 0:switch(b.type){case 0:return this.update(this.component.compose(a.delta,b.delta));case 1:return this.replace(this.component.Nl(b.oldState,a.delta),b.newState);default:throw new q(b);}case 1:switch(b.type){case 0:return this.replace(a.oldState,this.component.apply(a.newState,b.delta));
case 1:return Ap(this.component,a.newState,b.oldState),this.replace(a.oldState,b.newState);default:throw new q(b);}default:throw new q(a);}}transform(a,b){if(a==null||b==null)return Cp(b,a);switch(a.type){case 0:switch(b.type){case 0:return Umb(this.component.transform(a.delta,b.delta),c=>this.update(c));case 1:return a=this.component.apply(b.oldState,a.delta),new Bp(this.replace(a,b.newState),void 0,!1,!0);default:throw new q(b);}case 1:switch(b.type){case 0:return b=this.component.apply(a.oldState,
b.delta),Dp(this.replace(b,a.newState));case 1:return Ap(this.component,a.oldState,b.oldState),Dp(this.replace(b.newState,a.newState));default:throw new q(b);}default:throw new q(a);}}xl(a){if(a==null)return a;switch(a.type){case 0:return this.update(this.component.xl(a.delta));case 1:return this.replace(a.newState,a.oldState);default:throw new q(a);}}wk(a,b){return a===b?!0:a==null||b==null?a===b:a.type===0&&b.type===0?this.component.wk(a.delta,b.delta):a.type===1&&b.type===1?this.component.Bj(a.oldState,
b.oldState)&&this.component.Bj(a.newState,b.newState):!1}identity(){}apply(a,b){if(b==null)return a;switch(b.type){case 0:return sq(this.qe,a,this.component.apply(a,b.delta));case 1:return Ap(this.component,a,b.oldState),b.newState;default:throw new q(b);}}Nl(a,b){if(b==null)return a;switch(b.type){case 0:return sq(this.qe,a,this.component.Nl(a,b.delta));case 1:return Ap(this.component,a,b.newState),b.oldState;default:throw new q(b);}}hg(a){return this.component.hg(a)}Bj(a,b){return this.component.Bj(a,
b)}equals(a){return this===a||a instanceof Srb&&this.component.equals(a.component)}constructor(a,b,c){super(a);this.component=b;this.base=c}};var Urb=class{get er(){return this.grid.er}get eC(){return this.grid.eC}get rows(){return this.grid.rows}forEach(a){this.grid.forEach((b,c,d)=>{a(d.state,Sp(b,c,d.right,d.bottom))})}map(a){const b=new Trb;this.forEach((c,d)=>{b.add(d,a(c,d))});return b.build()}get(a,b){var c=this.grid.rows[b];if(c!=null&&(c=c.cells[a],c!=null))return{span:Sp(a,b,c.right,c.bottom),state:c.state}}values(){const a=[];this.forEach((b,c)=>{a.push({span:c,state:b})});return a}Ad(){return this.grid.Ad()}constructor(a){this.grid=
a}},Trb=class{add(a,b){Mnb(this.xje,a);this.TGd.add(a.left,a.top,a.right,a.bottom,{right:a.right,bottom:a.bottom,state:b});return this}build(){const a=this.TGd.build();return a.isEmpty?Vrb:new Urb(a)}constructor(){this.TGd=new Wrb;this.xje=new Xrb}},Yrb=class{constructor(a,b){this.type=0;this.o=a&&{right:a.right,bottom:a.bottom,state:a.state};this.n=b&&{right:b.right,bottom:b.bottom,state:b.state}}},Zrb=class{constructor(a,b){this.bounds=a;this.delta=b;this.type=1}},Up=class{add(a,b,c){if(c==null)return this;
switch(c.type){case 1:return this.addUpdate(a,b,c);case 0:let e=a,f=b;if(c.o){var d=Sp(a,b,c.o.right,c.o.bottom);Mnb(this.Axd,d);e=Math.max(e,c.o.right);f=Math.max(f,c.o.bottom)}c.n&&(d=Sp(a,b,c.n.right,c.n.bottom),Mnb(this.Bwd,d),e=Math.max(e,c.n.right),f=Math.max(f,c.n.bottom));this.C3a.add(a,b,e,f,c);return this;default:throw new q(c);}}addUpdate(a,b,c){let d=a,e=b;if(c.bounds?.o){var f=Sp(a,b,c.bounds.o.right,c.bounds.o.bottom);Mnb(this.Axd,f);d=Math.max(d,c.bounds.o.right);e=Math.max(e,c.bounds.o.bottom)}c.bounds?.n&&
(f=Sp(a,b,c.bounds.n.right,c.bounds.n.bottom),Mnb(this.Bwd,f),d=Math.max(d,c.bounds.n.right),e=Math.max(e,c.bounds.n.bottom));this.C3a.add(a,b,d,e,c);return this}build(){return this.C3a.build()}constructor(){this.C3a=new Wrb;this.Axd=new Xrb;this.Bwd=new Xrb}},asb=class{get isEmpty(){return this.rows.length===0}forEach(a){this.rows.forEach(({cells:b},c)=>{b.forEach((d,e)=>{a(e,c,d)})})}values(){const a=[];this.forEach((b,c,d)=>a.push([b,c,d]));return a}Ad(){return new $rb(this.rows)}constructor(a,
b,c){this.rows=a;this.er=b;this.eC=c}},$rb=class{get head(){const a=this.rows[this.y];return a?.cells[this.x]&&{x:this.x,y:this.y,value:a.cells[this.x]}}wn(){const a=l(this.head),b=l(this.rows[this.y]);this.x++;Cnb(this);b.cells[this.x]==null&&(this.y++,this.x=0,Dnb(this),Cnb(this));return a}finish(){ia(this.head==null)}constructor(a){this.rows=a;this.x=this.y=0;Dnb(this);Cnb(this)}},Wrb=class{add(a,b,c,d,e){fa(a<=c);fa(b<=d);this.qaa==null||this.qaa.y<b?(this.flush(),this.rows.length&&ia(this.rows.length<=
b),this.qaa={y:b,maxY:d,cells:[]},this.qaa.cells[a]=e):this.qaa.y===b?(ia(this.qaa.cells.length<=a),this.qaa.maxY=Math.max(this.qaa.maxY,d),this.qaa.cells[a]=e):ia(this.qaa.y>b);this.er=Math.max(this.er,c+1);this.eC=Math.max(this.eC,d+1);return this}flush(){if(this.qaa){const {y:a,...b}=this.qaa;this.rows[a]=b;this.qaa=void 0}}build(){this.flush();return new asb(this.rows,this.er,this.eC)}constructor(){this.rows=[];this.eC=this.er=0}},Vrb=new Urb(new asb([],0,0)),bsb=class extends Xq{rf(){return new Trb}O_(){return Vrb}replace(a,
b){return new Yrb(a,b)}update(a,b){a=a==null||Tp(a.o,a.n)?void 0:a;b=b==null||this.component.isIdentity(b)?void 0:b;return a!=null||b!=null?new Zrb(a,b):void 0}mf(a={}){const b=a.cells||(new Up).build();return{x:a.x||this.axis.pe().build(),y:a.y||this.axis.pe().build(),cells:b,kB:a.kB||this.kB.project(b)}}isIdentity(a){return this.axis.isIdentity(a.x)&&this.axis.isIdentity(a.y)&&a.cells.isEmpty&&this.kB.isIdentity(a.kB)}compose(a,b){const c=Enb(this,a.cells,b.x,b.y),d=this.kB.expand(a.kB,b.x,b.y);
return{x:this.axis.compose(a.x,b.x),y:this.axis.compose(a.y,b.y),cells:Hnb(this,c,b.cells),kB:this.kB.compose(d,b.kB)}}transform(a,b){const c=Bp.Oq(),{Rt:d,uu:e}=Fp(c,this.axis.transform(a.x,b.x)),{Rt:f,uu:g}=Fp(c,this.axis.transform(a.y,b.y)),h=Enb(this,a.cells,d,f),k=Enb(this,b.cells,e,g);a=this.kB.expand(a.kB,d,f);b=this.kB.expand(b.kB,e,g);const {Rt:m,uu:n}=Fp(c,this.kB.transform(a,b)),p=new Xrb,t=this.kB.cursor(a,Math.max(h.er,k.er),Math.max(h.eC,k.eC)),v=new Up,x=new Up;Fnb(h.Ad(),k.Ad(),(z,
B,C,D)=>{if(C!=null||D!=null){a:if(C==null||D==null)var F=Cp(D,C);else switch(C.type){case 1:b:{switch(D.type){case 1:F=Bp.Oq();const {Rt:M,uu:Q}=C.delta&&D.delta?Fp(F,this.component.transform(C.delta,D.delta)):Cp(D.delta,C.delta);if(C.bounds&&D.bounds){C=C.bounds;D=D.bounds;ia(Tp(C.o,D.o));const Y={right:Math.min(C.n.right,D.n.right),bottom:Math.min(C.n.bottom,D.n.bottom)},V=Bp.Oq();Vmb(V,!Tp(D.n,Y));Wmb(V,!Tp(C.n,Y));C=V.build({o:D.n,n:Y},{o:C.n,n:Y});C=Fp(F,C)}else C=Cp(D.bounds,C.bounds);const {Rt:S,
uu:U}=C;F=F.build(this.update(S,M),this.update(U,Q));break b;case 0:ia(D.o!=null);C.bounds&&ia(Tp(C.bounds.o,D.o));F=new Bp(this.replace({...(C.bounds?C.bounds.n:D.o),state:C.delta?this.component.apply(D.o.state,C.delta):D.o.state},D.n),void 0,!1,!0);break b;default:throw new q(D);}F=void 0}break a;case 0:b:switch(D.type){case 1:ia(C.o!=null);D.bounds&&ia(Tp(C.o,D.bounds.o));F=Dp(this.replace({...(D.bounds?D.bounds.n:C.o),state:D.delta?this.component.apply(C.o.state,D.delta):C.o.state},C.n));break b;
case 0:ia(Vp(this,C.o,D.o));F=Dp(this.replace(D.n,C.n));break b;default:throw new q(D);}break a;default:throw new q(C);}var {Rt:I,uu:K}=Fp(c,F);I&&(F=Knb(this,z,B,I,p,t))&&(I=Gnb(this,I,F),K=Gnb(this,K,F),Vmb(c));I&&x.add(z,B,I);K&&v.add(z,B,K)}});t.finish();return c.build({x:d,y:f,cells:x.build(),kB:m},{x:e,y:g,cells:v.build(),kB:n})}xl(a){const b=new Up;a.cells.forEach((d,e,f)=>{if(f!=null)switch(f.type){case 1:f=this.update(f.bounds&&{o:f.bounds.n,n:f.bounds.o},f.delta&&this.component.xl(f.delta));
b.add(d,e,f);break;case 0:b.add(d,e,this.replace(f.n,f.o));break;default:throw new q(f);}});const c=b.build();return{x:this.axis.xl(a.x),y:this.axis.xl(a.y),cells:c,kB:this.kB.project(c)}}wk(a,b){var c;if(c=this.axis.wk(a.x,b.x)&&this.axis.wk(a.y,b.y))a:{c=a.cells;var d=b.cells;if(c.er!==d.er||c.eC!==d.eC)c=!1;else{c=c.Ad();d=d.Ad();for(var e=c.head,f=d.head;e||f;){var g;(g=e==null)||(g=f==null)||(g=e.x!==f.x||e.y!==f.y)||(e=e.value,f=f.value,g=!(e===f||(e==null||f==null?e===f:e.type===0&&f.type===
0?Vp(this,e.o,f.o)&&Vp(this,e.n,f.n):e.type===1&&f.type===1&&(e.bounds&&f.bounds?Tp(e.bounds.o,f.bounds.o)&&Tp(e.bounds.n,f.bounds.n):e.bounds===f.bounds)&&(e.delta&&f.delta?this.component.wk(e.delta,f.delta):e.delta===f.delta))));if(g){c=!1;break a}c.wn();d.wn();e=c.head;f=d.head}c=!0}}return c&&this.kB.wk(a.kB,b.kB)}identity(){return this.mf()}apply(a,b){const c=this.sOa(a,b.x,b.y),d=this.rf();Fnb(c.Ad(),b.cells.Ad(),(e,f,g,h)=>{if(g!=null||h!=null)if(h==null)ia(g!=null),d.add(Sp(e,f,g.right,g.bottom),
g.state);else switch(h.type){case 1:ia(g!=null);h.bounds&&ia(Tp(h.bounds.o,g));d.add({...(h.bounds?h.bounds.n:g),left:e,top:f},h.delta?this.component.apply(g.state,h.delta):g.state);break;case 0:h.o&&(ia(g!=null),ia(Vp(this,g,h.o)));h.n&&d.add({left:e,top:f,right:h.n.right,bottom:h.n.bottom},h.n.state);break;default:throw new q(h);}});return sq(this.qe,a,d.build())}sOa(a,b,c){if(this.axis.isIdentity(b)&&this.axis.isIdentity(c))return a;const d=new Set,e=new Set;a.forEach((k,m)=>{d.add(m.left);d.add(m.right);
e.add(m.top);e.add(m.bottom)});const f=Ip(b,d),g=Ip(c,e),h=new Trb;a.forEach((k,m)=>{m={left:l(f.get(m.left)),right:l(f.get(m.right)),top:l(g.get(m.top)),bottom:l(g.get(m.bottom))};h.add(m,k)});return h.build()}Nl(a,b){const c=this.rf();Fnb(a.Ad(),b.cells.Ad(),(d,e,f,g)=>{if(f!=null||g!=null)if(g==null)ia(f!=null),c.add(Sp(d,e,f.right,f.bottom),f.state);else switch(g.type){case 1:ia(f!=null);g.bounds&&ia(Tp(g.bounds.n,f));c.add({...(g.bounds?g.bounds.o:f),left:d,top:e},g.delta?this.component.Nl(f.state,
g.delta):f.state);break;case 0:g.n&&(ia(f!=null),ia(Vp(this,f,g.n)));g.o&&c.add({left:d,top:e,right:g.o.right,bottom:g.o.bottom},g.o.state);break;default:throw new q(g);}});return sq(this.qe,a,this.V4b(c.build(),b.x,b.y))}V4b(a,b,c){if(this.axis.isIdentity(b)&&this.axis.isIdentity(c))return a;const d=new Set,e=new Set;a.forEach((k,m)=>{d.add(m.left);d.add(m.right);e.add(m.top);e.add(m.bottom)});const f=Zmb(b,d),g=Zmb(c,e),h=new Trb;a.forEach((k,m)=>{m={left:l(f.get(m.left)),right:l(f.get(m.right)),
top:l(g.get(m.top)),bottom:l(g.get(m.bottom))};h.add(m,k)});return h.build()}hg(a){return a.map(b=>this.component.hg(b))}Bj(a,b){if(a===b)return!0;a=a.Ad();b=b.Ad();let c=a.head,d=b.head;for(;c||d;){if(c==null||d==null||c.x!==d.x||c.y!==d.y||c.value.bottom!==d.value.bottom||c.value.right!==d.value.right||!this.component.Bj(c.value.state,d.value.state))return!1;a.wn();b.wn();c=a.head;d=b.head}return!0}equals(a){return this===a||a instanceof bsb&&this.component.equals(a.component)}constructor(a,b,c,
d){super(a);this.component=b;this.kB=c;this.axis=d}},Xrb=class{append(a){for(let b=a.top;b<=a.bottom;b++)for(let c=a.left;c<=a.right;c++){ia(!this.readBuffer(c,b));const {RUd:d,VUd:e}=Nnb(this,c,b);this.buffer[e]||(this.buffer[e]=[]);this.buffer[e][d]=!0}}readBuffer(a,b){const {RUd:c,VUd:d}=Nnb(this,a,b);return this.buffer[d]&&this.buffer[d][c]}constructor(){this.buffer=[];this.Kya=this.nia=0}},csb=class extends Xq{isIdentity(a){return a.items.isEmpty()}compose(a,b){if(this.isIdentity(a))return b;
if(this.isIdentity(b))return a;const c=this.Ifb.rf();cnb(a,b,c,(d,e,f)=>e||f);return c.build()}transform(a,b){return Cp(b,a)}xl(a){return a}wk(a,b){return a.equals(b)}identity(){return this.id}apply(a){return a}Nl(a){return a}hg(){}Bj(a,b){return a===b}equals(a){return this===a||a instanceof csb}pe(){return new dsb(()=>this.Ifb.rf(),a=>Tmb(this,a))}cursor(a,b,c){return new esb(a,b,c)}project(a){const b=this.pe();a.forEach((c,d,e)=>{switch(e.type){case 1:e.bounds&&b.add(Sp(c,d,e.bounds.n.right,e.bounds.n.bottom));
break;case 0:e.n&&b.add(Sp(c,d,e.n.right,e.n.bottom));break;default:throw new q(e);}});return b.build()}expand(a,b,c){b=this.Ifb.mf({x:Onb(this,b),y:Onb(this,c)});return this.Ifb.apply(a,b)}constructor(a,b,c){super(a);this.Ifb=b;this.axis=c;this.id=this.Ifb.rf().build()}},dsb=class{add(a){const b=this.C3a(),c=a.left*2,d=a.top*2,e=a.right*2;a=a.bottom*2;b.rows(d);b.iy().GD(c).attrs({value:!0}).GD(e-c+1).attrs({value:void 0}).finish();b.rows(a-d+1);b.iy().GD(c).attrs({value:void 0}).GD(e-c+1).attrs({value:void 0}).finish();
this.dka.push(b.build());return this}build(){return this.dka.length?this.reduce(this.dka):this.C3a().build()}constructor(a,b){this.C3a=a;this.reduce=b;this.dka=[]}},esb=class{get YUd(){ia(this.Zpa%2===0);return this.Zpa/2}iy(){ia(this.WJa===0);this.pV=this.Ad.iy();return this}get value(){ia(this.pV!=null);return this.pV.attrs.value}mgc(a){ia(this.pV!=null);for(var b=this.pV.head;b!=null;){if(b.type===0)this.pV.Dv();else if(b=this.pV.fo(b.length),this.Zpa%2===0&&this.pV.attrs.value)for(let c=0;c<b;c++)this.WJa%
2===0&&a(this.WJa/2,this.Zpa/2),this.WJa++;else this.WJa+=b;b=this.pV.head}return this}Plb(){for(ia(this.pV!=null);this.pV.head;)this.pV.head.type===0?this.pV.Dv():this.pV.fo(this.pV.head.length);this.pV.finish();this.pV=void 0;this.WJa=0;return this}finish(){Inb(this,this.Ad.eC);this.Ad.head&&(this.iy(),this.Plb());this.Ad.finish()}constructor(a,b,c){this.WJa=this.Zpa=0;this.Ad=a.Ad(void 0,b*2,c*2)}};var fsb=class extends Xq{increment(a){return a}isIdentity(a){return a===0}compose(a,b){return a+b}transform(a,b){return Cp(b,a)}wk(a,b){return a===b}identity(){return 0}apply(a,b){return a+b}Nl(a,b){return a-b}hg(a){return a}Bj(a,b){return a===b}},gsb=class extends fsb{xl(a){return 0-a}equals(a){return this===a||a instanceof gsb}},hsb=class extends fsb{increment(a){fa(a>=0);return super.increment(a)}compose(a,b){fa(a>=0);fa(b>=0);return super.compose(a,b)}transform(a,b){fa(a>=0);fa(b>=0);return super.transform(a,
b)}xl(a){fa(a>=0);return 0}apply(a,b){fa(b>=0);return super.apply(a,b)}Nl(a,b){fa(b>=0);return super.Nl(a,b)}equals(a){return this===a||a instanceof hsb}};var isb=new Map,jsb=class extends Xq{isIdentity(a){return!a.size||Array.from(a.values()).every(b=>b===0)}compose(a,b){return Qnb(a,b)}transform(a,b){return Cp(b,a)}xl(a){return a.size?gh(a,b=>-b):a}wk(a,b){return Pnb(a,b)}identity(){return isb}apply(a,b){return sq(this.qe,a,Qnb(a,b))}Nl(a,b){return sq(this.qe,a,Qnb(a,this.xl(b)))}hg(a){return new Map(a)}Bj(a,b){return Pnb(a,b)}equals(a){return this===a||a instanceof jsb}};var Rnb=new Map,ksb=class extends Xq{create(a,b){return Snb(this,a,this.component.replace(void 0,b))}update(a,b){return Snb(this,a,this.component.update(b))}replace(a,b,c){return Snb(this,a,this.component.replace(b,c))}delete(a,b){return Snb(this,a,this.component.replace(b,void 0))}identity(){return Rnb}isIdentity(a){return!a.size||Array.from(a.values()).every(b=>this.component.isIdentity(b))}xl(a){if(!a.size)return a;const b=new Map;for(const [c,d]of a)a=this.component.xl(d),a!=null&&b.set(c,a);
return b}compose(a,b){if(!a.size)return b;if(!b.size)return a;const c=new Map;for(const d of Tnb(a,b)){const e=this.component.compose(a.get(d),b.get(d));e!=null&&c.set(d,e)}return c}transform(a,b){if(!a.size||!b.size)return Cp(b,a);const c=new Map,d=new Map,e=Bp.Oq();for(const f of Tnb(a,b)){const g=Fp(e,this.component.transform(a.get(f),b.get(f)));g.uu!=null&&c.set(f,g.uu);g.Rt!=null&&d.set(f,g.Rt)}return e.build(d,c)}apply(a,b){if(!b.size)return a;const c=new Map(a);b.forEach((d,e)=>{d=this.component.apply(a.get(e),
d);d!=null?c.set(e,d):c.delete(e)});return sq(this.qe,a,c)}Nl(a,b){if(!b.size)return a;const c=new Map(a);b.forEach((d,e)=>{d=this.component.Nl(a.get(e),d);d!=null?c.set(e,d):c.delete(e)});return sq(this.qe,a,c)}hg(a){const b=new Map;for(const [c,d]of a)a=this.component.hg(d),a!=null&&b.set(c,a);return b}Bj(a,b){return a===b||a.size===b.size&&Array.from(Tnb(a,b)).every(c=>{const d=a.get(c);c=b.get(c);return d!=null&&c!=null&&this.component.Bj(d,c)})}wk(a,b){return a===b||a.size===b.size&&Array.from(Tnb(a,
b)).every(c=>{const d=a.get(c);c=b.get(c);return d!=null&&c!=null&&this.component.wk(d,c)})}equals(a){return this===a||a instanceof ksb&&this.component.equals(a)}constructor(a,b){super(a);this.component=b}};var lsb=class extends Wq{isIdentity(a){return a==null||this.component.isIdentity(a)}constructor(a){super();this.component=a;fa(!(a instanceof lsb))}};var Unb={type:0,length:1},Vnb={type:1,length:1},Xnb={type:2,length:1},bob=class{toString(){return this.ops.map(aob).join("")}constructor(a,b,c,d){this.ops=a;this.pre=b;this.post=c;this.wUa=d}},msb=new bob([],0,0,0),nsb=class{xba(a){if(this.mode!==a){switch(this.mode){case void 0:break;case 0:this.ops.push(Wp(this.acc));this.pre+=this.acc;this.post+=this.acc;this.acc=0;break;case 1:this.ops.push(Wnb(this.acc));this.post+=this.acc;this.acc=0;break;case 2:this.ops.push(Ynb(this.acc));this.pre+=this.acc;
this.post+=this.acc;this.acc=0;break;case 3:case 4:break;default:throw new q(this.mode);}this.mode=a}}accumulate(a,b=1){fa(b>=0,"{} < 0",b);b&&(this.xba(a),this.acc+=b);return this}KZb({Qa:a,$l:b}){const c=this.ops.length,d=this.Daa||(this.Daa=new Map),e=this.gGa||(this.gGa=new Map);fa(!d.has(a),"duplicate record: {}",a);fa(!e.has(b),"duplicate recall: {}",b);d.set(a,c);e.set(b,c)}append(a,b){switch(a.type){case 0:return this.retain(a.length);case 1:return this.expand(a.length);case 2:return this.J6(a.length);
case 3:var c=a.shift;if(!b&&(b=a.state,c&&c.Qa===c.$l&&(c=void 0,a=Xp(b)),b==null&&c==null))return this.expand();this.xba(a.type);c&&this.KZb(c);this.ops.push(a);this.post++;return this;case 4:c=a.shift;if(!b)if(b=a.delta,c&&c.Qa===c.$l&&(c=void 0,a=Yp(b)),b==null){if(c==null)return this.retain()}else if(b.type===1&&b.oldState==null&&b.newState==null&&c==null)return this.J6();this.xba(a.type);c&&this.KZb(c);this.ops.push(a);this.pre++;this.post++;return this;default:throw new q(a);}}retain(a){return a==
null||typeof a==="number"?this.accumulate(0,a):this.append(Yp(void 0,a))}expand(a){return a==null||typeof a==="number"?this.accumulate(1,a):this.append(Xp(void 0,a))}J6(a){return a==null||typeof a==="number"?this.accumulate(2,a):this.append(Yp(this.component.replace(void 0,void 0),a))}insert(a,b){return this.append(Xp(a,b))}update(a,b){return this.append(Yp(a!=null?this.component.update(a):void 0,b))}kya(a){return this.append(Yp(this.component.replace(void 0,a)))}aU(a){return this.append(Yp(this.component.replace(a,
void 0)))}Lp(a,b,c){return this.append(Yp(this.component.replace(a,b),c))}build(a){this.mode!==0&&this.xba();if(a?.GUc())return a.ypc(this.ops);if(!this.Daa&&!this.gGa)return new bob(this.ops,this.pre,this.post,0);a=this.ops;const b=l(this.Daa);var c=[...b.keys()];if(c.some((g,h)=>g!==h)){const g=new Map;c.forEach((h,k)=>g.set(h,k));for(const h of b.values())switch(c=a[h],c.type){case 3:var d=c.shift,e=g.get(d.Qa),f=g.get(d.$l);if(e!==d.Qa||f!==d.$l)a[h]=Xp(c.state,{Qa:e,$l:f});break;case 4:d=c.shift;
e=g.get(d.Qa);f=g.get(d.$l);if(e!==d.Qa||f!==d.$l)a[h]=Yp(c.delta,{Qa:e,$l:f});break;case 0:case 1:case 2:throw Error(`INSERT | UPDATE expected: ${aob(c)}`);default:throw new q(c);}}return new bob(a,this.pre,this.post,b.size)}constructor(a){this.component=a;this.ops=[];this.acc=this.post=this.pre=0;this.gGa=this.Daa=this.mode=void 0}},osb=class{KZb(a,{Qa:b,$l:c}){const d=this.Daa||(this.Daa=new Map),e=this.gGa||(this.gGa=new Map);ia(!d.has(b),"already recorded: {}",b);ia(!e.has(c),"already recalled: {}",
c);d.set(b,a);e.set(c,this.length)}append(a,b){b?this.KZb(a,b):a!=null&&(this.list[this.length]=a);this.length++;return this}expand(a=1){fa(a>=0,"{} < 0",a);this.length+=a;return this}build(){const a=this.list;if(this.Daa||this.gGa){const c=l(this.Daa);var b=l(this.gGa);Rn(c.size,b.size);for(const [d,e]of b)ia(c.has(d),"recall has no record: {}",d),b=c.get(d),b!=null&&(a[e]=b)}this.Cfd!=null&&Rn(this.length,this.Cfd);return a}constructor(a){this.Cfd=a;this.list=[];this.length=0;this.gGa=this.Daa=
void 0}},psb=class extends Wq{static of(a){return new psb(new Rrb(new lsb(a)))}pe(){return new nsb(this.component)}isIdentity(a){return!a.ops.length||a.ops.every(b=>{switch(b.type){case 0:return!0;case 4:return!b.shift&&this.component.isIdentity(b.delta);case 2:case 1:case 3:return!1}throw new q(b);})}constructor(a){super();this.component=a}};var qsb={type:0,length:1},fob=Xp(),eob=Yp(),gob=Yp(new Qrb),rsb=class{static create(a,b,c){fa(b>=0,"{} < 0",b);fa(c>=0,"{} < 0",c);a=(b=Math.max(0,b-a.pre,c-a.post))?[...a.ops,Wp(b)]:a.ops;return new rsb(a)}get head(){return this.xm}ND(a,b=1){const c=l(this.xm);if(c.type!==a)throw Error();const d=c.length;fa(0<b&&b<=d,"{} \u2209 (0, {}]",b,d);if(b<d)switch(a){case 0:return this.xm=Wp(d-b),Wp(b);case 1:return this.xm=Wnb(d-b),Wnb(b);case 2:return this.xm=Ynb(d-b),Ynb(b);default:throw new q(a);}else return this.xm=
this.ops[this.i++],c}constructor(a){this.ops=a;this.i=0;this.xm=a[this.i++]}},ssb=class{static create(a,b){a.length<b&&(a=a.slice(),a.length=b);return new ssb(a)}finish(){Rn(this.mQa,this.input.length)}constructor(a){this.input=a;this.mQa=0}},tsb=class{GUc(){return!!this.usb}ypc(a){const b=new nsb(this.component);for(const c of a)switch(c.type){case 3:b.append(this.fhd(c));break;case 4:b.append(this.ghd(c));break;case 0:case 1:case 2:b.append(c);break;default:throw new q(c);}return b.build()}constructor(a){this.component=
a;this.wIc=this.xIc=this.usb=void 0}},usb=class extends tsb{fhd(a){if(!a.shift)return a;const b=a.state,c=a.shift;var d=this.m5b?.get(c.Qa);d=this.component.apply(b,d);const e=nob(this,c);return d!==b||e!==c?Xp(d,e):a}ghd(a){if(!a.shift)return a;const b=a.delta,c=a.shift;var d=this.m5b?.get(c.Qa);d=this.component.compose(b,d);const e=nob(this,c);return d!==b||e!==c?Yp(d,e):a}constructor(...a){super(...a);this.m5b=void 0}},vsb=class extends tsb{GUc(){return super.GUc()||!!this.mab||!!this.Pab}fhd(a){if(!a.shift)return a;
const b=a.shift,c=nob(this,b);if(c!==b)throw Error(`${JSON.stringify(c)} != ${JSON.stringify(b)}`);return a}ghd(a){const b=a.delta,c=a.shift;var d=this.mab;if(d){var e=d.get(a);if(e==null)e=a.delta;else{d.delete(a);d=l(this.Pab);var f=d.get(e);d.delete(e);e=f}}else e=a.delta;d=c&&nob(this,c);return e!==b||d!==c?Yp(e,d):a}ypc(a){a=super.ypc(a);if(this.mab?.size)throw Error(`unconsumed setSurrogates: ${[...this.mab.values()]}`);if(this.Pab?.size)throw Error(`unconsumed subSurrogates: ${[...this.Pab.keys()]}`);
return a}constructor(...a){super(...a);this.Pab=this.mab=void 0}},wsb=class extends Xq{pe(){return this.base.pe()}isIdentity(a){return this.base.isIdentity(a)}compose(a,b){if(!a.ops.length)return b;if(!b.ops.length)return a;const c=this.component,d=this.pe(),e=new usb(c),f=rsb.create(a,0,b.pre),g=rsb.create(cob(b,a.wUa),a.post,0);for(var h=f.head,k=g.head;h||k;){if(k)if(k.type===1)d.append(g.ND(k.type,k.length));else if(k.type===3)d.append(Zp(g,k.type));else if(h)if(h.type===1)switch(k.type){case 2:case 0:var m=
Math.min(h.length,k.length);f.ND(h.type,m);g.ND(k.type,m);d.append(Wnb(m));break;case 4:m=Zp(f,h.type);k=Zp(g,k.type);h=k.shift;d.append(Xp(c.apply(m.state,k.delta),h));break;default:throw new q(k);}else if(h.type===3){m=Zp(f,h.type);k=Zp(g,k.type);h=m.shift;var n=k.shift;h==null?d.append(Xp(c.apply(m.state,k.delta),n)):n==null?(d.append(m),$p(e,h.$l,k.delta)):(d.append(Xp(m.state,{Qa:h.Qa,$l:n.$l})),$p(e,h.$l,k.delta),mob(e,n.Qa,h.$l))}else h.type===4||k.type===4?(k=Zp(f,4),m=Zp(g,4),h=k.shift,n=
m.shift,h==null?d.append(Yp(c.compose(k.delta,m.delta),n)):n==null?(d.append(k),$p(e,h.$l,m.delta)):(d.append(Yp(k.delta,{Qa:h.Qa,$l:n.$l})),$p(e,h.$l,m.delta),mob(e,n.Qa,h.$l))):(m=Math.min(h.length,k.length),h=f.ND(h.type,m),k=g.ND(k.type,m),d.append(h.type===2||k.type===2?Ynb(m):Wp(m)));else throw Error(`length mismatch: ${a} ; ${b}`);else throw Error(`length mismatch: ${a} ; ${b}`);h=f.head;k=g.head}return d.build(e)}transform(a,b){if(!a.ops.length||!b.ops.length)return Cp(b,a);const c=this.component,
d=rsb.create(a,b.pre,0),e=rsb.create(cob(b,a.wUa),a.pre,0),f=this.pe(),g=this.pe(),h=Bp.Oq(),k=new vsb(c),m=new vsb(c);for(var n=d.head,p=e.head;n||p;){if(n?.type===3)if(p=Zp(d,n.type),p.shift){var t=p.shift;n=Yp();g.append(n,"nocollapse");f.append(p);bq(k,t.$l,n);aq(k,t.Qa)}else g.append(qsb),f.append(p);else if(n?.type===1)p=d.ND(n.type,n.length),g.append(Wp(p.length)),f.append(p);else if(p?.type===3)if(p=Zp(e,p.type),p.shift){n=p.shift;t=n.Qa;n=n.$l;var v=-t-1,x=Yp(void 0,{Qa:-n-1,$l:n});g.append(p);
f.append(x);bq(m,n,x);aq(m,t);lob(m,v,t)}else g.append(p),f.append(qsb);else if(p?.type===1)t=e.ND(p.type,p.length),g.append(t),f.append(Wp(p.length));else if(n&&p)if(n.type===4||p.type===4){t=Zp(d,n.type);n=Zp(e,p.type);const {Rt:z,uu:B}=Fp(h,c.transform(t.delta,n.delta));p=t.shift;n=n.shift;if(p)if(n){t=n.Qa;n=n.$l;v=p.Qa;p=p.$l;x=-t-1;const C=Yp(void 0,{Qa:-n-1,$l:n}),D=Yp(void 0,{Qa:t,$l:n});g.append(D);f.append(C);bq(k,p,D);bq(m,n,C);aq(k,v,z);aq(m,t,B);lob(m,x,v);mob(m,t,p)}else t=p.Qa,n=p.$l,
v=Yp(),g.append(v,"nocollapse"),f.append(Yp(B,p)),bq(k,n,v),aq(k,t,z);else n?(p=n.Qa,t=n.$l,v=-p-1,x=Yp(void 0,{Qa:-t-1,$l:t}),g.append(Yp(z,n)),f.append(x),bq(m,t,x),aq(m,p,B),lob(m,v,p)):(g.append(Yp(z)),f.append(Yp(B)))}else t=Math.min(n.length,p.length),n=d.ND(n.type,t),p=e.ND(p.type,t),n.type===2&&p.type===2?g.append(Wp(p.length)):g.append(p),f.append(n);else throw Error(`length mismatch (${a} x ${b})`);n=d.head;p=e.head}return h.build(g.build(k),f.build(m))}xl(a){if(!a.ops.length)return a;const b=
this.pe(),c=new usb(this.component);for(const d of a.ops)switch(d.type){case 0:case 1:case 2:b.retain(d.length);break;case 4:a=this.component.xl(d.delta);const e=d.shift&&oob(d.shift);e?(b.retain(e),$p(c,e.$l,a)):b.append(Yp(a));break;case 3:a=d.shift&&oob(d.shift);d.state!=null?a?(b.retain(a),$p(c,a.$l,this.component.replace(d.state,void 0))):b.aU(d.state):b.retain(a);break;default:throw new q(d);}return b.build(c)}wk(a,b){if(a===b)return!0;if(a.pre!==b.pre||a.post!==b.post||a.ops.length!==b.ops.length)return!1;
for(let c=0;c<a.ops.length;c++)if(!this.eEc(a.ops[c],b.ops[c]))return!1;return!0}eEc(a,b){switch(a.type){case 0:case 1:case 2:return a.type===b.type&&a.length!==b.length;case 3:return a.type===b.type&&this.component.Bj(a.state,b.state)&&pob(a.shift,b.shift);case 4:return a.type===b.type&&this.component.wk(a.delta,b.delta)&&pob(a.shift,b.shift);default:throw new q(a);}}rf(a){return new osb(a)}identity(){return msb}apply(a,b){if(!b.ops.length)return a;const c=ssb.create(a,b.pre),d=new osb(Math.max(a.length,
b.pre)+(b.post-b.pre));b=b.pre<a.length?[...b.ops,Wp(a.length-b.pre)]:b.ops;for(const e of b)switch(e.type){case 0:dob(d,job(c,e.length));break;case 1:d.expand(e.length);break;case 2:ia(hob(job(c,e.length)));d.expand(e.length);break;case 3:d.append(e.state,e.shift);break;case 4:d.append(this.component.apply(iob(c),e.delta),e.shift);break;default:throw new q(e);}c.finish();return sq(this.qe,a,Object.freeze(d.build()))}Nl(a,b){if(!b.ops.length)return a;const {unshift:c,ruf:d}=this.unshift(b);b=d;a=
this.apply(a,c);const e=ssb.create(a,b.post),f=new osb(Math.max(a.length,b.post)+(b.pre-b.post));b=b.post<a.length?[...b.ops,Wp(a.length-b.post)]:b.ops;for(const g of b)switch(g.type){case 0:dob(f,job(e,g.length));break;case 1:ia(hob(job(e,g.length)));break;case 2:ia(hob(job(e,g.length)));f.expand(g.length);break;case 3:Ap(this.component,g.state,iob(e));break;case 4:f.append(this.component.Nl(iob(e),g.delta));break;default:throw new q(g);}e.finish();return sq(this.qe,a,Object.freeze(f.build()))}unshift(a){const b=
this.pe(),c=this.pe();for(const d of a.ops)switch(d.type){case 0:b.append(d);c.append(d);break;case 1:case 2:b.append(Wp(d.length));c.append(d);break;case 4:d.shift?(b.retain(oob(d.shift)),c.append(Yp(d.delta))):(b.retain(),c.append(d));break;case 3:d.shift?(b.retain(oob(d.shift)),c.append(Xp(d.state))):(b.retain(),c.append(d));break;default:throw new q(d);}return{unshift:b.build(),ruf:c.build()}}hg(a){const b=[];a.forEach((c,d)=>{c=this.component.hg(c);c!=null&&(b[d]=c)});return Object.freeze(b)}Bj(a,
b){if(a===b)return!0;if(a.length!==b.length)return!1;const c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let e=0;e<c.length;e++)if(c[e]!==d[e]||!this.component.Bj(a[c[e]],b[d[e]]))return!1;return!0}equals(a){return this===a||a instanceof wsb&&this.component.equals(a.component)}constructor(a,b){super(a);this.component=b;this.base=new psb(this.component)}};var xsb=class extends Xq{isIdentity(a){throw new q(a);}compose(a){throw new q(a);}transform(a){throw new q(a);}xl(a){throw new q(a);}wk(a){throw new q(a);}identity(a){throw new q(a);}apply(a){throw new q(a);}Nl(a){throw new q(a);}hg(a){throw new q(a);}Bj(a){throw new q(a);}equals(a){return this===a||a instanceof xsb}};var ysb=class extends Xq{isIdentity(a){return this.base.isIdentity(a)}compose(a,b){fa(a==null===(b==null));return a!=null&&b!=null?this.component.compose(a,b):void 0}transform(a,b){fa(a==null===(b==null));return a!=null&&b!=null?this.component.transform(a,b):Cp(b,a)}xl(a){return a!=null?this.component.xl(a):void 0}wk(a,b){return a!=null&&b!=null&&this.component.wk(a,b)||a==null&&b==null}identity(a){return a!=null?this.component.identity(a):void 0}apply(a,b){fa(a==null===(b==null));return a!=null&&
b!=null?this.component.apply(a,b):void 0}Nl(a,b){fa(a==null===(b==null));return a!=null&&b!=null?this.component.Nl(a,b):void 0}hg(a){return a!=null?this.component.hg(a):void 0}Bj(a,b){return a===b||a!=null&&b!=null&&this.component.Bj(a,b)}equals(a){return this===a||a instanceof ysb&&this.component.equals(a.component)}constructor(a,b){super(a);this.component=b;this.base=new lsb(this.component);fa(!(b instanceof ysb))}};var zsb=new Map,Asb=class{ordinal(a,b){b!=null?this.Geb.set(a,b):this.Geb.delete(a);return this}lm(a){a.forEach((b,c)=>this.Geb.set(c,b));return this}build(){return this.Geb.size?this.Geb:zsb}constructor(){this.Geb=new Map}},cq=class{toString(){return`R(${this.oldValue??"_"},${this.newValue??"_"})`}constructor(a,b){this.oldValue=a;this.newValue=b;this.type=0}},rob=class{toString(){return`U(${this.oldValue},${this.newValue})`}constructor(a,b){this.oldValue=a;this.newValue=b;this.type=1}},Yq=class{static create(a,
b,c,d){a=a.isIdentity(c);const e=d.size===0;return a&&e?b:new Yq(a?b.axis:c,e?b.lm:d)}toString(){const a=[...this.lm].map(([b,c])=>`"${b}":${c}`).join(",");return`{${this.axis}|${a}}`}constructor(a,b){this.axis=a;this.lm=b}},Bsb=class{static create(a,b){return new Bsb(a,b,a.pe())}retain(a){this.PKa.retain(a);return this}expand(a){this.PKa.expand(a);return this}build(){return Yq.create(this.axis,this.UQ,this.PKa.build(),this.lm)}constructor(a,b,c){this.axis=a;this.UQ=b;this.PKa=c;this.lm=new Map}},
Csb=class extends Xq{rf(){return new Asb}pe(){return Bsb.create(this.axis,this.UQ)}replace(a,b,c){return qob(this.pe(),a,b,c).build()}update(a,b,c){return sob(this.pe(),a,b,c).build()}mf(a,b){return Yq.create(this.axis,this.UQ,a,b)}isIdentity(a){return this.axis.isIdentity(a.axis)&&!a.lm.size}compose(a,b){if(this.isIdentity(a))return b;if(this.isIdentity(b))return a;const c=uob(this,a.lm,b.axis),d=new Map;for(const h of tob(c,b.lm)){var e=c.get(h);const k=b.lm.get(h);if(e&&k){var f=d,g=f.set;a:{Rn(e.newValue,
k.oldValue);switch(e.type){case 0:e=new cq(e.oldValue,k.newValue);break a;case 1:switch(k.type){case 0:e=new cq(e.oldValue,k.newValue);break a;case 1:e=new rob(e.oldValue,k.newValue);break a;default:throw new q(k);}default:throw new q(e);}e=void 0}g.call(f,h,e)}else e?d.set(h,e):k&&d.set(h,k)}return Yq.create(this.axis,this.UQ,this.axis.compose(a.axis,b.axis),d)}transform(a,b){if(this.isIdentity(a)||this.isIdentity(b))return Cp(b,a);const c=Bp.Oq(),{Rt:d,uu:e}=Fp(c,this.axis.transform(a.axis,b.axis));
a=uob(this,a.lm,d);const f=uob(this,b.lm,e);b=new Map;const g=new Map;for(var h of tob(a,f)){var k=a.get(h);const m=f.get(h);if(k&&m){a:{Rn(k.oldValue,m.oldValue);switch(k.type){case 0:k=Dp(new cq(m.newValue,k.newValue));break a;case 1:switch(m.type){case 0:k=new Bp(new cq(k.newValue,m.newValue),void 0,!1,!0);break a;case 1:k=Dp(new rob(m.newValue,k.newValue));break a;default:throw new q(m);}default:throw new q(k);}k=void 0}const {Rt:n,uu:p}=Fp(c,k);p&&b.set(h,p);n&&g.set(h,n)}else k?b.set(h,k):m&&
g.set(h,m)}h=Yq.create(this.axis,this.UQ,d,g);a=Yq.create(this.axis,this.UQ,e,b);return c.build(h,a)}xl(a){const b=a.lm.size===0?a.lm:gh(a.lm,c=>{switch(c.type){case 0:return new cq(c.newValue,c.oldValue);case 1:return new rob(c.newValue,c.oldValue);default:throw new q(c);}});return Yq.create(this.axis,this.UQ,this.axis.xl(a.axis),b)}wk(a,b){if(a===b)return!0;if(!this.axis.wk(a.axis,b.axis)||a.lm.size!==b.lm.size)return!1;for(const e of a.lm.keys()){var c=a.lm.get(e),d=b.lm.get(e);if(c!==d&&(c==null||
d==null||c.type!==d.type||c.oldValue!==d.oldValue||c.newValue!==d.newValue))return!1}return!0}identity(){return this.UQ}apply(a,b){if(this.isIdentity(b)||!a.size&&!b.lm.size)return a;const c=this.sOa(a,b.axis);if(!b.lm.size)return sq(this.qe,a,c);const d=new Map(c);for(const [e,f]of b.lm)b=c.get(e),Rn(b,f.oldValue),f.newValue!=null?d.set(e,f.newValue):d.delete(e);return sq(this.qe,a,d)}sOa(a,b){if(this.axis.isIdentity(b))return a;const c=new Set(a.values()),d=Ip(b,c);return gh(a,e=>l(d.get(e)))}Nl(a,
b){if(this.isIdentity(b)||!a.size&&!b.lm.size)return a;if(!b.lm.size)return sq(this.qe,a,this.V4b(a,b.axis));const c=new Map(a);for(const [d,e]of b.lm){const f=a.get(d);Rn(f,e.newValue);e.oldValue!=null?c.set(d,e.oldValue):c.delete(d)}return sq(this.qe,a,this.V4b(c,b.axis))}V4b(a,b){if(this.axis.isIdentity(b))return a;const c=new Set(a.values()),d=Zmb(b,c);return gh(a,e=>l(d.get(e)))}hg(a){return new Map(a)}Bj(a,b){return a===b?!0:a.size===b.size&&[...a.keys()].every(c=>a.get(c)===b.get(c))}equals(a){return this===
a||a instanceof Csb}constructor(a,b){super(a);this.axis=b;this.O_=zsb;this.UQ=new Yq(this.axis.pe().build(),new Map)}};var Dsb,eq,fq,gq,Hsb,Esb,Fsb,Isb,Jsb,Ksb,Lsb,$q,Nsb,Osb,Psb,Msb;Dsb=class{};eq=class extends Dsb{get length(){return this.state.length}sTc(a){vob(this,a);return this.state.charAt(a)}vV(a){wob(this,a);return[new eq(this.state.substring(0,a)),new eq(this.state.substring(a))]}oL(){return this}toString(){return this.state}constructor(a){super();this.state=a;this.type=0;fa(!!a)}};
fq=class extends Dsb{get length(){return 1}sTc(a){vob(this,a);return this.state}vV(a){wob(this,a);throw Error();}oL(a){return new fq(a(this.state))}toString(){return`[${this.state}]`}constructor(a){super();this.state=a;this.type=1}};
gq=class extends Dsb{get length(){return this.state}sTc(a){vob(this,a)}vV(a){wob(this,a);return[new gq(a),new gq(this.state-a)]}oL(){return this}toString(){return this.state<=7?"\u00b7".repeat(this.state):`\u00b7\u00b7(${this.state})\u00b7\u00b7`}constructor(a){super();this.state=a;this.type=2;fa(!!a)}};
__c.Zq=class{get length(){return this.qra+this.yr+this.GQc}Ad(a){return new Esb(this,a)}cursor(a,b){return new Fsb(this,a,b)}Fwc(a){if(this.sequence.length!==0){fa(a>=0,"{} < 0",a);var b=0,c=0;for(const d of this.sequence){const e=dq(d),f=Math.abs(d)||1;if(a<f)switch(e){case 0:return this.je[b].charAt(a);case 1:return this.items[c];case 2:return;default:throw new q(e);}switch(e){case 0:Rn(this.je[b].length,f);b++;break;case 1:c++;break;case 2:break;default:throw new q(e);}a-=f}}}oL(a){return new __c.Zq(this.sequence,
this.je,this.items.map(b=>a(b)),this.qra,this.yr,this.GQc)}bb(){return this.je.join("")}forEach(a,b){let c=0,d=0;for(const e of this.sequence){const f=dq(e);switch(f){case 0:Rn(this.je[c].length,e);b.bb?.(this.je[c]);c++;break;case 1:b.item(this.items[d]);d++;break;case 2:b.vm?.(-e);break;default:throw new q(f);}}(a=Math.max(0,a-this.length))&&b.vm?.(a)}map(a,b){let c=0,d=0;const e=this.sequence.map(f=>{const g=dq(f);switch(g){case 0:return Rn(this.je[c].length,f),b.bb(this.je[c++]);case 1:return b.item(this.items[d++]);
case 2:return b.vm(-f);default:throw new q(g);}});(a=Math.max(0,a-this.length))&&e.push(b.vm(a));return e}reduce(a,b){let c=0,d=0;return this.sequence.reduce((e,f)=>{const g=dq(f);switch(g){case 0:return Rn(this.je[c].length,f),a.bb(e,this.je[c++]);case 1:return a.item(e,this.items[d++]);case 2:return a.vm?a.vm(e,-f):e;default:throw new q(g);}},b)}slice(a,b){fa(0<=a&&a<=b,"invalid range: [{}, {})",a,b);var c=this.length;if(0===a&&b>=c)return this;if(a===b||a>=c)return __c.Gsb;const d=new Hsb;c=this.cursor(b);
c.qJ(a);c.qJ(b-a,{item:e=>d.item(e),bb:e=>d.je(e),vm:e=>d.G7(e)});return d.build()}toString(){let a=0,b=0;return this.sequence.map(c=>{const d=dq(c);switch(d){case 0:return Rn(this.je[a].length,c),this.je[a++];case 1:return`[${this.items[b++]}]`;case 2:return-c<7?"\u00b7".repeat(-c):`\u00b7\u00b7(${c})\u00b7\u00b7`;default:throw new q(d);}}).join("")}constructor(a,b,c,d,e,f){this.sequence=a;this.je=b;this.items=c;this.qra=d;this.yr=e;this.GQc=f;a=a.length?a[a.length-1]:void 0;fa(a==null||a>=0)}};
__c.Gsb=new __c.Zq([],[],[],0,0,0);
Hsb=class{xoa(a){this.mode!==a&&(this.flush(),this.mode=a)}flush(){if(this.mode!=null){switch(this.mode){case 0:this.bb.push(this.O9a);this.sequence.push(this.O9a.length);this.FHb+=this.O9a.length;this.O9a="";break;case 2:this.sequence.push(-this.Gwb);this.g4b+=this.Gwb;this.Gwb=0;break;default:throw new q(this.mode);}this.mode=void 0}}region(a){switch(a.type){case 0:return this.je(a.state);case 1:return this.item(a.state);case 2:return this.G7(a.state);default:throw new q(a);}}je(a){a&&(this.xoa(0),
this.O9a+=a);return this}item(a){this.flush();this.items.push(a);this.sequence.push(0);this.Ewc++;return this}G7(a){a>0&&(this.xoa(2),this.Gwb+=a);return this}append(a,b=0){a.forEach(b,{bb:c=>this.je(c),item:c=>this.item(c),vm:c=>this.G7(c)});return this}get length(){return this.FHb+this.Ewc+this.g4b}build(){this.mode!==2&&this.flush();return this.length?new __c.Zq(this.sequence,this.bb,this.items,this.FHb,this.Ewc,this.g4b):__c.Gsb}constructor(){this.sequence=[];this.bb=[];this.items=[];this.mode=
void 0;this.O9a="";this.g4b=this.Ewc=this.FHb=this.Gwb=0}};
Esb=class{get head(){return this.xm}get prevValue(){return this.PYb?.sTc(this.PYb.length-1)}fo(a){const b=l(this.xm),c=b.length;fa(0<a&&a<=c,"{} \u2209 (0, {}]",a,c);if(a<c)return a=b.vV(a),this.xm=a[1],this.PYb=a[0];this.xm=yob(this);return this.PYb=b}finish(){ia(this.xm==null,"unconsumed reader head: {}",this.xm)}constructor(a,b=0){this.rRe=this.$he=this.jgf=0;this.PYb=void 0;this.sequence=(b=Math.max(0,b-a.length))?[...a.sequence,-b]:a.sequence;this.je=a.je;this.items=a.items;this.xm=yob(this)}};
Fsb=class{get prevValue(){return this.Ad.prevValue}move(a,b,c){for(c=zob(this.Trb,c);a;){var d=this.Ad.head;if(d)switch(d=this.Ad.fo(b||d.type!==2?Math.min(d.length,a):d.length),d.type){case 0:c&&c.bb?.(d.state);a-=d.length;break;case 1:c&&c.item?.(d.state);a-=d.length;break;case 2:c&&c.vm?.(d.state);b&&(a-=d.length);break;default:throw new q(d);}else fa(b,"not enough characters or items: {}",a),c&&c.vm?.(a),a-=a}}qJ(a,b){this.move(a,!0,b)}zt(a,b){this.move(a,!1,b)}M6a(){const a=zob(this.Trb),b=this.Ad.head;
b&&b.type===2&&(this.Ad.fo(b.length),a&&a.vm?.(b.length))}moveBefore(a,b){Rn(a.length,1);b=zob(this.Trb,b);let c=!1;for(;!c;){var d=this.Ad.head;if(!d)break;const e=d.type===0?d.state.indexOf(a):-1;if(d=(c=e!==-1)?e:d.length)switch(d=this.Ad.fo(d),d.type){case 0:b&&b.bb?.(d.state);break;case 1:b&&b.item?.(d.state);break;case 2:b&&b.vm?.(d.state);break;default:throw new q(d);}}return c}finish(){this.Ad.finish()}constructor(a,b,c){this.Trb=c;this.Ad=a.Ad(b)}};Isb=class{};
Jsb=class extends Isb{get Jfa(){return this.length}get V5(){return this.length}u2b(a){Aob(this,a);return this.vV(a)}t2b(a){Bob(this,a);return this.vV(a)}vV(a){return[new Jsb(a),new Jsb(this.length-a)]}map(){return this}toString(){return`R${this.length}`}constructor(a){super();this.length=a;this.type=0}};
Ksb=class extends Isb{get Jfa(){return 1}get V5(){return 1}u2b(a){Aob(this,a);throw Error();}t2b(a){Bob(this,a);throw Error();}map(a){return new Ksb(a(this.delta))}toString(){return`U[${this.delta}]`}constructor(a){super();this.delta=a;this.type=1}};
Lsb=class extends Isb{get Jfa(){return 0}get V5(){return this.state.length}u2b(a){Aob(this,a);throw Error();}t2b(a){Bob(this,a);const [b,c]=this.state.vV(a);return[new Lsb(b),new Lsb(c)]}map(a,b){return new Lsb(this.state.oL(b))}toString(){switch(this.state.type){case 0:case 1:return`I${this.state}`;case 2:return`X${this.state.length}`;default:throw new q(this.state);}}constructor(a){super();this.state=a;this.type=2}};
$q=class extends Isb{get Jfa(){return this.oldState.length}get V5(){return this.newState.length}u2b(a){Aob(this,a);return this.vV(a)}t2b(a){Bob(this,a);return this.vV(a)}vV(a){const [b,c]=this.oldState.vV(a),[d,e]=this.newState.vV(a);return[new $q(b,d),new $q(c,e)]}map(a,b){return new $q(this.oldState.oL(b),this.newState.oL(b))}toString(){return this.oldState.type===2?this.newState.type===2?`\u25e0${this.oldState.state}`:`\u2191${this.newState}`:this.newState.type===2?`\u2193${this.oldState}`:`\u25e1[${this.oldState}|${this.newState}]`}constructor(a,
b){super();this.oldState=a;this.newState=b;this.type=3;Rn(a.length,b.length)}};
Nsb=class{Ad(a,b){return new Msb(this,a,b)}forEach(a,b=this.pre,c=this.post){for(const d of this.ops)switch(d.type){case 0:a.retain?.(d.length);break;case 1:a.update?.(d.delta);break;case 2:a.insert?.(d.state);break;case 3:a.Lp?.(d.oldState,d.newState);break;default:throw new q(d);}(b=Math.max(0,b-this.pre,c-this.post))&&a.retain?.(b)}map(a){return this.ops.map(b=>{switch(b.type){case 0:return a.retain(b.length);case 1:return a.update(b.delta);case 2:return a.insert(b.state);case 3:return a.Lp(b.oldState,
b.newState);default:throw new q(b);}})}oL(a,b){const c=this.ops.map(d=>d.map(a,b));return new Nsb(c,this.pre,this.post)}toString(){return`[${this.ops.toString()}]`}constructor(a,b,c){this.ops=a;this.pre=b;this.post=c}};Osb=new Nsb([],0,0);
Psb=class{xoa(a,b,c){if(this.m6!==a||this.wBc!==b||this.MAc!==c)switch(this.flush(),this.m6=a,this.wBc=b,this.MAc=c,a){case 0:break;case 2:c===0&&(this.Z0="");break;case 3:b===0&&(this.UEa="");c===0&&(this.Z0="");break;default:throw new q(a);}}flush(){if(this.m6!=null){switch(this.m6){case 0:this.push(new Jsb(this.acc));this.acc=0;break;case 2:var a=this.Z0!=null?new eq(this.Z0):new gq(this.acc);this.push(new Lsb(a));this.Z0=void 0;this.acc=0;break;case 3:a=this.UEa!=null?new eq(this.UEa):new gq(this.acc);
const b=this.Z0!=null?new eq(this.Z0):new gq(this.acc);this.push(new $q(a,b));this.Z0=this.UEa=void 0;this.acc=0;break;default:throw new q(this.m6);}this.MAc=this.wBc=this.m6=void 0}}push(a){this.ops.push(a);this.pre+=a.Jfa;this.post+=a.V5}op(a){switch(a.type){case 0:return this.retain(a.length);case 1:return this.update(a.delta);case 2:return this.sla(a.state);case 3:return hq(this,a.oldState,a.newState);default:throw new q(a);}}sla(a){switch(a.type){case 0:return this.insert(a.state);case 1:return this.insert(a.state);
case 2:return this.expand(a.state);default:throw new q(a);}}retain(a){fa(a>=0);a&&(this.xoa(0),this.acc+=a);return this}update(a){if(this.isIdentity(a))return this.retain(1);this.flush();this.ops.push(new Ksb(a));this.pre++;this.post++;return this}expand(a){fa(a>=0);a&&(this.xoa(2,void 0,2),this.acc+=a);return this}insert(a){typeof a==="string"?a&&(this.xoa(2,void 0,0),this.Z0+=a):(this.flush(),this.push(new Lsb(new fq(a))));return this}J6(a){fa(a>=0);a&&(this.xoa(3,2,2),this.acc+=a);return this}kya(a){typeof a===
"string"?a&&(this.xoa(3,2,0),this.acc+=a.length,this.Z0+=a):(this.flush(),this.push(new $q(new gq(1),new fq(a))));return this}aU(a){typeof a==="string"?a&&(this.xoa(3,0,2),this.acc+=a.length,this.UEa+=a):(this.flush(),this.push(new $q(new fq(a),new gq(1))));return this}Lp(a,b){typeof a==="string"?typeof b==="string"?(Rn(a.length,b.length),a&&(this.xoa(3,0,0),this.UEa+=a,this.Z0+=b)):(Rn(a.length,1),this.flush(),this.push(new $q(new eq(a),new fq(b)))):typeof b==="string"?(Rn(1,b.length),this.flush(),
this.push(new $q(new fq(a),new eq(b)))):(this.flush(),this.push(new $q(new fq(a),new fq(b))));return this}build(){this.m6!==0&&this.flush();return new Nsb(this.ops,this.pre,this.post)}constructor(a){this.isIdentity=a;this.ops=[];this.post=this.pre=0;this.MAc=this.wBc=this.m6=void 0;this.acc=0;this.Z0=this.UEa=void 0}};Msb=class{get head(){return this.xm}finish(){ia(this.xm==null)}constructor(a,b=0,c=0){this.ops=(b=Math.max(0,b-a.pre,c-a.post))?[...a.ops,new Jsb(b)]:a.ops;this.i=0;this.xm=this.ops[this.i++]}};
__c.Qsb=class extends Xq{pe(){return new Psb(a=>this.component.isIdentity(a))}rf(){return new Hsb}id(){return Osb}O_(){return __c.Gsb}isIdentity(a){return!a.ops.length||a.ops.every(b=>b.type===0)}compose(a,b){if(!a.ops.length)return b;if(!b.ops.length)return a;const c=a.Ad(0,b.pre),d=b.Ad(a.post,0),e=this.pe();for(;;){let g=c.head;var f=d.head;if(!f)break;f.type===2?(g=void 0,f=iq(d)):g&&(f=Math.min(g.V5,f.Jfa),g=Dob(c,f),f=Cob(d,f));if(f.type===2)e.sla(f.state);else if(g)g.type===2?e.sla(Fob(this,
g.state,f)):f.type===0?e.op(g):g.type===0?e.op(f):g.type===1?f.type===1?e.update(this.component.compose(g.delta,f.delta)):hq(e,Gob(this,f.oldState,g),f.newState):hq(e,g.oldState,Fob(this,g.newState,f));else throw Error(`length mismatch: ${a} ; ${b}`);}c.finish();d.finish();return e.build()}transform(a,b){if(!a.ops.length||!b.ops.length)return Cp(b,a);const c=this.pe(),d=this.pe(),e=a.Ad(b.pre,0),f=b.Ad(a.pre,0),g=Bp.Oq();for(;;){var h=e.head,k=f.head;if(!h&&!k)break;h&&h.type===2?(h=iq(e),k=void 0):
k&&k.type===2?(h=void 0,k=iq(f)):h&&k&&(k=Math.min(h.Jfa,k.Jfa),h=Cob(e,k),k=Cob(f,k));if(h&&h.type===2)d.retain(h.V5),c.op(h);else if(k&&k.type===2)d.op(k),c.retain(k.V5);else if(h&&k)h.type===0||k.type===0?(d.op(k),c.op(h)):h.type===3?(d.retain(h.V5),hq(c,Fob(this,h.oldState,k),h.newState),Vmb(g,k.type===3?!jq(this,h.newState,k.newState):!this.component.isIdentity(k.delta))):k.type===3?(hq(d,Fob(this,k.oldState,h),k.newState),c.retain(k.V5),Wmb(g,!this.component.isIdentity(h.delta))):(h=Fp(g,this.component.transform(h.delta,
k.delta)),d.update(h.Rt),c.update(h.uu));else throw Error(`length mismatch (${a} x ${b})`);}e.finish();f.finish();return g.build(d.build(),c.build())}xl(a){if(!a.ops.length)return a;const b=this.pe();for(const c of a.ops)switch(c.type){case 0:b.retain(c.length);break;case 1:b.update(this.component.xl(c.delta));break;case 2:a=c.state;a.type===2?b.retain(a.length):b.aU(a.state);break;case 3:a=c.oldState;const d=c.newState;a.type===2&&d.type===2?b.retain(a.length):hq(b,d,a);break;default:throw new q(c);
}return b.build()}wk(a,b){if(a===b)return!0;if(a.ops.length!==b.ops.length)return!1;for(let c=0;c<a.ops.length;c++)if(!this.eEc(a.ops[c],b.ops[c]))return!1;return!0}eEc(a,b){switch(a.type){case 0:return b.type===0&&a.length===b.length;case 1:return b.type===1&&this.component.wk(a.delta,b.delta);case 2:return b.type===2&&jq(this,a.state,b.state);case 3:return b.type===3&&jq(this,a.oldState,b.oldState)&&jq(this,a.newState,b.newState);default:throw new q(a);}}identity(){return Osb}apply(a,b){if(!b.ops.length)return a;
const c=this.rf(),d=a.Ad(b.pre);for(b=b.Ad(a.length,0);;){let f=d.head;var e=b.head;if(!e)break;e.type===2?(f=void 0,e=iq(b)):f&&(e=Math.min(f.length,e.Jfa),f=d.fo(e),e=Cob(b,e));if(e.type===2)c.region(e.state);else if(f)c.region(Fob(this,f,e));else break}d.finish();b.finish();return sq(this.qe,a,c.build())}Nl(a,b){if(!b.ops.length)return a;const c=this.rf(),d=a.Ad(b.post);for(b=b.Ad(0,a.length);;){let f=d.head;var e=b.head;if(!f||!e)break;e.type===2?(f=d.fo(e.V5),e=iq(b)):(e=Math.min(f.length,e.V5),
f=d.fo(e),e=Dob(b,e));if(e.type===2)Eob(this,f,e.state);else if(f)c.region(Gob(this,f,e));else break}d.finish();b.finish();return sq(this.qe,a,c.build())}hg(a){return this.component instanceof xsb&&a instanceof __c.Zq?a:a.oL(b=>this.component.hg(b))}Bj(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;a=a.Ad();b=b.Ad();let c=a.head,d=b.head;for(;c||d;){if(!c||!d||!jq(this,c,d))return!1;a.fo(c.length);b.fo(d.length);c=a.head;d=b.head}return!0}equals(a){return this===a||a instanceof __c.Qsb&&this.component.equals(a.component)}constructor(a,
b){super(a);this.component=b}};__c.Qsb.prototype.vF=ba(119);Mq=__c.Mq={item:a=>{throw new q(a);}};var Rsb,ar,Ssb,Tsb,br,Usb,cr;Rsb=new Map;ar=class{static from(a){if(a instanceof ar)return a;if(Array.isArray(a)){const [b,c]=a;return new ar(b,c)}return new ar(a.start,a.end)}toString(){return`[${this.start},${this.end}]`}constructor(a,b){this.start=a;this.end=b}};Ssb=class{range(a,b){b?this.lca.set(a,ar.from(b)):this.lca.delete(a);return this}Uf(a){a.forEach((b,c)=>this.lca.set(c,ar.from(b)));return this}build(){return this.lca.size?this.lca:Rsb}constructor(){this.lca=new Map}};
Tsb=class{toString(){return`R(${this.oldValue??"_"},${this.newValue??"_"})`}constructor(a,b){this.oldValue=a;this.newValue=b;this.type="replace"}};br=class{static from(a){if(a instanceof br)return a;if(Array.isArray(a)){const [b,c]=a;return new br(b,c)}return new br(a.oldValue,a.newValue)}toString(){return`[${this.oldValue},${this.newValue}]`}constructor(a,b){this.oldValue=a;this.newValue=b}};
Usb=class{toString(){return`U(${this.start??"_"},${this.end??"_"})`}constructor(a,b){this.start=a;this.end=b;this.type="update"}};cr=class{static create(a,b,c,d){a=a.isIdentity(c);const e=d.size===0;return a&&e?b:new cr(a?b.axis:c,e?b.Uf:d)}toString(){return`{${this.axis}|${[...this.Uf].map(([a,b])=>`"${a}":${b}`).join(",")}}`}constructor(a,b){this.axis=a;this.Uf=b}};
__c.Vsb=class{static create(a,b){return new __c.Vsb(a,b,a.pe())}retain(a){this.PKa.retain(a);return this}expand(a){this.PKa.expand(a);return this}EUa(a,b,c){this.Uf.set(a,new Tsb(b&&ar.from(b),c&&ar.from(c)));return this}createRange(a,b){return this.EUa(a,void 0,b)}build(){return cr.create(this.axis,this.UQ,this.PKa.build(),this.Uf)}constructor(a,b,c){this.axis=a;this.UQ=b;this.PKa=c;this.Uf=new Map}};__c.Vsb.prototype.YMa=ba(122);ia(!0);
var nqb=class{constructor(a,b,c){this.gn=a;this.axis=b;this.UQ=c;this.AQc=d=>kq(d);this.vPd=d=>{const e=new Map;for(const [f,g]of d)d=kq(f),e.set(d.start,g.start),e.set(d.end,g.end);return e};this.kFe=d=>Hob(d);this.eid=d=>{const e=new Map;d=new Map(d);for(const f of d.keys()){const g=Hob(f),h=kq(g),k=l(d.get(h.start)),m=l(d.get(h.end));d.delete(h.start);d.delete(h.end);e.set(g,ar.from({start:k,end:m}))}if(d.size)throw Error();return e};this.uPd=d=>{var e=this.gn;const f=e.pe();for(const [h,k]of d.Uf)switch(k.type){case "replace":var g=
kq(h);qob(f,g.start,k.oldValue?k.oldValue.start:void 0,k.newValue?k.newValue.start:void 0);qob(f,g.end,k.oldValue?k.oldValue.end:void 0,k.newValue?k.newValue.end:void 0);break;case "update":g=kq(h);k.start&&sob(f,g.start,k.start.oldValue,k.start.newValue);k.end&&sob(f,g.end,k.end.oldValue,k.end.newValue);break;default:throw new q(k);}return e.mf(d.axis,f.build().lm)};this.cid=d=>{var e=this.axis,f=this.UQ;const g=new Map,h=new Map(d.lm);for(const [n,p]of h){const t=Hob(n),v=kq(t);switch(p.type){case 0:var k=
l(h.get(v.start)),m=l(h.get(v.end));ia(k.type===p.type);ia(m.type===p.type);ia(k.oldValue!=null===(m.oldValue!=null));ia(k.newValue!=null===(m.newValue!=null));h.delete(v.start);h.delete(v.end);g.set(t,new Tsb(k.oldValue!=null&&m.oldValue!=null?ar.from([k.oldValue,m.oldValue]):void 0,k.newValue!=null&&m.newValue!=null?ar.from([k.newValue,m.newValue]):void 0));break;case 1:k=h.get(v.start);m=h.get(v.end);k&&ia(k.type===p.type);m&&ia(m.type===p.type);h.delete(v.start);h.delete(v.end);g.set(t,new Usb(k?
br.from(k):void 0,m?br.from(m):void 0));break;default:throw new q(p);}}if(h.size)throw Error();return cr.create(e,f,d.axis,g)}}},Wsb=class extends Xq{static create(a,b,c){var d=new cr(c.pe().build(),new Map);d=new nqb(b,c,d);return new Wsb(b.map(d.cid,d.uPd,d.eid,d.vPd),c,a)}rf(){return new Ssb}pe(){return __c.Vsb.create(this.axis,this.UQ)}replace(a,b,c){return this.pe().EUa(a,b,c).build()}update(a,b,c){var d=this.pe();d.Uf.set(a,new Usb(b&&br.from(b),c&&br.from(c)));return d.build()}mf(a,b){return cr.create(this.axis,
this.UQ,a,b)}isIdentity(a){return this.Mca.isIdentity(a)}compose(a,b){return this.Mca.compose(a,b)}transform(a,b){return this.Mca.transform(a,b)}xl(a){return this.Mca.xl(a)}wk(a,b){return this.Mca.wk(a,b)}identity(a){return this.Mca.identity(a)}apply(a,b){return this.Mca.apply(a,b)}Nl(a,b){return this.Mca.Nl(a,b)}hg(a){return this.Mca.hg(a)}Bj(a,b){return this.Mca.Bj(a,b)}equals(a){return this.Mca.equals(a)}constructor(a,b,c){super(c);this.Mca=a;this.axis=b;this.O_=Rsb;this.UQ=new cr(this.axis.pe().build(),
new Map)}};var Xsb=class extends Xq{get target(){typeof this.ref==="function"&&(this.ref=this.ref());return this.ref}isIdentity(a){return this.target.isIdentity(a)}compose(a,b){return this.target.compose(a,b)}transform(a,b){return this.target.transform(a,b)}xl(a){return this.target.xl(a)}wk(a,b){return this.target.wk(a,b)}identity(a){return this.target.identity(a)}apply(a,b){return this.target.apply(a,b)}Nl(a,b){return this.target.Nl(a,b)}hg(a){return this.target.hg(a)}Bj(a,b){return this.target.Bj(a,b)}equals(a){return this===
a||a instanceof Xsb&&this.target.equals(a.target)}constructor(a,b){super(a);this.ref=b}};var Zsb,Ysb,er,atb,ctb;
dr=__c.dr=class{Fwc(a){return this.cells.Fwc(a)}cursor(a,b){return new Ysb(this,a,b)}forEach(a){this.cursor(0,a).qJ(this.length)}oL(a){return new dr(this.cells.oL(a),this.attrs,this.Tc,this.MGa)}slice(a,b){fa(0<=a&&a<=b,"invalid range: [{}, {})",a,b);if(0===a&&b>=this.length)return this;const c=this.cells.slice(a,b),d=this.attrs.slice(a,b);return new dr(c,d,this.Tc?.slice(a,b),this.MGa)}toString(){return`${this.cells.toString()}|${this.attrs.toString()}`}constructor(a,b,c,d){this.cells=a;this.attrs=
b;this.Tc=c;this.MGa=d;this.length=Math.max(a.length,b.length)}};
Zsb=class{items(a){return this.je(a)}je(a){this.Wca.je(a);this.mW.Cd(a.length);return this}item(a){this.Wca.item(a);this.mW.Cd(1);return this}G7(a){this.Wca.G7(a);this.mW.Cd(a);return this}Vc(a,b,c){this.mW.Vc(a,b,c);return this}attrs(a,b){this.mW.attrs(a,b);return this}append(a,b=0){this.Wca.append(a.cells,b);this.mW.append(a.attrs,b);return this}ayb(a){this.byb?.Uf(a);return this}build(){return new dr(this.Wca.build(),this.mW.build(),this.byb?.build(),this.MGa)}constructor(a,b,c,d){this.Wca=a;this.mW=
b;this.byb=c;this.MGa=d}};
Ysb=class{get prevValue(){return this.c.prevValue}get cS(){return this.a.cS}get dwa(){return this.a.dwa}qJ(a,b){this.rEa=b;this.c.qJ(a);this.rEa=void 0}zt(a,b){this.rEa=b;this.c.zt(a);this.rEa=void 0}M6a(){this.rEa=void 0;this.c.M6a();this.rEa=void 0}moveBefore(a,b){this.rEa=b;a=this.c.moveBefore(a);this.rEa=void 0;return a}finish(){this.c.finish();this.a.finish()}constructor(a,b=0,c){b=Math.max(a.length,b);let d,e;this.a=a.attrs.cursor(b,{cells:(g,h,k,m,n)=>{var p=l(d);const t=p.length;fa(0<g&&g<=
t);g<t?(p=p.vV(g),g=p[0],d=p[1]):(g=p,d=void 0);if(e)switch(g.type){case 0:e.bb&&e.bb(g.state,h,k,m,n);break;case 1:e.item&&e.item(g.state,h,k,m,n);break;case 2:e.vm&&e.vm(g.state,h,k,m,n);break;default:throw new q(g);}}});const f=g=>{d=g;var h=this.rEa;e=h?c?{bb:Jp(h.bb,c.bb),item:Jp(h.item,c.item),vm:Jp(h.vm,c.vm)}:h:c;this.a.move(g.length);ia(d==null);e=void 0};this.c=a.cells.cursor(b,{bb:g=>f(new eq(g)),item:g=>f(new fq(g)),vm:g=>f(new gq(g))})}};
er=class{forEach(a){const b=this.oQ.Ad(this.pre,this.post);this.wQ.forEach({retain:c=>{for(;c>0;){var d=l(b.next);switch(d.type){case 1:throw Error("op mismatch: retain|insert");case 0:d=Math.min(d.length,c);const e=b.Yz(d);a.retain&&a.retain(d,e,b.CP);c-=d;break;default:throw new q(d);}}},update:c=>{var d=l(b.next);switch(d.type){case 1:throw Error("op mismatch: retain|insert");case 0:d=b.Yz(1);a.update&&a.update(c,d,b.CP);break;default:throw new q(d);}},insert:c=>{for(;;){var d=l(b.next);switch(d.type){case 1:d=
Math.min(d.length,c.length);const e=b.Bja(d);if(d===c.length){a.insert&&a.insert(c,e,b.CP);return}const [f,g]=c.vV(d);a.insert&&a.insert(f,e,b.CP);c=g;break;case 0:throw Error("op mismatch: insert|retain");default:throw new q(d);}}},Lp:(c,d)=>{for(;;){var e=l(b.next);switch(e.type){case 1:throw Error("op mismatch: change|insert");case 0:e=Math.min(e.length,c.length);const f=b.Yz(e);if(e===c.length){a.Lp&&a.Lp(c,d,f,b.CP);return}const [g,h]=c.vV(e),[k,m]=d.vV(e);a.Lp&&a.Lp(g,k,f,b.CP);c=h;d=m;break;
default:throw new q(e);}}}},this.pre,this.post);b.finish()}oL(a,b){return new er(this.wQ.oL(a,b),this.oQ,this.oG)}toString(){return`${this.wQ.toString()}|${this.oQ.toString()}|${this.oG?.toString()}}`}constructor(a,b,c){this.wQ=a;this.oQ=b;this.oG=c;this.pre=Math.max(this.wQ.pre,this.oQ.pre);this.post=Math.max(this.wQ.post,this.oQ.post)}};
__c.$sb=class{sla(a,b){this.cells.sla(a);this.attrs.insert(a.length,b);this.Tc?.insert(a.length);return this}retain(a,b){this.cells.retain(a);this.attrs.retain(a,b);this.Tc?.retain(a);return this}update(a){this.cells.update(a);this.attrs.retain(1);this.Tc?.retain(1);return this}expand(a){this.cells.expand(a);this.attrs.insert(a);this.Tc?.insert(a);return this}insert(a,b){const c=lq(a);this.cells.insert(a);this.attrs.insert(c,b);this.Tc?.insert(c);return this}J6(a){this.cells.J6(a);this.attrs.retain(a);
this.Tc?.retain(a);return this}kya(a){const b=lq(a);this.cells.kya(a);this.attrs.retain(b);this.Tc?.retain(b);return this}aU(a){const b=lq(a);this.cells.aU(a);this.attrs.retain(b);this.Tc?.retain(b);return this}replace(a,b){const c=lq(a);this.cells.Lp(a,b);this.attrs.retain(c);this.Tc?.retain(c);return this}build(){return new er(this.cells.build(),this.attrs.build(),this.Tc?.build())}constructor(a,b,c){this.cells=a;this.attrs=b;this.Tc=c}};__c.$sb.prototype.d_a=ba(124);
atb=class{retain(a){this.je.retain(a);this.attrs.retain(a);this.Tc?.retain(a);return this}insert(a){const b=typeof a==="string"?a.length:1;this.je.insert(a);this.attrs.insert(b);this.Tc?.insert(b);return this}delete(a){const b=typeof a==="string"?a.length:1;this.je.aU(a);this.attrs.retain(b);this.Tc?.retain(b);return this}open(a,b,c){this.attrs.open(a,b,c);return this}update(a){this.je.update(a);this.attrs.retain(1);this.Tc?.retain(1);return this}Tfa(a){this.attrs.Tfa(a)}close(a){this.attrs.close(a);
return this}DT(a){this.attrs.DT(a);return this}build(){return new er(this.je.build(),this.attrs.build(),this.Tc?.build())}constructor(a,b,c){this.je=a;this.attrs=b;this.Tc=c}};
__c.btb=class{sla(a,b){const c=a.length;this.cells.sla(a);this.attrs.insert(c,b);this.Tc?.insert(c);return this}retain(a,b){this.cells.retain(a);this.attrs.retain(a,b);this.Tc?.retain(a);return this}update(a){this.cells.update(a);this.attrs.retain(1);this.Tc?.retain(1);return this}expand(a){this.cells.expand(a);this.attrs.insert(a);this.Tc?.insert(a);return this}insert(a,b){const c=lq(a);this.cells.insert(a);this.attrs.insert(c,b);this.Tc?.insert(c);return this}J6(a){this.cells.J6(a);this.attrs.retain(a);
this.Tc?.retain(a);return this}kya(a){const b=lq(a);this.cells.kya(a);this.attrs.retain(b);this.Tc?.retain(b);return this}aU(a){const b=lq(a);this.cells.aU(a);this.attrs.retain(b);this.Tc?.retain(b);return this}replace(a,b){const c=lq(a);this.cells.Lp(a,b);this.attrs.retain(c);this.Tc?.retain(c);return this}build(){return new er(this.cells.build(),this.attrs.build(),this.Tc?.build())}constructor(a,b,c){this.cells=a;this.attrs=b;this.Tc=c}};__c.btb.prototype.d_a=ba(123);
ctb=class{items(a){return this.je(a)}je(a){this.Wca.je(a);this.mW.Cd(a.length);return this}item(a){this.Wca.item(a);this.mW.Cd(1);return this}G7(a){this.Wca.G7(a);this.mW.Cd(a);return this}Vc(a,b){this.mW.Vc(a,b);return this}attrs(a){this.mW.attrs(a);return this}append(a,b=0){this.Wca.append(a.cells,b);this.mW.append(a.attrs,b);return this}ayb(a){this.byb?.Uf(a);return this}build(){return new dr(this.Wca.build(),this.mW.build(),this.byb?.build(),this.MGa)}constructor(a,b,c,d){this.Wca=a;this.mW=b;
this.byb=c;this.MGa=d}};
__c.dtb=class extends Xq{pe(a){const b=this.cells.pe(),c=this.Tc?.pe();return a?new __c.btb(b,this.attrs.pe(a),c):new __c.$sb(b,this.attrs.pe(),c)}eH(a,b){return new atb(this.cells.pe(),this.attrs.eH(a.attrs,a.length,b),this.Tc?.pe())}rf(a){const b=this.cells.rf();return a?new ctb(b,this.attrs.rf(a),this.Tc?.rf(),this.Tc):new Zsb(b,this.attrs.rf(),this.Tc?.rf(),this.Tc)}mf(a=this.cells.id(),b=this.attrs.id(),c=this.Tc?.id()){fa(!this.Tc===!c);return new er(a,b,c)}$Fb(a,b){return this.attrs.eH(a.attrs,a.length,
b)}isIdentity(a){fa(!this.Tc===!a.oG);return this.cells.isIdentity(a.wQ)&&this.attrs.isIdentity(a.oQ)&&(!this.Tc||this.Tc.isIdentity(a.oG))}compose(a,b){fa(!this.Tc===!a.oG);fa(!this.Tc===!b.oG);return new er(this.cells.compose(a.wQ,b.wQ),this.attrs.compose(a.oQ,b.oQ),this.Tc?.compose(a.oG,b.oG))}transform(a,b){fa(!this.Tc===!a.oG);fa(!this.Tc===!a.oG);const c=Bp.Oq(),d=Fp(c,this.cells.transform(a.wQ,b.wQ)),e=Fp(c,this.attrs.transform(a.oQ,b.oQ));a=Fp(c,this.Tc?.transform(a.oG,b.oG)||Cp());return c.build(new er(d.Rt,
e.Rt,a.Rt),new er(d.uu,e.uu,a.uu))}xl(a){fa(!this.Tc===!a.oG);return new er(this.cells.xl(a.wQ),this.attrs.xl(a.oQ),this.Tc?.xl(a.oG))}wk(a,b){fa(!this.Tc===!a.oG);fa(!this.Tc===!b.oG);return this.cells.wk(a.wQ,b.wQ)&&this.attrs.wk(a.oQ,b.oQ)&&(!this.Tc||this.Tc.wk(a.oG,b.oG))}identity(){return this.id}apply(a,b){fa(!this.Tc===!a.Tc);fa(!this.Tc===!b.oG);return sq(this.qe,a,new dr(this.cells.apply(a.cells,b.wQ),this.attrs.apply(a.attrs,b.oQ),this.Tc?.apply(a.Tc,b.oG),this.Tc))}Nl(a,b){fa(!this.Tc===
!a.Tc);fa(!this.Tc===!b.oG);return sq(this.qe,a,new dr(this.cells.Nl(a.cells,b.wQ),this.attrs.Nl(a.attrs,b.oQ),this.Tc?.Nl(a.Tc,b.oG),this.Tc))}hg(a,b){fa(!this.Tc===!a.Tc);const c=this.cells.hg(a.cells);b=this.attrs.hg(a.attrs,b);const d=this.Tc?.hg(a.Tc);return c===a.cells&&b===a.attrs&&d===a.Tc&&a instanceof dr?a:new dr(c,b,d,this.Tc)}Bj(a,b){if(a===b)return!0;fa(!this.Tc===!a.Tc);fa(!this.Tc===!b.Tc);return this.cells.Bj(a.cells,b.cells)&&this.attrs.Bj(a.attrs,b.attrs)&&(!this.Tc||this.Tc.Bj(a.Tc,
b.Tc))}equals(a){return this===a?!0:a instanceof __c.dtb?this.cells.equals(a.cells)&&this.attrs.equals(a.attrs)&&Xq.equals(this.Tc,a.Tc):!1}constructor(a,b,c,d){super(a);this.cells=b;this.attrs=c;this.Tc=d;this.id=this.mf()}};__c.dtb.prototype.vF=ba(118);var nq,etb,ftb,gtb,Lob,itb,htb,ktb,ltb,jtb;nq=class{static from(a){if(a instanceof nq)return a;if(Array.isArray(a)){const [b,c]=a;return new nq(b,c)}return new nq(a.from,a.to)}toString(){return`[${this.from},${this.to}]`}constructor(a,b){this.from=a;this.to=b}};
etb=class{get isEmpty(){return!this.Uf.size}slice(a,b){fa(0<=a&&a<=b,"invalid range: [{}, {})",a,b);const c=new Map;for(const [e,f]of this.Uf){var d=b<f.from||f.to<a?void 0:new nq(Math.max(f.from,a)-a,Math.min(f.to,b)-a);d&&c.set(e,d)}return new etb(c)}toString(){return[...this.Uf].map(([a,b])=>`"${a}":${b}`).join(",")}constructor(a=new Map){this.Uf=a}};ftb=new etb;
gtb=class{range(a,b){b?this.lca.set(a,nq.from(b)):this.lca.delete(a);return this}Uf(a){a.forEach((b,c)=>this.lca.set(c,nq.from(b)));return this}build(){return this.lca.size?new etb(this.lca):ftb}constructor(){this.lca=new Map}};Lob=class{toString(){return`${this.Kfa||"_"}->${this.Cfa||"_"}`}constructor(a,b){this.Kfa=a;this.Cfa=b}};itb=class{toString(){return`${htb[this.type]}${this.length}`}constructor(a,b){this.type=a;this.length=b}};htb={[0]:"R",[1]:"I"};
ktb=class{Ad(a,b){return new jtb(this,a,b)}toString(){const a=this.qja.join(""),b=[...this.Uf].map(([c,d])=>`"${c}":${d}`).join(",");return`{${a}|${b}}`}constructor(a,b,c,d){this.qja=a;this.Uf=b;this.pre=c;this.post=d}};ltb=new ktb([],new Map,0,0);
__c.mtb=class{append(a,b){fa(b>=0,"{} < 0",b);if(!b)return this;this.m6===a?this.length+=b:(this.m6!=null&&this.ops.push(new itb(this.m6,this.length)),this.m6=a,this.length=b);switch(a){case 0:this.pre+=b;this.post+=b;break;case 1:this.post+=b;break;default:throw new q(a);}return this}retain(a){return this.append(0,a)}insert(a){return this.append(1,a)}createRange(a,b){return this.EUa(a,void 0,b)}EUa(a,b,c){b=new Lob(b&&nq.from(b),c&&nq.from(c));this.Uf.set(a,b);return this}vwa(a){a.forEach((b,c)=>
this.Uf.set(c,b));return this}build(){const a=this.m6,b=this.length;a===0?(this.pre-=b,this.post-=b):a!=null&&this.ops.push(new itb(a,b));return this.ops.length||this.Uf.size?new ktb(this.ops,this.Uf,this.pre,this.post):ltb}constructor(){this.ops=[];this.m6=void 0;this.post=this.pre=this.length=0;this.Uf=new Map}};__c.mtb.prototype.YMa=ba(121);
jtb=class{get next(){return this._next}get gGc(){return this.IEb}get DYb(){return this.qYa}get BQa(){return this.qYa-this.IEb}wn(a,b){const c=l(this._next);ia(c.type===a,"{} != {}",c.type,a);fa(0<b&&b<=c.length,"{} \u2209 ({}, {}]",b,0,c.length);this._next=b<c.length?new itb(a,c.length-b):this.i<this.input.length?this.input[this.i++]:void 0}Yz(a){this.wn(0,a);this.IEb+=a;this.qYa+=a}Bja(a){this.wn(1,a);this.qYa+=a}finish(){ia(!this._next)}constructor(a,b=0,c=0){this.qYa=this.IEb=this.i=0;this.input=
(b=Math.max(0,b-a.pre,c-a.post))?[...a.qja,new itb(0,b)]:a.qja;this._next=this.i<this.input.length?this.input[this.i++]:void 0}};
__c.ntb=class extends Xq{rf(){return new gtb}pe(){return new __c.mtb}isIdentity(a){return!a.qja.length&&!a.Uf.size}compose(a,b){if(this.isIdentity(a))return b;if(this.isIdentity(b))return a;const c=new Map,d=new Map,e=new Map;for(var f of Mob(a.Uf,b.Uf)){var g=a.Uf.get(f),h=b.Uf.get(f);g&&h?(fa(mq(g.Cfa,h.Kfa)),e.set(f,new Lob(g.Kfa,h.Cfa))):g?c.set(f,g):h&&d.set(f,h)}f=this.pe();g=a.Ad(0,b.pre);a=b.Ad(a.post,0);b=g.next;for(h=a.next;h;){if(h.type===1)b=h.length,oq(c,void 0,g.DYb+a.BQa,b),a.Bja(b),
f.insert(b);else if(b)b.type===1?(b=Math.min(b.length,h.length),oq(d,a.gGc-g.BQa,void 0,-b),g.Bja(b),a.Yz(b),f.insert(b)):(b=Math.min(b.length,h.length),g.Yz(b),a.Yz(b),f.retain(b));else throw Error("length mismatch");b=g.next;h=a.next}g.finish();a.finish();f.vwa(e);f.vwa(c);f.vwa(d);return f.build()}transform(a,b){if(this.isIdentity(a)||this.isIdentity(b))return Cp(b,a);var c=new Map,d=new Map;const e=new Map,f=Bp.Oq();for(var g of Mob(a.Uf,b.Uf)){var h=a.Uf.get(g),k=b.Uf.get(g);h&&k?(fa(mq(h.Kfa,
k.Kfa)),e.set(g,new Lob(k.Cfa,h.Cfa)),Vmb(f)):h?c.set(g,h):k&&d.set(g,k)}h=a.Ad(b.pre,0);k=b.Ad(a.pre,0);g=this.pe();const m=this.pe();var n=h.next;let p=k.next;for(;n||p;){if(n&&n.type===1)n=n.length,oq(d,k.gGc+h.BQa,k.DYb+h.BQa,n),h.Bja(n),m.retain(n),g.insert(n);else if(p&&p.type===1)n=p.length,oq(c,h.gGc+k.BQa,h.DYb+k.BQa,n),oq(e,void 0,h.DYb+k.BQa,n),k.Bja(n),m.insert(n),g.retain(n);else if(n&&p)n=Math.min(n.length,p.length),h.Yz(n),k.Yz(n),m.retain(n),g.retain(n);else throw Error(`unreachable case: ${n} x ${p}`);
n=h.next;p=k.next}h.finish();k.finish();d=m.vwa(d).build();c=g.vwa(c).vwa(e).build();Rn(d.post-d.pre,b.post-b.pre);Rn(c.post-c.pre,a.post-a.pre);return f.build(d,c)}xl(a){if(!a.Uf.size)return ltb;const b=new Map(a.Uf);Iob(a,{insert:(c,d,e)=>oq(b,e,void 0,c)});a=gh(b,c=>new Lob(c.Cfa,c.Kfa));return new ktb([],a,0,0)}wk(a,b){if(a===b)return!0;if(a.qja.length!==b.qja.length||a.Uf.size!==b.Uf.size)return!1;for(let e=0;e<a.qja.length;e++){var c=a.qja[e],d=b.qja[e];if(c.type!==d.type||c.length!==d.length)return!1}for(const e of a.Uf.keys())if(c=
a.Uf.get(e),d=b.Uf.get(e),c?!(d&&mq(c.Kfa,d.Kfa)&&mq(c.Cfa,d.Cfa)):d)return!1;return!0}id(){return ltb}identity(){return ltb}apply(a,b){if(this.isIdentity(b)||!a.Uf.size&&!b.Uf.size)return a;const c=this.rf(),d=new Map(a.Uf);for(const [e,f]of b.Uf)fa(mq(a.Uf.get(e),f.Kfa)),d.delete(e),c.range(e,f.Cfa);Iob(b,{insert:(e,f,g)=>Kob(d,g,e)});return sq(this.qe,a,c.Uf(d).build())}Nl(a,b){if(this.isIdentity(b)||!a.Uf.size&&!b.Uf.size)return a;const c=this.rf(),d=new Map(a.Uf);for(const [e,f]of b.Uf)fa(mq(a.Uf.get(e),
f.Cfa)),d.delete(e),c.range(e,f.Kfa);Iob(b,{insert:(e,f)=>Kob(d,f,-e)});return sq(this.qe,a,c.Uf(d).build())}hg(a){if(a instanceof etb)return a;const b=this.rf();for(const [c,d]of a.Uf)b.range(c,[d.from,d.to]);return b.build()}Bj(a,b){const c=a.Uf,d=b.Uf;return a===b||c===d?!0:c.size===d.size&&[...c.keys()].every(e=>mq(c.get(e),d.get(e)))}equals(a){return this===a||a instanceof __c.ntb}constructor(...a){super(...a);this.O_=ftb}};__c.ntb.prototype.vF=ba(117);var otb=class extends Xq{mf(a){return{rows:a.rows||this.rows.pe().build(),cols:a.cols||this.cols.pe().build(),aq:a.aq||this.gn.pe().build().lm,bq:a.bq||this.Kl.pe().build().Uf,gp:a.gp||this.gn.pe().build().lm,Mp:a.Mp||this.Kl.pe().build().Uf,cells:a.cells||qq(this,this.cells.mf({}),this.cols.pe().build(),this.rows.pe().build()),attrs:a.attrs||qq(this,this.attrs.mf({}),this.cols.pe().build(),this.rows.pe().build())}}isIdentity(a){return this.rows.isIdentity(a.rows)&&this.cols.isIdentity(a.cols)&&a.aq.size===
0&&a.bq.size===0&&a.gp.size===0&&a.Mp.size===0&&a.cells.cells.isEmpty&&this.cells.kB.isIdentity(a.cells.kB)&&a.attrs.attrs.items.isEmpty()}compose(a,b){const c=pq(this,a.cols),d=pq(this,a.rows),e=pq(this,b.cols),f=pq(this,b.rows),g=this.rows.compose(a.rows,b.rows),h=this.cols.compose(a.cols,b.cols),k=this.gn.compose(this.gn.mf(d,a.aq),this.gn.mf(f,b.aq)).lm,m=this.Kl.compose(this.Kl.mf(d,a.bq),this.Kl.mf(f,b.bq)).Uf,n=this.gn.compose(this.gn.mf(c,a.gp),this.gn.mf(e,b.gp)).lm,p=this.Kl.compose(this.Kl.mf(c,
a.Mp),this.Kl.mf(e,b.Mp)).Uf,t=this.cells.compose(this.cells.mf({...a.cells,x:c,y:d}),this.cells.mf({...b.cells,x:e,y:f}));a=this.attrs.compose(this.attrs.mf({...a.attrs,x:c,y:d}),this.attrs.mf({...b.attrs,x:e,y:f}));return{rows:g,cols:h,aq:k,bq:m,gp:n,Mp:p,cells:qq(this,t,h,g),attrs:qq(this,a,h,g)}}transform(a,b){const c=pq(this,a.cols),d=pq(this,a.rows),e=pq(this,b.cols),f=pq(this,b.rows),g=Bp.Oq(),{Rt:h,uu:k}=Fp(g,this.rows.transform(a.rows,b.rows)),{Rt:m,uu:n}=Fp(g,this.cols.transform(a.cols,
b.cols)),{Rt:{lm:p},uu:{lm:t}}=Fp(g,this.gn.transform(this.gn.mf(d,a.aq),this.gn.mf(f,b.aq))),{Rt:{Uf:v},uu:{Uf:x}}=Fp(g,this.Kl.transform(this.Kl.mf(d,a.bq),this.Kl.mf(f,b.bq))),{Rt:{lm:z},uu:{lm:B}}=Fp(g,this.gn.transform(this.gn.mf(c,a.gp),this.gn.mf(e,b.gp))),{Rt:{Uf:C},uu:{Uf:D}}=Fp(g,this.Kl.transform(this.Kl.mf(c,a.Mp),this.Kl.mf(e,b.Mp))),{Rt:F,uu:I}=Fp(g,this.cells.transform(this.cells.mf({...a.cells,x:c,y:d}),this.cells.mf({...b.cells,x:e,y:f}))),{Rt:K,uu:M}=Fp(g,this.attrs.transform(this.attrs.mf({...a.attrs,
x:c,y:d}),this.attrs.mf({...b.attrs,x:e,y:f})));a={rows:h,cols:m,aq:p,bq:v,gp:z,Mp:C,cells:qq(this,F,m,h),attrs:qq(this,K,m,h)};b={rows:k,cols:n,aq:t,bq:x,gp:B,Mp:D,cells:qq(this,I,n,k),attrs:qq(this,M,n,k)};return g.build(a,b)}xl(a){const b=pq(this,a.cols),c=pq(this,a.rows),d=this.rows.xl(a.rows),e=this.cols.xl(a.cols),f=this.gn.xl(this.gn.mf(c,a.aq)).lm,g=this.Kl.xl(this.Kl.mf(c,a.bq)).Uf,h=this.gn.xl(this.gn.mf(b,a.gp)).lm,k=this.Kl.xl(this.Kl.mf(b,a.Mp)).Uf,m=this.cells.xl({...a.cells,x:b,y:c});
a=this.attrs.xl(this.attrs.mf({...a.attrs,x:b,y:c}));return{rows:d,cols:e,aq:f,bq:g,gp:h,Mp:k,cells:qq(this,m,e,d),attrs:qq(this,a,e,d)}}wk(a,b){return this.rows.wk(a.rows,b.rows)&&this.cols.wk(a.cols,b.cols)&&this.gn.wk(this.gn.mf(this.axis.identity(),a.aq),this.gn.mf(this.axis.identity(),b.aq))&&this.Kl.wk(this.Kl.mf(this.axis.identity(),a.bq),this.Kl.mf(this.axis.identity(),b.bq))&&this.gn.wk(this.gn.mf(this.axis.identity(),a.gp),this.gn.mf(this.axis.identity(),b.gp))&&this.Kl.wk(this.Kl.mf(this.axis.identity(),
a.Mp),this.Kl.mf(this.axis.identity(),b.Mp))&&this.cells.wk(this.cells.mf(a.cells),this.cells.mf(b.cells))&&this.attrs.wk(this.attrs.mf(a.attrs),this.attrs.mf(b.attrs))}identity(a){return{rows:this.rows.identity(a.rows),cols:this.cols.identity(a.cols),aq:this.gn.identity(a.aq).lm,bq:this.Kl.identity(a.bq).Uf,gp:this.gn.identity(a.gp).lm,Mp:this.Kl.identity(a.Mp).Uf,cells:this.cells.identity(a.cells),attrs:this.attrs.identity(a.attrs)}}apply(a,b){if(this.isIdentity(b))return a;const c=pq(this,b.cols),
d=pq(this,b.rows),e=this.rows.apply(a.rows,b.rows),f=this.cols.apply(a.cols,b.cols),g=this.gn.apply(a.aq,this.gn.mf(d,b.aq)),h=this.Kl.apply(a.bq,this.Kl.mf(d,b.bq)),k=this.gn.apply(a.gp,this.gn.mf(c,b.gp)),m=this.Kl.apply(a.Mp,this.Kl.mf(c,b.Mp)),n=this.cells.apply(a.cells,{...b.cells,x:c,y:d});b=this.attrs.apply(a.attrs,this.attrs.mf({...b.attrs,x:c,y:d}));return sq(this.qe,a,Object.freeze({rows:e,cols:f,aq:g,bq:h,gp:k,Mp:m,cells:n,attrs:b}))}Nl(a,b){if(this.isIdentity(b))return a;const c=pq(this,
b.cols),d=pq(this,b.rows),e=this.rows.Nl(a.rows,b.rows),f=this.cols.Nl(a.cols,b.cols),g=this.gn.Nl(a.aq,this.gn.mf(d,b.aq)),h=this.Kl.Nl(a.bq,this.Kl.mf(d,b.bq)),k=this.gn.Nl(a.gp,this.gn.mf(c,b.gp)),m=this.Kl.Nl(a.Mp,this.Kl.mf(c,b.Mp)),n=this.cells.Nl(a.cells,{...b.cells,x:c,y:d});b=this.attrs.Nl(a.attrs,this.attrs.mf({...b.attrs,x:c,y:d}));return sq(this.qe,a,Object.freeze({rows:e,cols:f,aq:g,bq:h,gp:k,Mp:m,cells:n,attrs:b}))}hg(a){return Object.freeze({rows:this.rows.hg(a.rows),cols:this.cols.hg(a.cols),
aq:this.gn.hg(a.aq),bq:this.Kl.hg(a.bq),gp:this.gn.hg(a.gp),Mp:this.Kl.hg(a.Mp),cells:this.cells.hg(a.cells),attrs:this.attrs.hg(a.attrs)})}Bj(a,b){return a===b?!0:this.rows.Bj(a.rows,b.rows)&&this.gn.Bj(a.aq,b.aq)&&this.Kl.Bj(a.bq,b.bq)&&this.gn.Bj(a.gp,b.gp)&&this.Kl.Bj(a.Mp,b.Mp)&&this.cols.Bj(a.cols,b.cols)&&this.cells.Bj(a.cells,b.cells)&&this.attrs.Bj(a.attrs,b.attrs)}equals(a){return this===a?!0:a instanceof otb?this.rows.equals(a.rows)&&this.cols.equals(a.cols)&&this.cells.equals(a.cells)&&
this.attrs.equals(a.attrs):!1}constructor(a,b,c,d,e,f,g,h){super(a);this.rows=b;this.cols=c;this.cells=d;this.attrs=e;this.axis=f;this.Kl=g;this.gn=h}};var ptb=class extends Xq{isIdentity(a){return this.base.isIdentity(a)}compose(a,b){const c=Nob(a.key,b.key);return{key:c,value:this.components[c].compose(a.value,b.value)}}transform(a,b){const c=Nob(a.key,b.key);a=this.components[c].transform(a.value,b.value);return Umb(a,d=>({key:c,value:d}))}xl(a){return{key:a.key,value:this.components[a.key].xl(a.value)}}wk(a,b){return a.key===b.key&&this.components[a.key].wk(a.value,b.value)}identity(a){return{key:a.key,value:this.components[a.key].identity(a.value)}}apply(a,
b){const c=Nob(a.key,b.key);return sq(this.qe,a,Object.freeze({key:c,value:this.components[c].apply(a.value,b.value)}))}Nl(a,b){const c=Nob(a.key,b.key);return sq(this.qe,a,Object.freeze({key:c,value:this.components[c].Nl(a.value,b.value)}))}hg(a){return Object.freeze({key:a.key,value:this.components[a.key].hg(a.value)})}Bj(a,b){return a===b?!0:a.key===b.key&&this.components[a.key].Bj(a.value,b.value)}equals(a){if(this===a)return!0;const b=this.components,c=a.components;a=Object.keys(b);const d=Object.keys(c);
return a.length===d.length&&a.every(e=>e in c&&b[e].equals(c[e]))}constructor(a,b,c){super(a);this.components=b;this.base=c}};var qtb=class extends Xq{isIdentity(a){return this.sum.isIdentity(a)}compose(a,b){return this.sum.compose(a,b)}transform(a,b){return this.sum.transform(a,b)}xl(a){return this.sum.xl(a)}wk(a,b){return this.sum.wk(a,b)}identity(a){return this.sum.identity(rq(this,a))}apply(a,b){var c=this.qe;b=this.sum.apply(rq(this,a),b).value;return sq(c,a,b)}Nl(a,b){var c=this.qe;b=this.sum.Nl(rq(this,a),b).value;return sq(c,a,b)}hg(a){return this.sum.hg(rq(this,a)).value}Bj(a,b){return a===b||this.sum.Bj(rq(this,
a),rq(this,b))}equals(a){return this===a||a instanceof qtb&&this.sum.equals(a.sum)}constructor(a,b,c){super(a);this.sum=b;this.VAa=c}};var rtb=class extends Xq{isIdentity(){return!0}compose(){return 1}transform(){return Cp(1,1)}xl(){return 1}wk(){return!0}identity(){return 1}apply(){return 1}Nl(){return 1}hg(){return 1}Bj(){return!0}equals(a){return this===a||a instanceof rtb}constructor(...a){super(...a);this.unit=1}};var stb=class extends Wq{isIdentity(){return!0}};var ttb=class extends Xq{isIdentity(a){return this.base.isIdentity(a)}compose(){}transform(){return Cp()}xl(){}wk(){return!0}identity(){}apply(a){return a}Nl(a){return a}hg(a){return this.copy(a)}Bj(a,b){return this.Fu(a,b)}equals(a){return this===a}constructor(a,b,c){super(a);this.Fu=b;this.copy=c;this.base=new stb}};var utb=class extends Wq{isIdentity(a){return this.components[a.key].isIdentity(a.value)}constructor(a){super();this.components=a}};var vtb=class{isIdentity(a){const b=typeof a;switch(b){case "bigint":case "function":case "symbol":throw Error(`unexpected type ${b}`);case "boolean":case "number":case "string":case "undefined":return!0;case "object":return a==null;default:throw new q(b);}}get(a){if(this.isIdentity(a))return a;let b=this.Vob.get(a);b==null&&(b=Symbol(),this.Vob.set(a,b));return b}constructor(){this.Vob=new WeakMap}};var wtb=new vtb;fr=__c.fr=class{snapshot(){if(this.hza==null&&hrb()){const a=erb("");this.hza=a;grb(this.hza,()=>{ia(this.hza===a);this.hza=void 0})}this.hza&&this.hza.reportObserved();this.sYa==null&&(this.sYa=frb(()=>this.sW()),sq(this.qe,this,this.sYa));return this.sYa}Bm(a){this.oN&&this.apply(a)}destroy(a){this.bv(a);this.oN&&(this.oN=void 0,Pob(this,"mutable disconnected"))}QR(a){ia(this.oN!=null,"mutable not connected");Oob(this);Qob(this,a);this.oN.QR(a)}onError(a){this.oN&&(this.oN.onError(a),this.oN=void 0,
Pob(this,"mutable failure"))}apply(a){ia(this.oN!=null,"mutable not connected");try{this.I2(a),this.domain.isIdentity(a)||Oob(this)}catch(b){throw this.onError(b),b;}Qob(this,a)}Eu(a){this.apply(a);this.domain.isIdentity(a)||this.oN?.QR(a)}constructor(a,b,c,d){this.qe=a;this.context=b;this.clients=this.oN=void 0;this.oN=d;this.sYa=c;sq(this.qe,this.sYa,this)}};fr.prototype.uM=ba(130);var gr=class{get(){this.reportObserved();return this.value}reportObserved(){this.oT||!hrb()?this.oT?.reportObserved():(this.oT=erb(""),this.oT.reportObserved(),grb(this.oT,()=>this.oT=void 0))}set(a){fpb.identity(this.value,a)||(this.value=a,this.oT?.reportChanged())}constructor(a){this.value=a;this.oT=void 0}};var xtb=class{static C(a){hb(a,{LJc:Uq,Afc:Uq})}get er(){return this.cols.length}get eC(){return this.rows.length}get LJc(){const a=new Map;this.rows.forEach((b,c)=>a.set(b,c));return a}get Afc(){const a=new Map;this.cols.forEach((b,c)=>a.set(b,c));return a}get(a,b){a=this.rows[a];b=this.cols[b];if(a!=null&&b!=null){var c=this.values.get(this.A2(a,b));c==null&&hrb()&&(c=new gr,this.values.set(this.A2(a,b),c));return c?.get()}}set(a,b,c){a=Rob(this,a);b=Sob(this,b);const d=this.values.get(this.A2(a,
b));d?d.set(c):this.values.set(this.A2(a,b),new gr(c))}delete(a,b){a=this.rows[a];b=this.cols[b];a!=null&&b!=null&&(this.values.get(this.A2(a,b))?.set(void 0),this.values.delete(this.A2(a,b)))}forEach(a){for(const c of this.rows)for(const d of this.cols){var b=this.values.get(this.A2(c,d));b!=null&&(b=b.get(),b!=null&&a(b,c,d))}}A2(a,b){return`${a}:${b}`}constructor(){this.p_e=(xtb.C(this),0);this.m_e=0;this.rows=Vq.array([],{deep:!1});this.cols=Vq.array([],{deep:!1});this.values=new Map}};var uq,Gq,Xob,ytb,Yob,Upb,aqb,Zpb,Qpb,$pb,Zob,apb,cpb,dpb,ipb,gpb,ztb;uq=Object.freeze({serialize:a=>a,deserialize:a=>a});Gq=Object.freeze({serialize(){throw Error("serialization not implemented");},deserialize(){throw Error("serialization not implemented");}});Xob=class{serialize(a){return this.b.serialize(this.a.serialize(a))}deserialize(a){return this.a.deserialize(this.b.deserialize(a))}constructor(a,b){this.a=a;this.b=b}};
ytb=class{get serializer(){this.xZc==null&&(this.xZc=this.CHe());return this.xZc}serialize(a){return this.serializer.serialize(a)}deserialize(a){return this.serializer.deserialize(a)}constructor(a){this.CHe=a}};Yob=class{serialize(){return this.to}deserialize(){return this.from}constructor(a,b){this.from=a;this.to=b}};Upb=class{serialize(a){return this.wgf[a]}deserialize(a){return this.Jse.get(a)}constructor(a,b){this.wgf=a;this.Jse=b}};
aqb=class{serialize(a){return a.map(b=>this.serializer.serialize(b))}deserialize(a){return a.map(b=>this.serializer.deserialize(b))}constructor(a){this.serializer=a}};Zpb=Object.freeze({serialize(a){let b=0,c=0;const d=__c.Vob(a),e=[];a.forEach((f,g)=>{if(f=g-c)b&&(e.push(b),b=0),e.push(-f);b++;c=g+1});return[d,e]},deserialize([a,b]){const c=[];let d=0;for(const e of b)e<0?d+=-e:e>0&&(a.slice(0,e).forEach(f=>c[d++]=f),a=a.slice(e));a.length&&a.forEach(e=>c[d++]=e);return c}});
Qpb=class{serialize(a){return Rmb(a,(b,c)=>[this.hqd.serialize(b),this.wTd.serialize(c)])}deserialize(a){return Rmb(a,(b,c)=>[this.hqd.deserialize(b),this.wTd.deserialize(c)])}constructor(a,b){this.hqd=a;this.wTd=b}};$pb=class{serialize([a,b]){return[this.$Id.serialize(a),this.aJd.serialize(b)]}deserialize([a,b]){return[this.$Id.deserialize(a),this.aJd.deserialize(b)]}constructor(a){this.$Id=a;this.aJd=uq}};
Zob=class{serialize(a){return tq(this.wgd,(b,c)=>b.serialize(a[c]))}deserialize(a){return tq(this.wgd,(b,c)=>b.deserialize(a[c]))}constructor(a){this.wgd=a}};apb=class{serialize(a){return this.Dx[this.kue(a)].serialize(a)}deserialize(a){return this.Dx[this.jue(a)].deserialize(a)}constructor(a,b,c){this.Dx=a;this.kue=b;this.jue=c}};
cpb=class{serialize(a){return a!=null?this.serializer.serialize(a):this.defaultValue}deserialize(a){return a!==this.defaultValue?this.serializer.deserialize(a):void 0}constructor(a,b){this.serializer=a;this.defaultValue=b}};dpb=class{serialize(a){return this.construct(a)}deserialize(a){return a}constructor(a){this.construct=a}};ipb=Object.freeze({serialize:a=>a,deserialize:a=>new zpb(a.delta)});gpb=Object.freeze({serialize:a=>a,deserialize:a=>new Qrb(a.oldState,a.newState)});
__c.Rpb=Object.freeze({serialize:a=>({ops:a}),deserialize:a=>a.ops});ztb=class{serialize(a){return a.value}deserialize(a){return{key:this.key,value:a}}constructor(a){this.key=a}};var Ctb=class{get mutable(){this.Jj.eld||(this.etb=this.Jj.DMd,this.Jj=new Atb(this.context,this.context.metrics?.SSe,this.LI,frb(()=>this.Jj.snapshot()),this,ppb));return this.Jj.mutable}snapshot(){return this.Jj.snapshot()}Bm(a){mpb(this);this.Jj.Bm(a)}destroy(a){this.Jj.destroy(a);this.context.metrics?.cxc.J5c(this)}QR(a){mpb(this);this.UBa.QR(this.Epb(a))}onError(a){this.UBa.onError(a)}constructor(a,b,c,d,e,f){this.context=a;this.LI=c;this.UBa=e;this.Epb=f;this.etb=void 0;this.Jj=new Btb(b,d);
a.metrics?.cxc.g8c(this)}},Ftb=class{get mutable(){let a=this.Esb?.deref();a==null&&(this.etb=this.wxa.DMd,a=new Atb(this.context,this.context.metrics?.SSe,this.LI,frb(()=>this.wxa.snapshot()),this,ppb),this.Esb=a.mutable==null||typeof a.mutable!=="object"?new Dtb(a):new this.WeakRef(a));return a.mutable}snapshot(){var a=this.Esb?.deref();return a!=null?(a=a.snapshot(),this.wxa.setState(a),a):this.wxa.snapshot()}Bm(a){mpb(this);const b=this.Esb?.deref();b!=null?(npb(this.wxa,a),b.Bm(a)):this.wxa.Bm(a)}destroy(a){this.Esb?.deref()?.destroy(a);
this.wxa.destroy(a);this.context.metrics?.cxc.J5c(this)}QR(a){mpb(this);npb(this.wxa,a);this.UBa.QR(this.Epb(a))}onError(a){this.UBa.onError(a)}constructor(a,b,c,d,e,f,g=globalThis.WeakRef){this.context=a;this.LI=c;this.UBa=e;this.Epb=f;this.WeakRef=g;this.etb=this.Esb=void 0;this.wxa=new Btb(b,d);this.wxa[Etb]=this;a.metrics?.cxc.g8c(this)}},Atb=class{snapshot(){return this.mutable.snapshot()}Bm(a){this.mutable.Bm(a)}destroy(a){this.mutable.destroy(a);this.metric?.J5c(this)}QR(a){this.UBa.QR(this.Epb(a))}onError(a){this.UBa.onError(a)}get eld(){return!0}constructor(a,
b,c,d,e,f){this.metric=b;this.UBa=e;this.Epb=f;this.mutable=c(a,d,this);this.metric?.g8c(this)}},Gtb=class extends Atb{},Btb=class{get state(){opb(this);return this.j7}setState(a){this.j7=a;this.UMa=void 0}snapshot(){this.oT==null&&hrb()&&(this.oT=erb(""),this.oT[Etb]=this);this.oT?.reportObserved();return this.state}get DMd(){return this.oT}Bm(a){npb(this,a);opb(this)}destroy(a){Ap(this.domain,this.state,a)}get eld(){return!1}constructor(a,b){this.domain=a;this.UMa=this.oT=void 0;this.j7=b}},Dtb=
class{deref(){return this.value}constructor(a){this.value=a}},Etb=Symbol("parentRef");var qpb=Symbol();var Htb;Htb={QR:()=>{},onError:()=>{}};__c.Itb=class{QR(a){this.closed||this.o.QR(this.f(a))}onError(a){this.closed||(this.closed=!0,this.o.onError(a))}constructor(a,b){this.o=a;this.f=b;this.closed=!1}};__c.Jtb=class{$Ib(a,b,c){const d=rpb(this,a,c??Htb);b?.subscribe({next:e=>d.Bm(e),complete:()=>d.destroy(d.snapshot())});return d.mutable}create(a){return this.$Ib(a,void 0,Htb)}hg(a){return this.domain.hg(a)}};__c.Jtb.prototype.uM=ba(129);hr=__c.hr=class extends __c.Jtb{p6b(a){return this.ss(a,this.al)}map(a,b,c,d,e,f){c=spb(c);d=spb(d);return new __c.Ktb(this,a,b,c,d,e,f,vq({serialize:b,deserialize:a},this.MK),vq({serialize:d,deserialize:c},this.al))}constructor(a,b){super();this.MK=a;this.al=b}};
hr.prototype.lx=ba(135);ir=__c.ir=class extends hr{Mu(a,b,c,d,e){const f=e?.fmd||"eager";switch(f){case "eager":return new Gtb(a,a.metrics?.Idg,this.LI,b,c,d);case "lazy":return new Ctb(a,this.domain,this.LI,b,c,d);case "transient":return new Ftb(a,this.domain,this.LI,b,c,d,e?.WeakRef);default:throw new q(f);}}snapshot(a){return a.snapshot()}};ir.prototype.uM=ba(128);
__c.Ktb=class extends hr{Mu(a,b,c,d,e){c=new __c.Itb(c,d);a=this.component.Mu(a,this.O7(b),c,this.MX,e);return new Ltb(a,this.QS,this.Ns,this.O7,this.Ar)}snapshot(a){return this.Ns(this.component.snapshot(this.TRc(a)))}ss(a,b){return new __c.Ktb(this.component,this.MX,this.QS,this.Ns,this.O7,this.Ar,this.TRc,a,b)}constructor(a,b,c,d,e,f,g,h,k){super(h,k);this.component=a;this.MX=b;this.QS=c;this.Ns=d;this.O7=e;this.Ar=f;this.TRc=g;this.domain=this.component.domain.map(this.MX,this.QS,this.Ns,this.O7)}};
__c.Ktb.prototype.uM=ba(127);var Ltb=class{get mutable(){return this.Ar(this.tGb.mutable)}destroy(a){this.tGb.destroy(this.O7(a))}Bm(a){this.tGb.Bm(this.QS(a))}snapshot(){return this.Ns(this.tGb.snapshot())}constructor(a,b,c,d,e){this.tGb=a;this.QS=b;this.Ns=c;this.O7=d;this.Ar=spb(e)}};var Mtb=class extends fr{get er(){return this.grid.er}get eC(){return this.grid.eC}get(a,b,c){b=this.grid.get(b,c);if(b!=null&&(a=this.Df.v6(a,b),Object.keys(a).length!==0))return a}set(a,b,c){const {Glf:d,slf:e,hMb:f=d,Tze:g=e}=b;b=new Set;const h=Kp(this.domain);h.rows(d);for(let n=d;n<=f;n++){const p=h.iy();p.GD(e);for(let t=e;t<=g;t++){var k=this.grid.get(n,t);k=tpb(this,a,k,c);for(const v of b)p.Vc(v,void 0);p.attrs(k);for(const v of Object.keys(k))b.add(v);p.GD(1)}for(const t of b)p.Vc(t,void 0);
p.finish();h.rows(1)}a=h.iy();a.GD(e);for(c=e;c<=g;c++){for(var m of b)a.Vc(m,void 0);a.GD(1)}for(const n of b)a.Vc(n,void 0);a.finish();m=this.domain.mf({attrs:h.build()});this.Eu(m)}sW(){const a=this.domain.rf();for(let b=0;b<=this.eC;b++){const c=a.iy();let d={};for(let e=0;e<=this.er;e++){const f=this.grid.get(b,e);for(const g of wpb(d,f))c.Vc(g,f?.[g]);d=f;c.GD(1)}c.finish();a.rows(1)}return a.build()}bv(a){const b=this.snapshot();Ap(this.domain,b,a)}I2(a){this.Ibc(a.x);this.Jbc(a.y);vpb(this,
a.attrs)}Ibc(a){if(a.pre!==0||a.post!==0){var b=0;a=a.Ad();for(var c=a.head;c;)c.type===0?b+=a.Yz(c.length):(c=Hp(a,c.length),Tob(this.grid,b,c),b+=c),c=a.head}}Jbc(a){let b=0;a=a.Ad();for(var c=a.head;c;)c.type===0?b+=a.Yz(c.length):(c=Hp(a,c.length),Uob(this.grid,b,c),b+=c),c=a.head}write(a,b,c){c==null||Object.keys(c).length===0?this.grid.delete(a,b):this.grid.set(a,b,c)}constructor(a,b,c,d,e,f){super(a,b,e,f);this.Df=c;this.domain=d;this.grid=new xtb;gnb(e,c.JC,(g,h,k)=>{this.grid.set(h,k,g)});
Ap(this.domain,e,this.sW())}},xpb=class extends ir{rf(){return this.domain.rf()}hg(a){return this.domain.hg(a,b=>this.Df.JC(b))}ss(a,b){return new xpb(this.qe,this.domain,this.Df,a,b)}constructor(a,b,c,d,e){super(d,e);this.qe=a;this.domain=b;this.Df=c;this.LI=(f,g,h)=>new Mtb(this.qe,f,this.Df,this.domain,g,h)}};var Ntb=class extends fr{I2(a){if(a!=null)switch(a.type){case 1:fa(this.uTc.Fu(this._value.get(),a.oldState));this._value.set(a.newState);break;case 0:fa(a.delta==null);break;default:throw new q(a);}}get value(){return this._value.get()}set value(a){this.uTc.KLa(a);const b=this._value.get();this.Eu(this.domain.replace(b,this.uTc.hg(a)))}sW(){return this.value}bv(a){Ap(this.domain,this.value,a)}constructor(a,b,c,d,e,f){super(a,b,e,f);this.uTc=c;this.domain=d;this._value=new gr(e)}},Bpb=class extends ir{ss(a,
b){return new Bpb(this.qe,this.domain,this.type,a,b)}constructor(a,b,c,d,e){super(d,e);this.qe=a;this.domain=b;this.type=c;this.LI=(f,g,h)=>new Ntb(this.qe,f,this.type,this.domain,g,h)}},Otb=class extends Ntb{get value(){return super.value}set value(a){throw Error("Attribute is unmodifiable");}},Dpb=class extends Bpb{ss(a,b){return new Dpb(this.qe,this.domain,this.type,a,b)}constructor(...a){super(...a);this.LI=(b,c,d)=>new Otb(this.qe,b,this.type,this.domain,c,d)}},Ptb=class extends fr{Kg(a){this.Jj.set(this.type.Mu(this.context,
a,this,Apb))}I2(a){if(a!=null)switch(a.type){case 0:this.Jj.get().Bm(a.delta);break;case 1:var b=a.oldState;this.Jj.get().destroy(b);this.Kg(a.newState);break;default:throw Error();}}sW(){return this.Jj.get().snapshot()}bv(a){this.Jj.get().destroy(a)}get ref(){return this.Jj.get().mutable}set(a){this.Eu(new Qrb(this.Jj.get().snapshot(),this.type.hg(a)))}constructor(a,b,c,d,e,f){super(a,b,e,f);this.type=c;this.domain=d;this.Jj=new gr(this.type.Mu(b,e,this,Apb))}},Cpb=class extends ir{ss(a,b){return new Cpb(this.qe,
this.domain,this.type,a,b)}constructor(a,b,c,d,e){super(d,e);this.qe=a;this.domain=b;this.type=c;this.LI=(f,g,h)=>new Ptb(this.qe,f,this.type,this.domain,g,h)}};var Qtb=class extends fr{get(a,b){a=this.grid.get(a,b);if(a!=null)return{span:a.span,ref:a.Jj.mutable}}forEach(a){this.grid.forEach((b,c,d)=>{b.JQa.left===d&&b.JQa.top===c&&a(b.Jj.mutable,b.span)})}set(a,b){b=(new Up).add(a.left,a.top,this.domain.replace(void 0,{right:a.right,bottom:a.bottom,state:this.type.hg(b)})).build();this.Eu(this.domain.compose(Fpb(this,a),this.domain.mf({cells:b})));return l(this.get(a.top,a.left))}delete(a){this.Eu(Fpb(this,a))}cjb(a,b,c){ia(a.span.left===c.left);ia(a.span.top===
c.top);ia(a.span.right===c.right);ia(a.span.bottom===c.bottom);for(let d=c.top;d<=c.bottom;d++)for(let e=c.left;e<=c.right;e++)ia(this.grid.get(d,e)===a),this.grid.delete(d,e);a.Jj.destroy(b)}I2(a){this.Ibc(a.x);this.Jbc(a.y);a.cells.forEach((b,c,d)=>{switch(d.type){case 1:var e=l(this.grid.get(c,b));d.delta&&e.Jj.Bm(d.delta);if(d.bounds){ia(e.span.left===b&&e.span.top===c);const h=d.bounds.o;var f=d.bounds.n;ia(e.span.right===h.right&&e.span.bottom===h.bottom);if(h.right!==f.right||h.bottom!==f.bottom){d=
Math.min(h.right,f.right);f=Math.min(h.bottom,f.bottom);for(var g=f+1;g<=h.bottom;g++)for(let k=b;k<=h.right;k++)ia(this.grid.get(g,k)===e),this.grid.delete(g,k);for(b=d+1;b<=h.right;b++)for(g=c;g<=f;g++)ia(this.grid.get(g,b)===e),this.grid.delete(g,b);e.JQa.right=Sob(this.grid,d);e.JQa.bottom=Rob(this.grid,f)}}break;case 0:d.o&&(e=l(this.grid.get(c,b)),this.cjb(e,d.o.state,{left:b,top:c,right:d.o.right,bottom:d.o.bottom}));break;default:throw new q(d);}});a.cells.forEach((b,c,d)=>{switch(d.type){case 1:if(d.bounds){const g=
l(this.grid.get(c,b));var e=d.bounds.o;d=d.bounds.n;var f=Math.min(e.right,d.right);e=Math.min(e.bottom,d.bottom);for(let h=e+1;h<=d.bottom;h++)for(let k=b;k<=d.right;k++)ia(this.grid.get(h,k)==null),this.grid.set(h,k,g);for(b=f+1;b<=d.right;b++)for(f=c;f<=e;f++)ia(this.grid.get(f,b)==null),this.grid.set(f,b,g);g.JQa.right=Sob(this.grid,d.right);g.JQa.bottom=Rob(this.grid,d.bottom)}break;case 0:d.n&&Jpb(this,d.n.state,{left:b,top:c,right:d.n.right,bottom:d.n.bottom});break;default:throw new q(d);
}})}Ibc(a){if(a.pre!==0||a.post!==0){var b=0;a=a.Ad();for(var c=a.head;c;)c.type===0?b+=a.Yz(c.length):(c=Hp(a,c.length),Tob(this.grid,b,c,d=>d.span.right!==b-1),b+=c),c=a.head}}Jbc(a){let b=0;a=a.Ad();for(var c=a.head;c;)c.type===0?b+=a.Yz(c.length):(c=Hp(a,c.length),Uob(this.grid,b,c,d=>d.span.bottom!==b-1),b+=c),c=a.head}sW(){const a=this.domain.rf();for(let b=0;b<this.grid.eC;b++)for(let c=0;c<this.grid.er;c++){const d=this.grid.get(b,c);d!=null&&d.span.top===b&&d.span.left===c&&a.add(d.span,
d.Jj.snapshot())}return a.build()}bv(a){let b=0,c=0;a.forEach(()=>c++);for(let d=0;d<this.grid.eC;d++)for(let e=0;e<this.grid.er;e++){const f=this.grid.get(d,e);if(f==null||f.span.top!==d||f.span.left!==e)continue;const g=l(a.get(f.span.left,f.span.top));ia(g.span.right===f.span.right&&g.span.bottom===f.span.bottom);f.Jj.destroy(g.state);b++}ia(c===b)}constructor(a,b,c,d,e,f){super(a,b,e,f);this.type=c;this.domain=d;this.grid=new xtb;e.forEach((g,h)=>{Jpb(this,g,h)})}},Ipb=class{get span(){return this.JQa.dAd.get()}constructor(a,
b){this.Jj=a;this.JQa=b}},Hpb=class{get right(){return this.uZc.get()}set right(a){this.uZc.set(a)}get bottom(){return this.eZc.get()}set bottom(a){this.eZc.set(a)}constructor(a,b){this.KQb=a;this.dAd=Uq(()=>({left:l(this.KQb.Afc.get(this.left)),top:l(this.KQb.LJc.get(this.top)),right:l(this.KQb.Afc.get(this.right)),bottom:l(this.KQb.LJc.get(this.bottom))}),{equals:fpb.structural});this.left=b.left;this.top=b.top;this.uZc=new gr(b.right);this.eZc=new gr(b.bottom)}},Kpb=class extends ir{ss(a,b){return new Kpb(this.qe,
this.domain,this.type,a,b)}constructor(a,b,c,d,e){super(d,e);this.qe=a;this.domain=b;this.type=c;this.LI=(f,g,h)=>new Qtb(this.qe,f,this.type,this.domain,g,h)}};var Rtb=class extends fr{I2(a){this._value.set(this.domain.apply(this._value.get(),a))}get value(){return this._value.get()}increment(a){this.Eu(this.domain.increment(a))}sW(){return this.value}bv(a){Ap(this.domain,this.value,a)}constructor(a,b,c,d,e){super(a,b,d,e);this.domain=c;this._value=new gr(d)}},Stb=class extends ir{constructor(a,b,c){super(b,c);this.qe=a;this.LI=(d,e,f)=>new Rtb(this.qe,d,this.domain,e,f)}},Mpb=class extends Stb{ss(a,b){return new Mpb(this.qe,this.domain,a,b)}constructor(a,
b,c,d){super(a,c,d);this.domain=b}},Npb=class extends Stb{ss(a,b){return new Npb(this.qe,this.domain,a,b)}constructor(a,b,c,d){super(a,c,d);this.domain=b}};var Ttb;Ttb=Symbol.iterator;
var Utb=class extends fr{static C(a){hb(a,{wF:Vq.shallow})}get size(){return this.wF.size}set(a,b){this.keyType.KLa(a);var c=this.wF.get(a);c=c!=null?this.domain.replace(a,c.snapshot(),this.valueType.hg(b)):this.domain.create(a,this.valueType.hg(b));this.Eu(c);c=this.wF.get(a);if(c==null)throw Error(`Unable to set key "${a}" to value "${b}"`);return c.mutable}get(a){return this.wF.get(a)?.mutable}has(a){return this.wF.has(a)}delete(a){const b=this.wF.get(a);b!=null&&(a=this.domain.delete(a,b.snapshot()),
this.Eu(a))}forEach(a){this.wF.forEach((b,c)=>a(b.mutable,c))}map(a){return[...this.wF].map(([b,c])=>a(c.mutable,b))}every(a){return[...this.wF.entries()].every(([b,c])=>a(c.mutable,b))}*entries(){for(const [a,b]of this.wF)yield[a,b.mutable]}keys(){return this.wF.keys()}*values(){for(const a of this.wF.values())yield a.mutable}aM(){return gh(this.wF,a=>a.mutable)}[Ttb](){return this.aM()[Symbol.iterator]()}sW(){return gh(this.wF,a=>a.snapshot())}bv(a){fa(this.wF.size===a.size);this.forEach((b,c)=>
{b=l(a.get(c));l(this.wF.get(c)).destroy(b)})}I2(a){a.forEach((b,c)=>{if(b!=null)switch(b.type){case 0:b.delta!=null&&l(this.wF.get(c)).Bm(b.delta);break;case 1:if(b.oldState!=null){var d=b.oldState;l(this.wF.get(c)).destroy(d);this.wF.delete(c)}else fa(!this.wF.has(c));b.newState!=null&&this.wF.set(c,Ppb(this,c,b.newState));break;default:throw new q(b);}})}constructor(a,b,c,d,e,f,g){super(a,b,f,g);this.keyType=c;this.valueType=d;this.domain=e;this.wF=(Utb.C(this),new Map);f.forEach((h,k)=>{this.keyType.KLa(k);
this.wF.set(k,Ppb(this,k,h))})}},Spb=class extends ir{p6b(a){return new Spb(this.qe,this.domain,this.keyType,this.valueType,a,this.al)}ss(a,b){return new Spb(this.qe,this.domain,this.keyType,this.valueType,a,b)}constructor(a,b,c,d,e,f){super(e,f);this.qe=a;this.domain=b;this.keyType=c;this.valueType=d;this.LI=(g,h,k)=>new Utb(this.qe,g,this.keyType,this.valueType,this.domain,h,k)}};var Vtb;Kq=__c.Kq=class{KLa(a){fa(this.fJ(a),"invalid value: {}",a);return a}KHb(a,b){if(!this.Fu(a,b))throw Error(`Invalid argument: ${this.stringify(a)} != ${this.stringify(b)}`);}constructor(a){this.serializer=a}};Kq.prototype.lx=ba(134);Vtb=class extends Kq{Fu(a,b){return a===b}hg(a){return a}stringify(a){return JSON.stringify(a)}};__c.Sqb=class extends Vtb{fJ(a){return this.values.has(a)}Ky(a){return new __c.Sqb(this.values,a)}constructor(a,b){super(b);this.values=a}};__c.Sqb.prototype.lx=ba(133);
var Sq=class extends Vtb{Ky(a){return new Sq(this.fJ,a)}constructor(a,b){super(b);this.fJ=a}},Rqb=class extends Kq{fJ(a){return a.every(b=>this.type.fJ(b))&&(!this.QJa||this.QJa(a))}Fu(a,b){return a.length===b.length&&a.every((c,d)=>d in b&&this.type.Fu(c,b[d]))&&a.reduce(c=>c+1,0)===b.reduce(c=>c+1,0)}hg(a){return Object.freeze(a.map(b=>this.type.hg(b)))}stringify(a){return a.length?"[ "+a.map(b=>this.type.stringify(b)).join(", ")+" ]":"[]"}Ky(a){return new Rqb(this.type,this.QJa,a)}constructor(a,
b,c){super(c);this.type=a;this.QJa=b}},Tqb=class extends Kq{fJ(a){return[...a].every(this.HPe)}Fu(a,b){if(a.size!==b.size)return!1;for(const [c,d]of a)if(a=b.get(c),a==null||!this.valueType.Fu(d,a))return!1;return!0}hg(a){const b=new Map;for(const [c,d]of a)b.set(c,this.valueType.hg(d));return b}stringify(a){return a.size?`{ ${[...a].map(([b,c])=>`${this.keyType.stringify(b)} => ${this.valueType.stringify(c)}`).join(", ")} }`:"{}"}Ky(a){return new Tqb(this.keyType,this.valueType,a)}constructor(a,
b,c){super(c);this.keyType=a;this.valueType=b;this.HPe=([d,e])=>Wtb.every(f=>!d.includes(f))&&this.keyType.fJ(d)&&this.valueType.fJ(e)}},Wtb=["$",".","\x00"],Uqb=class extends Kq{fJ(a){return this.keys.every(b=>this.fields[b].fJ(a[b]))&&(!this.QJa||this.QJa(a))}Fu(a,b){return this.keys.every(c=>this.fields[c].Fu(a[c],b[c]))}hg(a){return Object.freeze(tq(this.fields,(b,c)=>b.hg(a[c])))}stringify(a){return this.keys.length?"{ "+this.keys.map(b=>`${b}: ${this.fields[b].stringify(a[b])}`).join(", ")+
" }":"{}"}Ky(a){return new Uqb(this.fields,this.QJa,a)}cb(a){var b=tq(this.fields,c=>c.serializer);b=$ob(b);return this.Ky(vq(b,a))}constructor(a,b,c){super(c);this.fields=a;this.QJa=b;this.keys=Object.keys(this.fields)}},Vqb=class extends Kq{fJ(a){return this.Dx[this.sNa(a)].fJ(a)}Fu(a,b){const c=this.sNa(a),d=this.sNa(b);return c===d&&this.Dx[c].Fu(a,b)}hg(a){return this.Dx[this.sNa(a)].hg(a)}stringify(a){return this.Dx[this.sNa(a)].stringify(a)}Ky(a){return new Vqb(this.Dx,this.sNa,a)}Lt(a,b){const c=
tq(this.Dx,e=>e.serializer),d=Wob(a);return this.Ky(bpb(c,this.sNa,e=>d[b(e)]))}constructor(a,b,c){super(c);this.Dx=a;this.sNa=b}},Wqb=class extends Kq{fJ(a){return a==null||this.type.fJ(a)}Fu(a,b){return a!=null?b!=null&&this.type.Fu(a,b):b==null}hg(a){return a!=null?this.type.hg(a):void 0}stringify(a){return a!=null?this.type.stringify(a):"undefined"}Ky(a){return new Wqb(this.type,a)}constructor(a,b){super(b);this.type=a}},Xqb=class extends Wqb{Fu(a,b){return a==null||b==null||super.Fu(a,b)}},Yqb=
class extends Vtb{fJ(a){return typeof a==="string"&&this.regexp.test(a)}Ky(a){return new Yqb(this.regexp,a)}constructor(a,b){super(b);this.regexp=a}},Zqb=class extends Kq{fJ(){return!0}Fu(a,b){return a===b}hg(a){return a}stringify(a){return String(a)}Ky(a){return new Zqb(a)}};var Xtb=class{snapshot(){return this.mutable}Bm(){}destroy(a){this.type.KHb(this.mutable,a)}constructor(a,b){this.type=a;this.mutable=this.type.KLa(b)}},Vpb=class extends hr{Mu(a,b){return new Xtb(this.type,b)}snapshot(a){return a}ss(a,b){return new Vpb(this.domain,this.type,a,b)}constructor(a,b,c,d){super(c,d);this.domain=a;this.type=b}},Wpb=class extends Kq{fJ(){return!0}Fu(a,b){return this.domain.Bj(a,b)}hg(a){return this.domain.hg(a)}stringify(a){return JSON.stringify(a)}Ky(a){return new Wpb(this.domain,
a)}constructor(a,b){super(b);this.domain=a}};var Ytb;Ytb=Symbol.iterator;
__c.jr=class{static C(a){hb(a,{empty:Uq})}get empty(){return this.first()==null}count(){return this.reduce(a=>a+1,0)}toArray(){return this.base.filter(this.predicate)}aM(){return new Map(this.map((a,b)=>[b,a]))}[Ytb](){return this.toArray()[Symbol.iterator]()}first(a){const b=this.predicate;return this.base.first(c=>b(c)&&(!a||a(c)))}last(a){const b=this.predicate;return this.base.last(c=>b(c)&&(!a||a(c)))}next(a,b){fa(this.has(a));const c=this.predicate;return this.base.next(a,d=>c(d)&&(!b||b(d)))}previous(a,
b){fa(this.has(a));const c=this.predicate;return this.base.previous(a,d=>c(d)&&(!b||b(d)))}Op(a,b){const c=this.predicate;fa(c(a));fa(c(b));return this.base.Op(a,b)}has(a){const b=this.predicate;return b(a)&&this.base.has(a)}w0(a){const b=this.predicate;fa(b(a));return this.base.w0(a)}map(a){const b=this.predicate,c=[];this.base.forEach((d,e)=>{b(d)&&c.push(a(d,e))});return c}flatMap(a){const b=this.predicate,c=[];this.base.forEach((d,e)=>{b(d)&&c.push(...a(d,e))});return c}filter(a){const b=this.predicate;
return this.base.filter((c,d)=>b(c)&&a(c,d))}forEach(a){const b=this.predicate;this.base.forEach((c,d)=>b(c)&&a(c,d))}reduce(a,b){const c=this.predicate;return this.base.reduce((d,e)=>c(e)?a(d,e):d,b)}some(a){const b=this.predicate;return this.base.some(c=>b(c)&&a(c))}every(a){const b=this.predicate;return this.base.every(c=>b(c)&&a(c))}constructor(a,b){this.base=a;this.predicate=b;__c.jr.C(this)}};__c.jr.prototype.d0=ba(137);var Ztb;Ztb=Symbol.iterator;
__c.kr=class extends fr{static C(a){hb(a,{NQ:Uq,empty:Uq,ROa:Uq,zRa:Uq})}vSa(a){const b=this.type.Mu(this.context,a,this,c=>this.domain.pe().retain(this.HH(b.mutable)).update(c).build());return{Jj:b,id:String(this.GVb++)}}cjb(a,b){b.Jj.destroy(a)}get NQ(){return this.cells.filter(__c.Ya)}get(a){return this.cells[a]?.Jj.mutable}HH(a){return l(this.xU.get().get(a),"ref not found")}I2(a){const b=this.cells,c=new Map,d=new Map;var e=0;b.length<a.pre&&(b.length=a.pre);for(var f of a.ops)switch(f.type){case 0:case 2:e+=f.length;
break;case 1:b.spliceWithArray(e,0,Array(f.length));e+=f.length;break;case 3:var g=f.state,h=f.shift;b.splice(e,0,g!=null?this.vSa(g):void 0);h&&(d.set(h.Qa,b[e]),c.set(h.$l,e));e++;break;case 4:var k=f.delta;g=f.shift;if(k)switch(k.type){case 0:h=k.delta;h!=null&&l(b[e]).Jj.Bm(h);break;case 1:h=k.oldState;k=k.newState;h==null?ia(b[e]==null):this.cjb(h,l(b[e]));b[e]=k!=null?this.vSa(k):void 0;break;default:throw new q(k);}g&&(d.set(g.Qa,b[e]),c.set(g.$l,e));e++;break;default:throw new q(f);}ia(d.size===
a.wUa);ia(c.size===a.wUa);for(e=0;e<a.wUa;e++)ia(d.has(e)),f=l(c.get(e)),b[f]=d.get(e);for(;b.length&&b[b.length-1]==null;)b.length--}sW(){const a=[];this.cells.forEach((b,c)=>{b!=null&&(a[c]=b.Jj.snapshot())});return Object.freeze(a)}bv(a){let b=0;this.cells.forEach((d,e)=>{d!=null&&(fa(e in a),d.Jj.destroy(a[e]),b++)});const c=a.reduce(d=>d+1,0);fa(b===c)}get empty(){return!this.NQ.length}count(){return this.NQ.length}toArray(){return this.NQ.map(a=>a.Jj.mutable)}aM(){return new Map(this.map((a,
b)=>[b,a]))}[Ztb](){return this.toArray()[Symbol.iterator]()}get ROa(){return this.NQ[0]?.Jj.mutable}get zRa(){return this.NQ[this.NQ.length-1]?.Jj.mutable}first(a){return a?this.NQ.find(b=>a(b.Jj.mutable))?.Jj.mutable:this.ROa}last(a){if(!a)return this.zRa;const b=this.NQ;for(let c=b.length-1;c>=0;c--){const d=b[c];if(a(d.Jj.mutable))return d.Jj.mutable}}next(a,b){const c=this.cells;for(a=this.HH(a)+1;a<c.length;a++){const d=c[a];if(d&&(!b||b(d.Jj.mutable)))return d.Jj.mutable}}previous(a,b){const c=
this.cells;for(a=this.HH(a)-1;a>=0;a--){const d=c[a];if(d&&(!b||b(d.Jj.mutable)))return d.Jj.mutable}}Op(a,b){a=this.HH(a);b=this.HH(b);return a<b?-1:a>b?1:0}w0(a){return this.cells[this.HH(a)].id}has(a){return this.xU.get().has(a)}insertAt(a,b){this.Eu(this.domain.pe().retain(a).insert(this.type.hg(b)).build());return this.cells[a].Jj.mutable}set(a,b){fa(a>=0);a>=this.cells.length&&(this.cells.length=a+1);var c=this.cells[a];c=c!=null?c.Jj.snapshot():void 0;this.Eu(this.domain.pe().retain(a).Lp(c,
this.type.hg(b)).build());return this.cells[a].Jj.mutable}replace(a,b){a=this.HH(a);return this.set(a,b)}append(a){return this.insertBefore(void 0,a)}prepend(a){return this.Kta(void 0,a)}Kta(a,b){return this.insertAt(a?this.HH(a)+1:0,b)}insertBefore(a,b){return this.insertAt(a?this.HH(a):this.cells.length,b)}delete(a){a=this.domain.pe().retain(this.HH(a)).aU(this.type.snapshot(a)).build();this.Eu(a)}moveTo(a,b){const c=this.HH(b);if(c===a)return b;this.Eu(c<a?this.domain.pe().retain(c).retain({Qa:0,
$l:1}).retain(a-c-1).expand({Qa:1,$l:0}).build():this.domain.pe().retain(a).expand({Qa:0,$l:1}).retain(c-a).retain({Qa:1,$l:0}).build());return b}moveBefore(a,b){a=a!=null?this.HH(a):this.cells.length;this.moveTo(a,b)}map(a){return this.NQ.map(b=>a(b.Jj.mutable,b.id))}flatMap(a){return this.NQ.flatMap(b=>a(b.Jj.mutable,b.id))}filter(a){return this.NQ.filter(b=>a(b.Jj.mutable,b.id)).map(b=>b.Jj.mutable)}forEach(a){this.NQ.forEach(b=>b!=null&&a(b.Jj.mutable,b.id))}reduce(a,b){return this.NQ.reduce((c,
d)=>a(c,d.Jj.mutable,d.id),b)}some(a){return this.NQ.some(b=>a(b.Jj.mutable,b.id))}every(a){return this.NQ.every(b=>a(b.Jj.mutable,b.id))}constructor(a,b,c,d,e,f){super(a,b,e,f);this.type=c;this.domain=d;this.cells=(__c.kr.C(this),void 0);this.GVb=0;this.xU=Uq(()=>{const g=new Map;this.cells.forEach((h,k)=>h&&g.set(h.Jj.mutable,k));return g});fa(!e.length||e[e.length-1]!=null);this.cells=Vq.array([...e.map(g=>this.vSa(g))],{deep:!1})}};__c.kr.prototype.GOb=ba(138);__c.kr.prototype.d0=ba(136);
var Ypb=class extends ir{pe(){return this.domain.pe()}ss(a,b){return new Ypb(this.qe,this.domain,this.type,a,b)}constructor(a,b,c,d,e){super(d,e);this.qe=a;this.domain=b;this.type=c;this.LI=(f,g,h)=>new __c.kr(this.qe,f,this.type,this.domain,g,h)}};var $tb=class{get mutable(){throw new q(this.never);}snapshot(){throw new q(this.never);}Bm(){throw new q(this.never);}destroy(){throw new q(this.never);}constructor(a){this.never=a;throw new q(a);}},cqb=class extends hr{Mu(a,b){return new $tb(b)}snapshot(a){throw new q(a);}ss(a,b){return new cqb(this.domain,a,b)}constructor(a,b,c){super(b,c);this.domain=a}};var bub=class{static instance(){return aub}get mutable(){}destroy(a){fa(a==null)}Bm(a){fa(a==null)}snapshot(){}},aub=new bub,cub=class{Bm(a){this.Jj.Bm(l(a))}destroy(a){this.Jj.destroy(l(a))}get mutable(){return this.Jj.mutable}snapshot(){return this.Jj.snapshot()}constructor(a){this.Jj=a}},eqb=class extends hr{Mu(a,b,c,d,e){return b==null?bub.instance():new cub(this.type.Mu(a,b,c,d,e))}snapshot(a){return a!=null?this.type.snapshot(a):void 0}ss(a,b){return new eqb(this.domain,this.type,a,b)}constructor(a,
b,c,d){super(c,d);this.domain=a;this.type=b}};var dub=class extends fr{static C(a){hb(a,{Tpd:Uq})}get Tpd(){const a=new Map;this.items.forEach((b,c)=>a.set(b,c));return a}get(a){return Lq(this,this.refs.get(a))}has(a){return this.get(a)!=null}forEach(a){for(const [b,c]of this.refs)a(Lq(this,c),b)}create(a,b){a=this.domain.replace(a,this.get(a),b);this.Eu(a)}update(a,b){const c=l(Lq(this,this.refs.get(a)));a=this.domain.update(a,c,b);this.Eu(a)}delete(a){const b=Lq(this,this.refs.get(a));b!=null&&(a=this.domain.replace(a,b,void 0),this.Eu(a))}sW(){const a=
this.domain.rf();for(const [b,c]of this.refs)a.ordinal(b,Lq(this,c));return a.build()}bv(a){ia(this.refs.size===a.size);for(const [b,c]of this.refs)ia(a.has(b)),ia(Lq(this,c)===a.get(b))}I2(a){if(!this.domain.isIdentity(a)){var b=a.axis;if(!b.isEmpty()){var c=0;this.items.length<b.pre&&(this.items.length=b.pre);b=b.Ad();for(var d=b.head;d;)d.type===0?c+=b.Yz(d.length):(d=Hp(b,d.length),this.items.spliceWithArray(c,0,Array(d)),c+=d),d=b.head}for(const [e,f]of a.lm)switch(f.type){case 0:f.oldValue!=
null?(a=l(this.refs.get(e)),c=gqb(this,f.oldValue),fa(a===c)):fa(!this.refs.has(e));f.newValue!=null?this.refs.set(e,gqb(this,f.newValue)):this.refs.delete(e);break;case 1:a=l(this.refs.get(e));c=gqb(this,f.oldValue);fa(a===c);this.refs.set(e,gqb(this,f.newValue));break;default:throw new q(f);}}}constructor(a,b,c,d,e){super(a,c,d,e);this.domain=b;this.items=(dub.C(this),Vq.array([],{deep:!1}));this.refs=Vq.map(new Map,{deep:!1});for(const [f,g]of d)this.refs.set(f,gqb(this,g))}},hqb=class extends ir{ss(a,
b){return new hqb(this.qe,this.domain,a,b)}constructor(a,b,c,d){super(c,d);this.qe=a;this.domain=b;this.LI=(e,f,g)=>new dub(this.qe,this.domain,e,f,g)}};var eub;eub=class{forEach(a,b=this.pre,c=this.post){this.ops.forEach(d=>{switch(d.type){case 0:a.retain?.(d.bb);break;case 2:a.insert?.(d.bb);break;case 1:a.delete?.(d.bb);break;default:throw new q(d);}});(b=Math.max(0,b-this.pre,c-this.post))&&a.retain?.(b)}static Oq(){return new Nq}constructor(a,b,c){this.pre=a;this.post=b;this.ops=c}};
Nq=__c.Nq=class{static insert(a,b){return(new Nq).retain(a).insert(b).build()}static delete(a,b){return(new Nq).retain(a).delete(b).build()}retain(a){fa(a>=0);a>0&&(this.xba(0),this.s$a+=a);return this}insert(a){a.length>0&&(this.xba(2),this.Hpb+=a);return this}delete(a){a>0&&(this.xba(1),this.o0a+=a);return this}xba(a){if(this.mode!==a){switch(this.mode){case 0:var b=this.ops,c=b.push,d=this.s$a;fa(d>0);c.call(b,{type:0,bb:d});this.pre+=this.s$a;this.post+=this.s$a;this.s$a=0;break;case 2:b=this.ops;
c=b.push;d=this.Hpb;fa(d.length>0);c.call(b,{type:2,bb:d});this.post+=this.Hpb.length;this.Hpb="";break;case 1:b=this.ops;c=b.push;d=this.o0a;fa(d>0);c.call(b,{type:1,bb:d});this.pre+=this.o0a;this.post+=this.o0a;this.o0a=0;break;case void 0:break;default:throw new q(this.mode);}this.mode=a}}build(){this.mode!==0&&this.xba();return new eub(this.pre,this.post,this.ops)}constructor(){this.ops=[];this.post=this.pre=0;this.mode=void 0;this.s$a=0;this.Hpb="";this.o0a=0}};__c.fub=class extends fr{static C(a){hb(a,{bb:Uq})}get bb(){return this.state.get().bb()}insert(a,b){this.Eu(__c.jqb(this.domain,this.state.get(),Nq.insert(a,b)))}delete(a,b){this.Eu(__c.jqb(this.domain,this.state.get(),Nq.delete(a,b)))}I2(a){const b=kqb(this.state.get(),a);this.state.set(this.domain.apply(this.state.get(),a));this.subject.next(b)}sW(){return this.state.get()}bv(a){fa(this.domain.Bj(this.state.get(),a))}constructor(a,b,c,d,e){super(a,b,d,e);this.domain=c;this.state=(__c.fub.C(this),
void 0);this.subject=new irb;this.state=new gr(d)}};__c.fub.prototype.MD=ba(145);var lqb=class extends ir{ss(a,b){return new lqb(this.qe,this.domain,a,b)}constructor(a,b,c,d){super(c,d);this.qe=a;this.domain=b;this.LI=(e,f,g)=>new __c.fub(this.qe,e,this.domain,f,g)}};var oqb=class{create(a,b){a=this.zZb.AQc(a);var c=this.base.get(a.start);const d=this.base.get(a.end);if(c==null&&d==null){c=this.base;b=new Map([[a.start,b.start],[a.end,b.end]]);a=c.domain.pe();for(const [e,f]of b)qob(a,e,c.get(e),f);c.Eu(a.build())}}get(a){var b=this.zZb.AQc(a);a=this.base.get(b.start);b=this.base.get(b.end);if(a!=null&&b!=null)return{start:a,end:Math.max(a,b)}}has(a){return this.get(a)!=null}forEach(a){const b=new Set;this.base.forEach((c,d)=>{c=this.zZb.kFe(d);b.has(c)||(b.add(c),
d=l(this.get(c)),a(d,c))})}delete(a){var b=this.zZb.AQc(a);a=this.base;var c=new Set([b.start,b.end]);b=a.domain.pe();for(const d of c)c=a.get(d),c!=null&&qob(b,d,c);a.Eu(b.build())}constructor(a,b){this.base=a;this.zZb=b}};var gub=class extends Wq{static of(a){return new gub(a)}isIdentity(a){return a===this.id||Object.entries(a).every(([b,c])=>c==null||this.components[b].isIdentity(c))}constructor(a){super();this.components=a;this.id={}}};var qqb=class extends Xq{static of(a,b){return new qqb(a,b)}update(a,b){const c={};l(this.components[a]).isIdentity(b)||(c[a]=b);return c}identity(){return this.id}isIdentity(a){return this.base.isIdentity(a)}xl(a){const b={};var c=Object.keys(a);if(!c.length)return a;for(const e of c){var d=a[e];d!=null&&(c=this.components[e],d=c.xl(d),c.isIdentity(d)||(b[e]=d))}return b}compose(a,b){const c={};var d=Object.keys(a),e=Object.keys(b);if(!d.length)return b;if(!e.length)return a;for(const f of new Set([...d,
...e])){e=a[f];const g=b[f];e!=null&&g!=null?(d=this.components[f],e=d.compose(e,g),d.isIdentity(e)||(c[f]=e)):e!=null?c[f]=e:g!=null&&(c[f]=g)}return c}transform(a,b){const c={},d={};var e=Object.keys(a),f=Object.keys(b);if(!e.length||!f.length)return Cp(b,a);const g=Bp.Oq();for(const h of new Set([...e,...f])){f=a[h];const k=b[h];f!=null&&k!=null?(e=this.components[h],f=Fp(g,e.transform(f,k)),e.isIdentity(f.uu)||(c[h]=f.uu),e.isIdentity(f.Rt)||(d[h]=f.Rt)):f!=null?c[h]=f:k!=null&&(d[h]=k)}return g.build(d,
c)}apply(a,b){var c=Object.keys(b);if(!c.length)return a;const d={...a};for(const e of c)c=b[e],c!=null&&(d[e]=this.components[e].apply(a[e],c));return Object.freeze(d)}Nl(a,b){var c=Object.keys(b);if(!c.length)return a;const d={...a};for(const e of c)c=b[e],c!=null&&(d[e]=this.components[e].Nl(a[e],c));return Object.freeze(d)}hg(a){return Object.freeze(Sn(this.components,(b,c)=>b.hg(a[c])))}Bj(a,b){return a===b||Object.keys(this.components).every(c=>this.components[c].Bj(a[c],b[c]))}wk(a,b){if(a===
b)return!0;const c=Object.keys(a),d=Object.keys(b);return!c.length&&!d.length||__c.yp([...c,...d]).every(e=>{const f=a[e],g=b[e];return f!=null&&g!=null&&this.components[e].wk(f,g)})}equals(a){return this===a?!0:a instanceof qqb?Object.keys(this.components).length===Object.keys(a.components).length&&Object.keys(this.components).every(b=>b in a.components&&this.components[b].equals(a.components[b])):!1}constructor(a,b){super(a);this.components=b;this.base=new gub(this.components);this.id={}}};var hub,iub,jub,kub;
hub=class extends fr{sW(){const a={};for(const b in this.eI.values)a[b]=this.fields[b];for(const b in this.eI.ab)a[b]=this.fields[b].snapshot();for(const b in this.eI.attributes)a[b]=this.fields[b].snapshot();return Object.freeze(a)}bv(a){for(const b in this.eI.values)this.eI.values[b].KHb(this.fields[b],a[b]);for(const b in this.eI.ab)this.fields[b].destroy(a[b]);for(const b in this.eI.attributes)this.fields[b].destroy(a[b]);if(this.$ca?.bv)try{this.$ca.bv()}catch(b){Promise.reject(b)}}I2(a){for(const b in a)a[b]!=null&&
(b in this.eI.ab?this.fields[b].Bm(a[b]):b in this.eI.attributes&&this.fields[b].Bm(a[b]))}getValue(a){return this.fields[a]}getAttribute(a){return this.fields[a].snapshot()}setAttribute(a,b){this.fields[a].mutable.value=b}constructor(a,b,c,d,e,f,g,h,k){super(b,a,h,k);this.domain=c;this.eI=d;this.$ca=void 0;a=tq(d.values,(m,n)=>m.KLa(h[n]));b=tq(d.ab,(m,n)=>m.Mu(this.context,h[n],this,e[n],{fmd:"lazy"}));d=tq(d.attributes,(m,n)=>m.Mu(this.context,h[n],this,f[n],{fmd:"lazy"}));this.fields={...a,...b,
...d};this.proxy=uqb(this,g)}};Oq=__c.Oq=Symbol("$impl");iub=class extends hr{};
jub=class extends ir{ss(a,b){return new jub(this.qe,this.domain,this.eI,a,b)}constructor(a,b,c,d,e){super(d,e);this.qe=a;this.domain=b;this.eI=c;this.pbf=tq(this.eI.ab,(f,g)=>h=>({[g]:h}));this.lce=tq(this.eI.attributes,(f,g)=>h=>({[g]:h}));this.LI=(f,g,h)=>new hub(f,this.qe,this.domain,this.eI,this.pbf,this.lce,this.R$e,g,h);a=tq(c.ab,(f,g)=>({enumerable:!0,configurable:!0,get(){return this[Oq].fields[g].mutable}}));b=tq(c.attributes,(f,g)=>({enumerable:!0,configurable:!0,get(){return this[Oq].getAttribute(g)},
set(h){this[Oq].setAttribute(g,h)}}));d=tq(c.computed?.ab||{},(f,g)=>({enumerable:!0,configurable:!0,get(){var h=this[Oq];h.$ca==null&&(h.$ca=tqb(h));return h.$ca.ab[g]}}));c=tq(c.computed?.attributes||{},(f,g)=>({enumerable:!0,configurable:!0,get(){var h=this[Oq];h.$ca==null&&(h.$ca=tqb(h));return h.$ca.attributes[g].value},set(h){var k=this[Oq];k.$ca==null&&(k.$ca=tqb(k));k.$ca.attributes[g].value=h}}));this.R$e={...a,...d,...b,...c}}};
kub=class{get mutable(){return this.base.mutable.proxy}destroy(a){this.base.destroy(a)}Bm(a){this.base.Bm(a)}snapshot(){return this.base.snapshot()}constructor(a){this.base=a}};
__c.wqb=class extends iub{Mu(a,b,c,d,e){a=this.base.Mu(a,b,c,d,e);return new kub(a)}snapshot(a){return this.base.snapshot(a[Oq])}ss(a,b){return new __c.wqb(this.qe,this.values,this.ab,this.attributes,this.computed,this.Lhc,a,b)}cb(a,b){const c=$ob({...tq(this.ab,e=>Eq(e.MK)),...tq(this.attributes,e=>e.MK)}),d=$ob({...tq(this.values,e=>e.serializer),...tq(this.ab,e=>e.al),...tq(this.attributes,e=>e.al)});return this.ss(vq(c,a),vq(d,b))}Gf({values:a={},ab:b={},attributes:c={},computed:d}){return new __c.wqb(this.qe,
{...this.values,...a},{...this.ab,...b},{...this.attributes,...c},vqb(this.computed,d),this.Lhc,Gq,Gq)}constructor(a,b,c,d,e,f,g,h){super(g,h);this.qe=a;this.values=b;this.ab=c;this.attributes=d;this.computed=e;this.Lhc=f;this.domain=rqb(this.qe,tq(this.values,k=>this.Lhc((m,n)=>k.Fu(m,n),m=>k.hg(m))),tq(this.ab,k=>k.domain),tq(this.attributes,k=>k.domain));sqb(b,{...c,...e?.ab},{...d,...e?.attributes});this.base=new jub(this.qe,this.domain,this,g,h)}};__c.wqb.prototype.uM=ba(126);var yqb;yqb=class extends hr{get type(){typeof this.ref==="function"&&(this.ref=this.ref());return this.ref}Mu(a,b,c,d,e){return this.type.Mu(a,b,c,d,e)}snapshot(a){return this.type.snapshot(a)}ss(a,b){return this.map(c=>c,c=>c,c=>c,c=>c,c=>c,c=>c).ss(a,b)}constructor(a,b){super(new ytb(()=>this.type.MK),new ytb(()=>this.type.al));this.ref=b;this.domain=a(()=>this.type.domain)}};
__c.zqb=class extends Kq{get value(){typeof this.ref==="function"&&(this.ref=this.ref());return this.ref}fJ(a){return this.value.fJ(a)}Fu(a,b){return this.value.Fu(a,b)}hg(a){return this.value.hg(a)}stringify(a){return this.value.stringify(a)}KLa(a){return this.value.KLa(a)}KHb(a,b){this.value.KHb(a,b)}Ky(a){return this.value.Ky(a)}constructor(a){super(new ytb(()=>this.value.serializer));this.ref=a}};__c.zqb.prototype.lx=ba(132);__c.lub=class{forEach(a){const b=this.raa.pe();this.je.forEach({retain:c=>b.retain(c),insert:c=>b.insert(c),delete:c=>b.J6(c)},this.pre,this.post);(new er(b.build(),this.attrs)).forEach({retain:(c,d)=>a.retain?.(c,d),insert:(c,d)=>c.type!==2&&a.insert?.(c.state,d),Lp:(c,d,e)=>a.delete?.(c.length,e)})}constructor(a,b,c){this.raa=a;this.je=b;this.attrs=c;this.pre=Math.max(this.je.pre,this.attrs.pre);this.post=Math.max(this.je.post,this.attrs.post)}};var Bqb,nub,oub;
__c.lr=class extends fr{static C(a){hb(a,{charLength:Uq,bb:Uq,isEmpty:Uq,aGb:Uq})}fAa(a){if(!a)return{index:0,length:this.charLength};const b=a.index,c=a.index+a.length,d=this.charLength;fa(b<=c,"invalid range: {}, {}",b,c);fa(0<=b&&c<=d,"range out of bounds: [{}, {}) \u2288 [{}, {})",b,c,0,d);return a}get charLength(){return this._state.get().cells.qra}get bb(){return this._state.get().cells.bb()}get isEmpty(){const a=this.charLength;return a===0||a===1&&xob(this._state.get().cells)}get aGb(){const a=[];
this._state.get().forEach({...Mq,bb:(b,c,d)=>a.push({bb:b,attributes:{...d}})});return a}$Fb(){const a=this._state.get();return this.domain.attrs.eH(a.attrs,a.length,this.Df)}setAttribute(a,b,c){const d={};d[a]=b;this.setAttributes(d,c)}setAttributes(a,b){b=this.fAa(b);if(b.length!==0&&Object.keys(a).length!==0){a=this.Df.c7a(a);var c=this._state.get(),d=this.$Fb();c=c.cells.cursor(c.length,{...Mq,bb:e=>d.retain(e.length),vm:e=>d.retain(e)});c.zt(b.index);c.M6a();d.Tfa(a);c.zt(b.length);c.M6a();d.DT(a);
__c.Dqb(this,d.build())}}eH(){return this.domain.eH(this._state.get(),this.Df)}I2(a){const b=Cqb(this.domain.cells,this._state.get(),a);this._state.set(this.domain.apply(this._state.get(),a));this.subject.next(b)}vwa(a,b){if(a.length){fa(a.every((f,g)=>{g=a[g+1];return f.length>0&&(g==null||f.index+f.length<=g.index)}));var c=this.eH(),d=0,e=this._state.get().cursor();for(const {index:f,length:g}of a){const h=f+g;e.zt(f-d,{...Mq,bb:m=>c.retain(m.length),vm:m=>c.retain(m)});let k=!1;e.zt(g,{...Mq,
bb:(m,n,p)=>{k||(c.Tfa(p),c.insert(b),c.DT(p),k=!0);c.delete(m)},vm:m=>c.retain(m)});d=h}this.Eu(c.build())}}onError(a){super.onError(a);this.subject.error(a)}get state(){return this._state.get()}sW(){return this.state}bv(a){fa(this.domain.Bj(this._state.get(),a));this.subject.complete()}constructor(a,b,c,d,e,f,g){super(a,b,c,d);this.domain=e;this.Df=f;this.o7=g;this._state=(__c.lr.C(this),void 0);this.subject=new irb;this.$fc=0;this._state=new gr(c)}};__c.aa=__c.lr.prototype;__c.aa.KF=ba(178);
__c.aa.dea=ba(172);__c.aa.kR=ba(168);__c.aa.Zt=ba(163);__c.aa.jX=ba(157);__c.aa.LO=ba(154);__c.aa.PE=ba(151);__c.aa.c8=ba(149);__c.aa.D7=ba(147);__c.aa.MD=ba(144);__c.mub=class{je(a){a.length>0&&(this.ifd=a.endsWith("\n"),this.Oq.je(a));return this}Vc(a,b){this.Oq.Vc(a,this.Df.normalize(a,b));return this}attrs(a){this.Oq.attrs(this.Df.c7a(a));return this}build(){const a=this.Oq.build();ia(a.length===0||this.ifd);return a}constructor(a,b){this.Oq=a;this.Df=b;this.ifd=!1}};__c.mub.prototype.OR=ba(184);
Bqb=class{Lp(a){this.attrs.Lp(a);return this}retain(a,b){this.je.retain(a);this.attrs.retain(a,b);return this}insert(a,b){this.je.insert(a);this.attrs.insert(a.length,b);return this}delete(a,b){this.je.delete(a);this.attrs.retain(a,b);return this}build(){return new __c.lub(this.raa,this.je.build(),this.attrs.build())}constructor(a){this.raa=a;this.je=new Nq;this.attrs=new Arb}};
nub=class{retain(a){this.je.retain(a);this.attrs.retain(a);return this}insert(a){this.je.insert(a);this.attrs.insert(a.length);return this}delete(a){this.je.delete(a);this.attrs.retain(a);return this}open(a,b){this.attrs.open(a,this.Df.normalize(a,b));return this}Tfa(a){this.attrs.Tfa(this.Df.c7a(a))}close(a){this.attrs.close(a);return this}DT(a){this.attrs.DT(a);return this}build(){return new __c.lub(this.raa,this.je.build(),this.attrs.build())}constructor(a,b,c){this.raa=a;this.Df=b;this.attrs=
c;this.je=new Nq}};oub=class extends ir{};
Pq=__c.Pq=class extends oub{rf(){return this.djc()}djc(){return new __c.mub(this.domain.rf(this.Df),this.Df)}eH(a){a=this.domain.$Fb(a,this.Df);return new nub(this.domain.cells,this.Df,a)}hg(a){return this.domain.hg(a,b=>this.Df.JC(b))}ss(a,b){return new Pq(this.qe,this.domain,this.Df,this.o7,a,b)}constructor(a,b,c,d,e,f){super(e,f);this.qe=a;this.domain=b;this.Df=c;this.o7=d;this.LI=(g,h,k)=>{Eqb(h,this.Df);return new __c.lr(this.qe,g,h,k,this.domain,this.Df,this.o7)}}};Pq.prototype.ULa=ba(189);
Pq.prototype.o2b=ba(186);Pq.prototype.WJb=ba(185);Pq.prototype.vF=ba(116);var pub;
__c.mr=class extends fr{static C(a){hb(a,{ayb:Uq.struct,isEmpty:Uq,items:Uq({equals:fpb.shallow}),Lbe:Uq})}get ayb(){return this.Tc.get().Uf}Eu(a){a=this.Sde!=null?this.Sde(a):a;super.Eu(a)}get isEmpty(){const {yr:a,qra:b}=this.cells.get();return a===0&&(b===0||b===1&&xob(this.cells.get()))}get items(){return new Set(this.cells.get().items.map(a=>a.mutable))}get Lbe(){if(this.cells.get().qra<4E3){const a=Math.ceil(Math.log(this.cells.get().qra)/Math.log(2));return Math.pow(2,a)}return Math.round(this.cells.get().qra/1E3)*
1E3}get length(){return Math.max(this.cells.get().length,this.attrs.get().length)}eH(){return new atb(new Psb(()=>!0),this.domain.attrs.eH(this.attrs.get(),this.cells.get().length,this.Df),this.domain.Tc?.pe())}vSa(a){const b=this.type.Mu(this.context,a,this,c=>{a:{var d=this.cells.get();let e=0,f=0;for(const g of d.sequence){if(dq(g)===1){if(d.items[f]===b){d=e;break a}f++}e+=Math.abs(g)||1}d=-1}ia(d>=0,"cell not found");return this.domain.pe().retain(d).update(c).build()});return b}cjb(a,b){a.destroy(b)}insertAt(a,
b){a=a.resolve(this.cells.get());fa(0<=a&&a<=Math.max(0,this.cells.get().length-1),"Position {} is not in range [0, {}]",a,Math.max(0,this.cells.get().length-1));a===this.cells.get().length&&fa(typeof b==="string"&&b.endsWith("\n"));this.Eu(this.domain.pe().retain(a).insert(typeof b==="string"?b:this.type.hg(b)).build());if(typeof b!=="string"){b=this.cells.get().Fwc(a);if(b==null||typeof b==="string")throw Error(`item expected at ${a}, found: ${b}`);return b.mutable}}setSelection(a,b){const c=this.Tc.get().Uf.get(a);
var d=b?.resolve(this.cells.get());b=this.domain.pe();d=d&&[d.start,d.end];b.Tc?.EUa(a,c,d);a=b.build();this.Eu(a)}cursor(a,b){return(new dr(this.cells.get(),this.attrs.get(),this.Tc.get(),this.domain.Tc)).oL(c=>c.mutable).cursor(a,b)}forEach(a){(new dr(this.cells.get(),this.attrs.get(),this.Tc.get(),this.domain.Tc)).forEach({...a,item:(b,c,d,e,f)=>a.item(b.mutable,c,d,e,f)})}I2(a){var b=a.wQ,c=a.oQ;a=a.oG;const d=new Psb(g=>g);if(!this.domain.cells.isIdentity(b)){const g=new Hsb,h=this.cells.get().Ad(b.pre);
for(b=b.Ad(this.cells.get().length,0);;){let k=h.head;var e=b.head;if(!e)break;if(e.type===2)k=void 0,e=iq(b);else if(k){var f=Math.min(k.length,e.Jfa);k=h.fo(f);e=Cob(b,f)}if(e.type===2)k=e.state.oL(m=>this.vSa(m)),g.region(k),d.sla(k);else if(k)switch(e.type){case 0:g.region(k);d.retain(e.length);break;case 1:fa(k.type===1);k.state.Bm(e.delta);g.region(k);d.retain(1);break;case 3:f=e.oldState;e=e.newState;k.type===1?(fa(k.type===f.type,"{} != {}",k.type,f.type),this.cjb(k.state,f.state)):Eob(this.domain.cells,
k,f);f=k;k=e.oL(m=>this.vSa(m));g.region(k);hq(d,f,k);break;default:throw new q(e);}else throw Error("reader exhausted prematurely");}h.finish();b.finish();this.cells.set(g.build())}this.attrs.set(this.domain.attrs.apply(this.attrs.get(),c));this.Tc.set(this.domain.Tc.apply(this.Tc.get(),l(a)));c=new er(d.build(),c,a);this.subject.next(c)}onError(a){super.onError(a);this.subject.error(a)}sW(){return(new dr(this.cells.get(),this.attrs.get(),this.Tc.get(),this.domain.Tc)).oL(a=>a.snapshot())}bv(a){fa(this.domain.Bj(this.snapshot(),
a));this.subject.complete()}constructor(a,b,c,d,e,f,g){super(a,b,f,g);this.Df=c;this.type=d;this.domain=e;this.cells=(__c.mr.C(this),void 0);this.subject=new irb;l(e.Tc);this.cells=new gr(f.cells.oL(k=>this.vSa(k)));this.attrs=new gr(f.attrs);this.Tc=new gr(l(f.Tc));f.attrs.forEach(0,{grad:k=>c.dK(k)});const h=lrb(k=>this.Df.JC(k)&&this.attrs.get().attributes[k]||new Set,{equals:fpb.shallow});this.attributes=new Proxy({},{get:(k,m)=>h(m),has:(k,m)=>this.Df.JC(m),ownKeys:()=>Object.keys(this.attrs.get().attributes),
getOwnPropertyDescriptor:(k,m)=>{k=this.Df.JC(m)?this.attrs.get().attributes[m]:void 0;if(k!=null)return{enumerable:!0,configurable:!0,value:k}}})}};__c.mr.prototype.MD=ba(141);__c.mr.prototype.YMa=ba(120);pub=class extends ir{};
__c.Qq=class extends pub{pe(){return this.domain.pe(this.Df)}rf(){return this.domain.rf(this.Df)}hg(a){return this.domain.hg(a,b=>this.Df.JC(b))}ss(a,b){return new __c.Qq(this.qe,this.domain,this.Df,this.type,a,b)}constructor(a,b,c,d,e,f){super(e,f);this.qe=a;this.domain=b;this.Df=c;this.type=d;this.LI=(g,h,k)=>new __c.mr(this.qe,g,this.Df,this.type,this.domain,h,k)}};__c.Qq.prototype.ULa=ba(188);__c.Qq.prototype.vF=ba(115);var uub=class extends fr{sW(){const a={rows:this.G_b.snapshot(),cols:this.jIb.snapshot(),aq:this.rxb.snapshot(),bq:this.sxb.snapshot(),gp:this.ohb.snapshot(),Mp:this.phb.snapshot(),cells:this.c_a.snapshot(),attrs:this.gZa.snapshot()};return Object.freeze(a)}bv(a){this.G_b.destroy(a.rows);this.jIb.destroy(a.cols);this.rxb.destroy(a.aq);this.sxb.destroy(a.bq);this.ohb.destroy(a.gp);this.phb.destroy(a.Mp);this.c_a.destroy(a.cells);this.gZa.destroy(a.attrs)}I2(a){const b=pq(this.domain,a.rows),c=pq(this.domain,
a.cols);this.G_b.Bm(a.rows);this.jIb.Bm(a.cols);this.rxb.Bm(this.gTa.domain.mf(b,a.aq));this.sxb.Bm(this.Kl.mf(b,a.bq));this.ohb.Bm(this.gTa.domain.mf(c,a.gp));this.phb.Bm(this.Kl.mf(c,a.Mp));this.c_a.Bm(this.domain.cells.mf({...a.cells,y:b,x:c}));this.gZa.Bm(this.domain.attrs.mf({...a.attrs,y:b,x:c}))}constructor(a,b,c,d,e,f,g,h,k,m,n,p){super(a,b,n,p);this.mef=c;this.Gje=d;this.Che=e;this.pce=f;this.domain=g;this.kwb=h;this.Kl=k;this.gTa=m;this.L6=t=>this.rows.xU.get().get(t);this.R3=t=>this.cols.xU.get().get(t);
this.JCa=t=>this.rows.get(t);this.ICa=t=>this.cols.get(t);this.uPb=()=>{var t=this.rows.last();if(t==null)return 0;t=this.L6(t);return t!=null?t+1:0};this.KOb=()=>{var t=this.cols.last();if(t==null)return 0;t=this.R3(t);return t!=null?t+1:0};this.G_b=this.mef.Mu(b,n.rows,this,t=>{const v=pq(this.domain,t);g.axis.isIdentity(v)||(this.c_a.Bm(this.domain.cells.mf({y:v})),this.gZa.Bm(this.domain.attrs.mf({y:v})),this.rxb.Bm(this.gTa.domain.mf(v,new Map)),this.sxb.Bm(this.Kl.mf(v,new Map)));return this.domain.mf({rows:t})});
this.rows=this.G_b.mutable;this.jIb=this.Gje.Mu(b,n.cols,this,t=>{const v=pq(this.domain,t);g.axis.isIdentity(v)||(this.c_a.Bm(this.domain.cells.mf({x:v})),this.gZa.Bm(this.domain.attrs.mf({x:v})),this.ohb.Bm(this.gTa.domain.mf(v,new Map)),this.phb.Bm(this.Kl.mf(v,new Map)));return this.domain.mf({cols:t})});this.cols=this.jIb.mutable;this.rxb=m.Mu(b,n.aq,this,t=>{fa(g.axis.isIdentity(t.axis));return this.domain.mf({aq:t.lm})});this.aq=new qub(this.rxb.mutable,this.L6,this.JCa);this.sxb=this.kwb.Mu(b,
n.bq,this,t=>{fa(g.axis.isIdentity(t.axis));return this.domain.mf({bq:t.Uf})});this.bq=new rub(this.sxb.mutable,this.L6,this.JCa);this.ohb=m.Mu(b,n.gp,this,t=>{fa(g.axis.isIdentity(t.axis));return this.domain.mf({gp:t.lm})});this.gp=new qub(this.ohb.mutable,this.R3,this.ICa);this.phb=this.kwb.Mu(b,n.Mp,this,t=>{fa(g.axis.isIdentity(t.axis));return this.domain.mf({Mp:t.Uf})});this.Mp=new rub(this.phb.mutable,this.R3,this.ICa);this.c_a=this.Che.Mu(b,n.cells,this,t=>{fa(g.axis.isIdentity(t.x));fa(g.axis.isIdentity(t.y));
return this.domain.mf({cells:t})});this.cells=new sub(this.c_a.mutable,this.L6,this.R3,this.JCa,this.ICa,this.uPb,this.KOb);this.gZa=this.pce.Mu(b,n.attrs,this,t=>{fa(g.axis.isIdentity(t.x));fa(g.axis.isIdentity(t.y));return this.domain.mf({attrs:t})});this.attrs=new tub(this.gZa.mutable,this.L6,this.R3,this.JCa,this.ICa,this.uPb,this.KOb)}},sub=class{get(a,b){a=this.L6(a);b=this.R3(b);if(a!=null&&b!=null&&(b=this.grid.get(a,b),b!=null))return{span:{Th:l(Hqb(this,b.span)),Oh:l(Iqb(this,b.span)),ak:l(Jqb(this,
b.span)),yk:l(Kqb(this,b.span))},ref:b.ref}}forEach(a){this.grid.forEach((b,c)=>{const d=Hqb(this,c),e=Iqb(this,c);d!=null&&e!=null&&a(b,{Th:d,Oh:e,ak:l(Jqb(this,c)),yk:l(Kqb(this,c))})})}map(a){const b=[];this.forEach((c,d)=>b.push(a(c,d)));return b}set(a,b){this.grid.set(Lqb(this,a),b);return l(this.get(a.Th,a.Oh))}delete(a){this.grid.delete(Lqb(this,a))}constructor(a,b,c,d,e,f,g){this.grid=a;this.L6=b;this.R3=c;this.JCa=d;this.ICa=e;this.uPb=f;this.KOb=g}},tub=class{get(a,b,c){b=this.L6(b);c=this.R3(c);
if(b!=null&&c!=null)return this.grid.get(a,b,c)}set(a,b,c){const d=this.L6(b.Th),e=this.R3(b.Oh),f=this.L6(b.ak||b.Th);b=this.R3(b.yk||b.Oh);d!=null&&e!=null&&f!=null&&b!=null&&this.grid.set(a,{Glf:d,slf:e,hMb:f,Tze:b},c)}constructor(a,b,c,d,e,f,g){this.grid=a;this.L6=b;this.R3=c;this.JCa=d;this.ICa=e;this.uPb=f;this.KOb=g}},qub=class{get(a){a=this.lm.get(a);if(a!=null)for(;a>=0;a--){const b=this.LQb(a);if(b)return b}}forEach(a){this.lm.forEach((b,c)=>{(b=this.get(c))&&a(b,c)})}create(a,b){b=l(this.QSb(b));
this.lm.create(a,b)}delete(a){this.lm.delete(a)}constructor(a,b,c){this.lm=a;this.QSb=b;this.LQb=c}},rub=class{get(a){a=this.Uf.get(a);if(a!=null){var b;a:{for(b=a.start;b<=a.end;b++){var c=this.LQb(b);if(c){b=c;break a}}b=void 0}a:{for(c=a.end;c>=a.start;c--){const d=this.LQb(c);if(d){a=d;break a}}a=void 0}if(b!=null&&a!=null)return{start:b,end:a}}}has(a){return this.get(a)!=null}forEach(a){this.Uf.forEach((b,c)=>{(b=this.get(c))&&a(b,c)})}create(a,b){const c=l(this.QSb(b.start));b=l(this.QSb(b.end));
this.Uf.create(a,{start:c,end:b})}delete(a){this.Uf.delete(a)}constructor(a,b,c){this.Uf=a;this.QSb=b;this.LQb=c}},Mqb=class extends ir{ss(a,b){return new Mqb(this.qe,this.domain,this.rows,this.cols,this.cells,this.attrs,this.kwb,this.Kl,this.gTa,this.axis,a,b)}constructor(a,b,c,d,e,f,g,h,k,m,n,p){super(n,p);this.qe=a;this.domain=b;this.rows=c;this.cols=d;this.cells=e;this.attrs=f;this.kwb=g;this.Kl=h;this.gTa=k;this.axis=m;this.LI=(t,v,x)=>new uub(this.qe,t,this.rows,this.cols,this.cells,this.attrs,
this.domain,this.kwb,this.Kl,this.gTa,v,x)}};var vub;vub=class{get mutable(){return this.base.mutable}destroy(a){Rn(this.type,this.VAa(a));this.base.destroy(a)}Bm(a){Rn(this.type,a.key);this.base.Bm(a.value)}snapshot(){return this.base.snapshot()}constructor(a,b,c){this.base=a;this.VAa=b;this.type=c}};
__c.Rq=class extends hr{$Ib(a,b,c){return super.$Ib(a,b,c)}create(a){return super.create(a)}Mu(a,b,c,d,e){const f=this.VAa(b);a=this.Dx[f].Mu(a,b,new __c.Itb(c,d),this.oAd[f],e);return new vub(a,this.VAa,f)}snapshot(a){const b=this.Xjc(a);return this.Dx[b].snapshot(a)}ss(a,b){return new __c.Rq(this.domain,this.Dx,this.VAa,this.Xjc,a,b)}Lt(a,b,c){const d=Sn(this.Dx,(g,h)=>vq(new ztb(h),g.MK)),e=Sn(this.Dx,g=>g.al),f=Wob(a);return this.ss(bpb(d,this.iue,g=>f[b(g)]),bpb(e,this.VAa,g=>f[c(g)]))}iue(a){return a.key}constructor(a,
b,c,d,e,f){super(e,f);this.domain=a;this.Dx=b;this.VAa=c;this.Xjc=d;this.oAd=Sn(this.Dx,(g,h)=>k=>({key:h,value:k}));this.iMe=Sn(this.Dx,(g,h)=>k=>{Rn(h,k.key);return k.value})}};__c.Rq.prototype.lx=ba(131);__c.Rq.prototype.uM=ba(125);var wub=class{get mutable(){return 1}destroy(a){Rn(a,1)}Bm(a){Rn(a,1)}snapshot(){return 1}};wub.instance=new wub;var Pqb=class extends hr{Mu(){return wub.instance}snapshot(a){return a}ss(a,b){return new Pqb(this.domain,a,b)}constructor(a,b,c){super(b,c);this.domain=a}};var xub;xub=Symbol.iterator;
var yub=class extends fr{static C(a){hb(a,{values:Uq.struct})}I2(a){for(const [b,c]of a)(a=(this.map.get(b)||0)+c)?this.map.set(b,a):this.map.delete(b)}sW(){return new Map(this.map)}bv(a){fa(this.domain.Bj(this.snapshot(),a))}add(a){const b=this.map.get(a)||0;b>0||this.Eu(new Map([[a,-b+1]]))}delete(a){const b=this.map.get(a)||0;b&&this.Eu(new Map([[a,-b]]))}has(a){return(this.map.get(a)||0)>0}get values(){return[...arb(this.map,a=>a>0).keys()]}[xub](){return this.values[Symbol.iterator]()}constructor(a,b,
c,d,e){super(a,b,d,e);this.domain=c;this.map=(yub.C(this),void 0);this.map=new drb(d)}},brb=class extends ir{ss(a,b){return new brb(this.qe,this.domain,a,b)}constructor(a,b,c,d){super(c,d);this.qe=a;this.domain=b;this.LI=(e,f,g)=>new yub(this.qe,e,this.domain,f,g)}};T=__c.T=function({CF:a,qe:b}){a={CF:a,qe:b};b=iqb(a);const c=pqb({...a,Tk:b}),d=$qb(),e=fqb({...a,Tk:d});return{...ypb(a),...Epb({...a,Tk:{...e,...d}}),...Lpb(a),...Opb(a),...Tpb({...a,Tk:d}),...Xpb(a),...bqb(a),...dqb(a),...e,...b,...mqb(a),...c,...xqb(a),...Aqb(a),...Fqb(a),...Gqb(a),...Nqb({...a,Tk:{...b,...c}}),...Oqb(a),...Qqb(a),...crb(a),...d}}({CF:function(a){const b=a?.qe||new vtb,c=new srb(b);a=new rtb(b);const d=(B,C)=>new ttb(b,B,C);var e=()=>d((B,C)=>B===C,B=>B);const f=e(),g=e();e=e();
const h=B=>new Srb(b,B,new Rrb(B)),k=h(g),m=h(f),n=B=>new ptb(b,B,new utb(B)),p=new xsb(b),t=new Csb(b,c),v=Wsb.create(b,t,c),x=new __c.ntb(b),z=new csb(b,new trb(b,(B,C,D)=>C===D,c),c);return{axis:c,unit:a,value:d,literal:()=>d((B,C)=>B===C,B=>B),union:(B,C)=>new qtb(b,n(B),C),number:f,string:g,boolean:e,box:h,W6g:k,QLg:m,sum:n,fB:B=>new ksb(b,h(new ysb(b,B))),reference:B=>new Xsb(b,B),option:B=>new ysb(b,B),list:B=>new wsb(b,h(new ysb(b,B))),never:p,sheet:(B,C,D,F)=>new otb(b,B,C,D,F,c,v,t),gn:t,
Kl:v,ora:B=>new bsb(b,B,z,c),ecc:B=>new trb(b,B,c),ZXf:()=>new Krb(b),selection:x,raa:B=>new __c.Qsb(b,B),EGd:(B,C)=>new __c.dtb(b,new __c.Qsb(b,B),new Krb(b),C),kB:z,counter:new gsb(b),Yvd:new hsb(b),zle:()=>new jsb(b)}}({qe:wtb}),qe:wtb});__c.nr=E(()=>({oldState:__c.R(1),newState:__c.R(2)}));__c.or=E(()=>({oldState:__c.bi(1),newState:__c.bi(2)}));__c.pr=E(()=>({oldState:__c.ei(1),newState:__c.ei(2)}));__c.qr=E(()=>({oldState:__c.ci(1),newState:__c.ci(2)}));__c.zub=E(()=>({oldState:__c.fi(1),newState:__c.fi(2)}));__c.rr=E(()=>({oldState:__c.di(1),newState:__c.di(2)}));__c.Aub=E(()=>({oldState:__c.gi(1),newState:__c.gi(2)}));__c.Bub=E(()=>({oldState:__c.hi(1),newState:__c.hi(2)}));__c.sr=E(()=>({oldState:__c.O(1),newState:__c.O(2)}));__c.vr=E(()=>({oldState:__c.P(1),newState:__c.P(2)}));__c.Cub=E(()=>({oldState:__c.mi(1),newState:__c.mi(2)}));__c.wr=E(()=>({oldState:__c.ki(1),newState:__c.ki(2)}));__c.Dub=E(()=>({oldState:(0,__c.qi)(1),newState:(0,__c.qi)(2)}));__c.Eub=E(()=>({oldState:u(1,__c.ehb),newState:u(2,__c.ehb)}));__c.Fub=E(()=>({oldState:w(1,__c.Vn),newState:w(2,__c.Vn)}));__c.Gub=E(()=>({Wia:w(2,__c.Dub)}));__c.Iub=E(()=>({oldState:__c.ii(1),newState:__c.ii(2)}));var Jub=E(()=>({type:__c.r("A?",1,"UPDATE")}));var Kub=E(()=>({type:__c.r("A?",2,"REPLACE"),oldState:__c.P(1),newState:__c.P(2)}));var Lub=__c.Ma(()=>({type:[1,Jub,2,Kub]}),()=>({}));__c.Mub=E(()=>({ops:(0,__c.si)(1,Lub)}));__c.Nub=E(()=>({Smd:(0,__c.pi)(1)}));var Oub=E(()=>({}));var Pub=E(()=>({type:__c.r("A?",1,"UPDATE"),delta:w(1,Oub)}));var Qub=E(()=>({type:__c.r("A?",2,"REPLACE"),oldState:w(1,__c.bo),newState:w(2,__c.bo)}));var Rub=__c.Ma(()=>({type:[1,Pub,2,Qub]}),()=>({}));var Sub=E(()=>({ops:(0,__c.si)(1,Rub)}));__c.Tub=E(()=>({oldState:__c.A(1,__c.bhb),newState:__c.A(2,__c.bhb)}));__c.Uub=E(()=>({oldState:w(1,__c.Un),newState:w(2,__c.Un)}));__c.Vub=E(()=>({oldState:__c.A(1,__c.Yn),newState:__c.A(2,__c.Yn)}));__c.Wub=E(()=>({oldState:u(1,$n),newState:u(2,$n)}));__c.Xub=E(()=>({oldState:w(1,$n),newState:w(2,$n)}));__c.Yub=E(()=>({oldState:u(1,__c.Tn),newState:u(2,__c.Tn)}));var gvb,hvb,ivb,kvb,ovb,pvb,svb,tvb,uvb,vvb,Hvb,Qvb,Svb,Wvb;__c.xr=Hq(T.Vc(T.boolean),Fq(__c.nr));__c.yr=Hq(T.Vc(T.double),Fq(__c.or));__c.zr=Hq(T.xg(T.double),Fq(__c.pr));__c.Ar=Hq(T.Vc(T.sJ),Fq(__c.qr));Hq(T.xg(T.sJ),Fq(__c.zub));__c.Zub=Hq(T.Vc(T.Efa),Fq(__c.rr));__c.$ub=Hq(T.xg(T.Efa),Fq(__c.Aub));Hq(T.Vc(T.double),Fq(__c.rr));__c.avb=Hq(T.xg(T.double),Fq(__c.Aub));__c.Br=Hq(T.Vc(T.TF),Fq(__c.or));__c.bvb=Hq(T.Vc(T.CCd),Fq(__c.or));__c.Cr=Hq(T.xg(T.TF),Fq(__c.pr));__c.cvb=Hq(T.Vc(T.Owd),Fq(__c.Bub));
__c.Dr=Hq(T.Vc(T.string),Fq(__c.sr));__c.Er=Hq(T.xg(T.string),Fq(__c.vr));__c.dvb=Hq(T.xg(T.boolean),Fq(__c.Cub));__c.Fr=Hq(T.Vc(T.ANd),Fq(__c.wr));__c.evb=Hq(T.Vc(T.oKb(T.string,T.string)),Fq(__c.Dub));__c.fvb=T.qf({id:T.string,version:T.sJ}).cb(Fq(__c.Vn));gvb=T.qf({type:T.literal("RESOLVED"),id:T.string,version:T.sJ}).cb(Fq(__c.ao));hvb=T.qf({type:T.literal("UNRESOLVED"),token:T.string}).cb(function(a,b){const c=new dpb(d=>a.FK(d));return b!=null?vq(c,epb(b)):c}(__c.dhb));
ivb=T.Hba({RESOLVED:gvb,UNRESOLVED:hvb},a=>a.type).Lt({RESOLVED:"RESOLVED",UNRESOLVED:"UNRESOLVED"},a=>a.type);__c.jvb=Hq(T.Vc(ivb),Fq(__c.Eub));kvb=__c.Jq(T.literal("font","media","video","audio","embed","scene","blueprint"),{font:1,media:2,video:3,audio:4,embed:5,scene:6,blueprint:7});__c.lvb=T.qf({type:kvb,id:T.string,version:T.sJ}).cb(Fq(__c.ghb));__c.mvb=Hq(T.xg(__c.fvb),Fq(__c.Fub));__c.Gr=T.Qa({values:{app:__c.fvb},attributes:{Wia:__c.evb}}).cb(Fq(__c.Gub),Fq(__c.Wn));__c.nvb=T.number(-1,1);
ovb=T.number(0,100);pvb=T.number(-100,100);__c.qvb=T.number(0,1);__c.rvb=T.number(-180,180);svb=Fq(__c.or);tvb=Fq(__c.pr);uvb=Fq(__c.vr);vvb=Fq(__c.Iub);Hq(T.Vc(__c.nvb),svb);__c.wvb=Hq(T.Vc(ovb),svb);__c.Hr=Hq(T.Vc(pvb),svb);__c.Ir=Hq(T.Vc(__c.qvb),svb);__c.xvb=Hq(T.Vc(__c.rvb),svb);Hq(T.xg(__c.rvb),tvb);__c.Jr=T.regexp(__c.$gb);__c.yvb=Hq(T.Vc(__c.Jr),Fq(__c.sr));__c.zvb=Hq(T.Vc(T.nM(__c.Jr)),Fq(__c.wr));__c.Avb=T.optional(__c.Jr);__c.Bvb=Hq(T.Vc(__c.Avb),uvb);__c.Cvb=T.regexp(/^100%$/);
__c.Dvb=T.regexp(/^[0-9]+(\.[0-9]+)?%$/);__c.Evb=T.regexp(/^[0-9]+(\.[0-9]+)?px/);__c.Fvb=__c.Iq(T.fB(T.z0(T.string)),Fq(__c.Mub),Cq({delta:void 0},new Jub({})),Fq(Kub));__c.Gvb=T.kmf.ss({serialize:a=>new __c.Nub({Smd:a}),deserialize:a=>a.Smd},uq);__c.Iq(T.fB(T.unit),Fq(Sub),Cq({delta:void 0},new Pub({})),Cq({oldState:void 0,newState:void 0},new Qub({})));Hvb=T.dOe(0,10);__c.Ivb=T.nM(Hvb,a=>a.length<=10);__c.Jvb=Hq(T.Vc(__c.Ivb),vvb);__c.Kvb=T.regexp(Smb("L"));__c.Lvb=T.regexp(Smb("T"));__c.Mvb=T.regexp(Smb("X"));
__c.Nvb=Hq(T.Vc(T.literal(1,2,3)),Fq(__c.Tub));__c.Ovb=T.qf({text:T.string,mda:T.boolean}).cb(Fq(__c.Un));__c.Pvb=Hq(T.xg(__c.Ovb),Fq(__c.Uub));Qvb=T.literal(1,2);__c.Rvb=Hq(T.Vc(Qvb),Fq(__c.Vub));Svb=T.qf({top:T.double,left:T.double}).cb(Fq($n));__c.Tvb=Hq(T.Vc(Svb),Fq(__c.Wub));__c.Uvb=Hq(T.xg(Svb),Fq(__c.Xub));__c.Vvb=T.qf({width:T.TF,height:T.TF}).cb(Fq(__c.Xn));Wvb=T.qf({top:T.double,left:T.double,height:T.TF,width:T.TF}).cb(Fq(__c.Tn));__c.Xvb=Hq(T.Vc(Wvb),Fq(__c.Yub));
__c.Yvb=T.qf({text:T.string,user:T.string,brand:T.string}).cb(Fq(__c.Zn));__c.Zvb=T.qf({text:T.string,url:T.string}).cb(Fq(__c.chb));
}).call(globalThis, globalThis._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/edf277c9d5e578c4.js.map